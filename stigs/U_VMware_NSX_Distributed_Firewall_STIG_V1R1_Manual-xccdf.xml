<?xml version="1.0" encoding="utf-8"?><?xml-stylesheet type='text/xsl' href='STIG_unclass.xsl'?><Benchmark xmlns:dsig="http://www.w3.org/2000/09/xmldsig#" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:dc="http://purl.org/dc/elements/1.1/" id="VMware_NSX_Distributed_Firewall_STIG" xml:lang="en" xsi:schemaLocation="http://checklists.nist.gov/xccdf/1.1 http://nvd.nist.gov/schema/xccdf-1.1.4.xsd http://cpe.mitre.org/dictionary/2.0 http://cpe.mitre.org/files/cpe-dictionary_2.1.xsd" xmlns="http://checklists.nist.gov/xccdf/1.1"><status date="2016-06-27">accepted</status><title>VMware NSX Distributed Firewall Security Technical Implementation Guide</title><description>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents. Comments or proposed revisions to this document should be sent via e-mail to the following address: disa.stig_spt@mail.mil.</description><notice id="terms-of-use" xml:lang="en"></notice><reference href="http://iase.disa.mil"><dc:publisher>DISA</dc:publisher><dc:source>STIG.DOD.MIL</dc:source></reference><plain-text id="release-info">Release: 1 Benchmark Date: 27 Jun 2016</plain-text><version>1</version><Profile id="MAC-1_Classified"><title>I - Mission Critical Classified</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-69137" selected="true" /><select idref="V-69139" selected="true" /><select idref="V-69141" selected="true" /><select idref="V-69143" selected="true" /><select idref="V-69145" selected="true" /><select idref="V-69147" selected="true" /><select idref="V-69149" selected="true" /><select idref="V-69151" selected="true" /><select idref="V-69153" selected="true" /><select idref="V-69155" selected="true" /><select idref="V-69157" selected="true" /><select idref="V-69159" selected="true" /></Profile><Profile id="MAC-1_Public"><title>I - Mission Critical Public</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-69137" selected="true" /><select idref="V-69139" selected="true" /><select idref="V-69141" selected="true" /><select idref="V-69143" selected="true" /><select idref="V-69145" selected="true" /><select idref="V-69147" selected="true" /><select idref="V-69149" selected="true" /><select idref="V-69151" selected="true" /><select idref="V-69153" selected="true" /><select idref="V-69155" selected="true" /><select idref="V-69157" selected="true" /><select idref="V-69159" selected="true" /></Profile><Profile id="MAC-1_Sensitive"><title>I - Mission Critical Sensitive</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-69137" selected="true" /><select idref="V-69139" selected="true" /><select idref="V-69141" selected="true" /><select idref="V-69143" selected="true" /><select idref="V-69145" selected="true" /><select idref="V-69147" selected="true" /><select idref="V-69149" selected="true" /><select idref="V-69151" selected="true" /><select idref="V-69153" selected="true" /><select idref="V-69155" selected="true" /><select idref="V-69157" selected="true" /><select idref="V-69159" selected="true" /></Profile><Profile id="MAC-2_Classified"><title>II - Mission Support Classified</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-69137" selected="true" /><select idref="V-69139" selected="true" /><select idref="V-69141" selected="true" /><select idref="V-69143" selected="true" /><select idref="V-69145" selected="true" /><select idref="V-69147" selected="true" /><select idref="V-69149" selected="true" /><select idref="V-69151" selected="true" /><select idref="V-69153" selected="true" /><select idref="V-69155" selected="true" /><select idref="V-69157" selected="true" /><select idref="V-69159" selected="true" /></Profile><Profile id="MAC-2_Public"><title>II - Mission Support Public</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-69137" selected="true" /><select idref="V-69139" selected="true" /><select idref="V-69141" selected="true" /><select idref="V-69143" selected="true" /><select idref="V-69145" selected="true" /><select idref="V-69147" selected="true" /><select idref="V-69149" selected="true" /><select idref="V-69151" selected="true" /><select idref="V-69153" selected="true" /><select idref="V-69155" selected="true" /><select idref="V-69157" selected="true" /><select idref="V-69159" selected="true" /></Profile><Profile id="MAC-2_Sensitive"><title>II - Mission Support Sensitive</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-69137" selected="true" /><select idref="V-69139" selected="true" /><select idref="V-69141" selected="true" /><select idref="V-69143" selected="true" /><select idref="V-69145" selected="true" /><select idref="V-69147" selected="true" /><select idref="V-69149" selected="true" /><select idref="V-69151" selected="true" /><select idref="V-69153" selected="true" /><select idref="V-69155" selected="true" /><select idref="V-69157" selected="true" /><select idref="V-69159" selected="true" /></Profile><Profile id="MAC-3_Classified"><title>III - Administrative Classified</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-69137" selected="true" /><select idref="V-69139" selected="true" /><select idref="V-69141" selected="true" /><select idref="V-69143" selected="true" /><select idref="V-69145" selected="true" /><select idref="V-69147" selected="true" /><select idref="V-69149" selected="true" /><select idref="V-69151" selected="true" /><select idref="V-69153" selected="true" /><select idref="V-69155" selected="true" /><select idref="V-69157" selected="true" /><select idref="V-69159" selected="true" /></Profile><Profile id="MAC-3_Public"><title>III - Administrative Public</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-69137" selected="true" /><select idref="V-69139" selected="true" /><select idref="V-69141" selected="true" /><select idref="V-69143" selected="true" /><select idref="V-69145" selected="true" /><select idref="V-69147" selected="true" /><select idref="V-69149" selected="true" /><select idref="V-69151" selected="true" /><select idref="V-69153" selected="true" /><select idref="V-69155" selected="true" /><select idref="V-69157" selected="true" /><select idref="V-69159" selected="true" /></Profile><Profile id="MAC-3_Sensitive"><title>III - Administrative Sensitive</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-69137" selected="true" /><select idref="V-69139" selected="true" /><select idref="V-69141" selected="true" /><select idref="V-69143" selected="true" /><select idref="V-69145" selected="true" /><select idref="V-69147" selected="true" /><select idref="V-69149" selected="true" /><select idref="V-69151" selected="true" /><select idref="V-69153" selected="true" /><select idref="V-69155" selected="true" /><select idref="V-69157" selected="true" /><select idref="V-69159" selected="true" /></Profile><Group id="V-69137"><title>SRG-NET-000015-ALG-000016</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-83741r1_rule" severity="medium" weight="10.0"><version>VNSX-FW-000001</version><title>The NSX Distributed Firewall must enforce approved authorizations for logical access to information and system resources by employing identity-based, role-based, and/or attribute-based security policies.</title><description>&lt;VulnDiscussion&gt;Successful authentication must not automatically give an entity access to an asset or security boundary. The lack of authorization-based access control could result in the immediate compromise and unauthorized access to sensitive information. All DoD systems must be properly configured to incorporate access control methods that do not rely solely on authentication for authorized access.
 
Authorization is the process of determining whether an entity, once authenticated, is permitted to access a specific asset. Information systems use access control policies and enforcement mechanisms to implement this requirement. Authorization procedures and controls must be implemented to ensure each authenticated entity also has a validated and current authorization.
 
Access control policies include identity-based policies, role-based policies, and attribute-based policies. Access enforcement mechanisms include access control lists, access control matrices, and cryptography. ALGs must use these policies and mechanisms to control access on behalf of the application for which it is acting as intermediary.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware NSX 6 ALG</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware NSX 6 ALG</dc:subject><dc:identifier>2987</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000213</ident><fixtext fixref="F-75323r1_fix">Log into vSphere Web Client with credentials authorized for administration.

Remediate this finding by navigating to the Networking and Security &gt;&gt; Firewall tab on the left side menu &gt;&gt; Configuration tab &gt;&gt; General 

Configure the rules necessary to enforce approved authorizations for logical access to information and system resources by employing identity-based, role-based, and/or attribute-based security policies 

Ensure the rules have been enabled, and configure the respective "Applied to" category if appropriate.</fixtext><fix id="F-75323r1_fix" /><check system="C-69575r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_VMware_NSX_Distributed_Firewall_STIG.xml" /><check-content>Verify the rules necessary to enforce approved authorizations for logical access to information and system resources by employing identity-based, role-based, and/or attribute-based security policies are configured, enabled and the respective "Applied to" category is configured if appropriate.

Log into vSphere Web Client with credentials authorized for administration, navigate to Networking and Security &gt;&gt; Firewall &gt;&gt; Configuration tab &gt;&gt; General.
Expand rule sections as necessary to view rules.

If there are no rules configured to enforce authorizations, this is a finding.</check-content></check></Rule></Group><Group id="V-69139"><title>SRG-NET-000018-ALG-000017</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-83743r1_rule" severity="medium" weight="10.0"><version>VNSX-FW-000002</version><title>The NSX Distributed Firewall must enforce approved authorizations for controlling the flow of information within the network based on attribute- and content-based inspection of the source, destination, headers, and/or content of the communications traffic.</title><description>&lt;VulnDiscussion&gt;Information flow control regulates where information is allowed to travel within a network. The flow of all network traffic must be monitored and controlled so it does not introduce any unacceptable risk to the network infrastructure or data.
 
Information flow control policies and enforcement mechanisms are commonly employed by organizations to control the flow of information between designated sources and destinations (e.g., networks, individuals, devices) within information systems. Examples of information flow control restrictions include keeping export controlled information from being transmitted in the clear to the Internet or blocking information marked as classified but is being transported to an unapproved destination.
 
ALGs enforce approved authorizations by employing security policy and/or rules that restrict information system services, provide packet filtering capability based on header or protocol information and/or message filtering capability based on data content (e.g., implementing key word searches or using document characteristics).&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware NSX 6 ALG</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware NSX 6 ALG</dc:subject><dc:identifier>2987</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-001368</ident><fixtext fixref="F-75325r1_fix">Log into vSphere Web Client with credentials authorized for administration.

Remediate this finding by navigating to the Networking and Security &gt;&gt; Firewall tab on the left side menu &gt;&gt; Configuration tab &gt;&gt; General 

Configure the rules necessary to enforce approved authorizations for logical access to information and system resources by employing identity-based, role-based, and/or attribute-based security policies 

Ensure the rules have been enabled, and configure the respective "Applied to" category if appropriate.</fixtext><fix id="F-75325r1_fix" /><check system="C-69577r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_VMware_NSX_Distributed_Firewall_STIG.xml" /><check-content>Verify the rules necessary to enforce approved authorizations for logical access to information and system resources by employing identity-based, role-based, and/or attribute-based security policies are configured, enabled and the respective "Applied to" category is configured if appropriate.

Log into vSphere Web Client with credentials authorized for administration, navigate to Networking and Security &gt;&gt; Firewall &gt;&gt; Configuration tab &gt;&gt; General.
Expand rule sections as necessary to view rules.

If there are no rules configured to enforce authorizations, this is a finding.</check-content></check></Rule></Group><Group id="V-69141"><title>SRG-NET-000019-ALG-000018</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-83745r1_rule" severity="medium" weight="10.0"><version>VNSX-FW-000003</version><title>The NSX Distributed Firewall must restrict or block harmful or suspicious communications traffic by controlling the flow of information between interconnected networks based on attribute- and content-based inspection of the source, destination, headers, and/or content of the communications traffic.</title><description>&lt;VulnDiscussion&gt;Information flow control regulates where information is allowed to travel within a network and between interconnected networks. Blocking or restricting detected harmful or suspicious communications between interconnected networks enforces approved authorizations for controlling the flow of traffic.
 
This requirement applies to the flow of information between the ALG when used as a gateway or boundary device which allows traffic flow between interconnected networks of differing security policies.
 
The ALG is installed and configured such that it restricts or blocks information flows based on guidance in the PPSM regarding restrictions for boundary crossing for ports, protocols and services. Information flow restrictions may be implemented based on attribute- and content-based inspection of the source, destination, headers, and/or content of the communications traffic.
 
The ALG must be configured with policy filters (e.g., security policy, rules, and/or signatures) that restrict or block information system services; provide a packet-filtering capability based on header information; and/or perform message-filtering based on message content. The policy filters used depends upon the type of application gateway (e.g., web, email, or TLS).&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware NSX 6 ALG</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware NSX 6 ALG</dc:subject><dc:identifier>2987</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-001414</ident><fixtext fixref="F-75327r1_fix">Log into vSphere Web Client with credentials authorized for administration.

Remediate this finding by navigating to the Networking and Security &gt;&gt; Firewall tab on the left side menu &gt;&gt; Configuration tab &gt;&gt; General 

Configure the rules necessary to enforce approved authorizations for logical access to information and system resources by employing identity-based, role-based, and/or attribute-based security policies 

Ensure the rules have been enabled, and configure the respective "Applied to" category if appropriate.</fixtext><fix id="F-75327r1_fix" /><check system="C-69579r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_VMware_NSX_Distributed_Firewall_STIG.xml" /><check-content>Verify the rules necessary to enforce approved authorizations for logical access to information and system resources by employing identity-based, role-based, and/or attribute-based security policies are configured, enabled and the respective "Applied to" category is configured if appropriate.

Log into vSphere Web Client with credentials authorized for administration, navigate to Networking and Security &gt;&gt; Firewall &gt;&gt; Configuration tab &gt;&gt; General. 

Expand rule sections as necessary to view rules.

If there are no rules configured to enforce authorizations, this is a finding.</check-content></check></Rule></Group><Group id="V-69143"><title>SRG-NET-000131-ALG-000085</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-83747r1_rule" severity="medium" weight="10.0"><version>VNSX-FW-000034</version><title>The NSX Distributed Firewall must not have unnecessary services and functions enabled.</title><description>&lt;VulnDiscussion&gt;Information systems are capable of providing a wide variety of functions (capabilities or processes) and services. Some of these functions and services are installed and enabled by default. The organization must determine which functions and services are required to perform the content filtering and other necessary core functionality for each component of the ALG. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.
 
The primary function of an ALG is to provide application specific content filtering and/or proxy services. The ALG application suite may integrate related content filtering and analysis services and tools (e.g., IPS, proxy, malware inspection, black/white lists). Some gateways may also include email scanning, decryption, caching, and DLP services. However, services and capabilities which are unrelated to this primary functionality must not be installed (e.g., DNS, email client or server, FTP server, or web server).
 
Next Generation ALGs (NGFW) and Unified Threat Management (UTM) ALGs integrate functions which have been traditionally separated. These products integrate content filtering features to provide more granular policy filtering. There may be operational drawbacks to combining these services into one device. Another issue is that NGFW and UTM products vary greatly with no current definitive industry standard.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware NSX 6 ALG</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware NSX 6 ALG</dc:subject><dc:identifier>2987</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000381</ident><fixtext fixref="F-75329r1_fix">Configure Partner Security Services to the disabled state.

Log into vSphere Web Client with credentials authorized for administration, navigate and select Networking and Security &gt;&gt; Firewall tab on the left side
 menu &gt;&gt; Configuration &gt;&gt; Partner Security Services &gt;&gt; Select the partner security service.
  
Hover over the "No." column 
Click the pencil icon 
Disable it</fixtext><fix id="F-75329r1_fix" /><check system="C-69581r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_VMware_NSX_Distributed_Firewall_STIG.xml" /><check-content>Verify no unwanted services are enabled.

Log into vSphere Web Client with credentials authorized for administration, navigate and select Networking and Security &gt;&gt; Firewall tab on the left side menu &gt;&gt; Configuration &gt;&gt; Partner Security Services.
 
Verify that any unwanted services are disabled. 

If there are services that should not be enabled, this is a finding.</check-content></check></Rule></Group><Group id="V-69145"><title>SRG-NET-000132-ALG-000087</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-83749r1_rule" severity="medium" weight="10.0"><version>VNSX-FW-000036</version><title>The NSX Distributed Firewall must be configured to prohibit or restrict the use of functions, ports, protocols, and/or services, as defined in the PPSM CAL and vulnerability assessments.</title><description>&lt;VulnDiscussion&gt;In order to prevent unauthorized connection of devices, unauthorized transfer of information, or unauthorized tunneling (i.e., embedding of data types within data types); organizations must disable or restrict unused or unnecessary physical and logical ports/protocols on information systems.
 
ALGs are capable of providing a wide variety of functions and services. Some of the functions and services provided by default may not be necessary to support essential organizational operations. DoD continually assesses the ports, protocols, and services that can be used for network communications. Some ports, protocols or services have known exploits or security weaknesses. Network traffic using these ports, protocols, and services must be prohibited or restricted in accordance with DoD policy. The ALG is a key network element for preventing these non-compliant ports, protocols, and services from causing harm to DoD information systems.
 
The network ALG must be configured to prevent or restrict the use of prohibited ports, protocols, and services throughout the network by filtering the network traffic and disallowing or redirecting traffic as necessary. Default and updated policy filters from the vendors will disallow older version of protocols and applications and will address most known non-secure ports, protocols, and/or services. However, sources for further policy filters are the IAVMs and the PPSM requirements.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware NSX 6 ALG</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware NSX 6 ALG</dc:subject><dc:identifier>2987</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000382</ident><fixtext fixref="F-75331r1_fix">Disable ports, protocols, and/or services not required for operation of the ALG application.

Log into vSphere Web Client with credentials authorized for administration, navigate and select Networking and Security &gt;&gt; Firewall tab on the left side menu &gt;&gt; Configuration &gt;&gt; General &gt;&gt; Click on Green check in the number column to disable an individual distributed firewall rule &gt;&gt; Publish Changes.

Once configuration is saved successfully verify the check is greyed out.</fixtext><fix id="F-75331r1_fix" /><check system="C-69583r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_VMware_NSX_Distributed_Firewall_STIG.xml" /><check-content>View the configuration and vendor documentation of the ALG application to find the minimum ports, protocols, and services which are required for operation of the ALG. 

Log into vSphere Web Client with credentials authorized for administration, navigate and select Networking and Security &gt;&gt; Firewall tab on the left side menu &gt;&gt; Configuration &gt;&gt; General

Verify the NSX Distributed Firewall policy restricts the use of ports, protocols, and/or services with the Ports, Protocol, and Service Management (PPSM) and IAVM requirements.
 
If ports, protocols, and/or services are not disabled or restricted as required by the PPSM, this is a finding.</check-content></check></Rule></Group><Group id="V-69147"><title>SRG-NET-000202-ALG-000124</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-83751r1_rule" severity="medium" weight="10.0"><version>VNSX-FW-000046</version><title>The NSX Distributed Firewall must deny network communications traffic by default and allow network communications traffic by exception (i.e., deny all, permit by exception).</title><description>&lt;VulnDiscussion&gt;A deny-all, permit-by-exception network communications traffic policy ensures that only those connections which are essential and approved are allowed.
 
As a managed interface, the ALG must block all inbound and outbound network communications traffic to the application being managed and controlled unless a policy filter is installed to explicitly allow the traffic. The allow policy filters must comply with the site's security policy. A deny all, permit by exception network communications traffic policy ensures that only those connections which are essential and approved, are allowed.
 
This requirement applies to both inbound and outbound network communications traffic. All inbound and outbound traffic for which the ALG is acting as an intermediary or proxy must be denied by default.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware NSX 6 ALG</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware NSX 6 ALG</dc:subject><dc:identifier>2987</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-001109</ident><fixtext fixref="F-75333r1_fix">Configure the "Default Rule" to deny by default with "Block".
 
Log into the vCenter web interface with credentials authorized for administration, navigate to Networking and Security &gt;&gt; Firewall

Expand "Default Section Layer 3" in Configuration
Expand the Action for the rule named "Default Rule"
Change the action to "Block"
Select "OK"
Select "Publish Changes"</fixtext><fix id="F-75333r1_fix" /><check system="C-69585r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_VMware_NSX_Distributed_Firewall_STIG.xml" /><check-content>Verify denied by default policy.

Log into the vCenter web interface with credentials authorized for administration, navigate to Networking and Security &gt;&gt; Firewall

Expand "Default Section Layer 3" in Configuration

If the action for the Default Rule is "Allow", this is a finding.</check-content></check></Rule></Group><Group id="V-69149"><title>SRG-NET-000213-ALG-000107</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-83753r1_rule" severity="medium" weight="10.0"><version>VNSX-FW-000047</version><title>The NSX Distributed Firewall must terminate all network connections associated with a communications session at the end of the session, or as follows: for in-band management sessions (privileged sessions), the session must be terminated after 10 minutes of inactivity; and for user sessions (non-privileged session), the session must be terminated after 15 minutes of inactivity.</title><description>&lt;VulnDiscussion&gt;Terminating an idle session within a short time period reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been left unattended. In addition, quickly terminating an idle session will also free up resources committed by the managed network element.
 
Terminating network connections associated with communications sessions includes, for example, de-allocating associated TCP/IP address/port pairs at the operating system level, and de-allocating networking assignments at the application level if multiple application sessions are using a single operating system level network connection.
 
ALGs may provide session control functionality as part of content filtering, load balancing, or proxy services.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware NSX 6 ALG</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware NSX 6 ALG</dc:subject><dc:identifier>2987</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-001133</ident><fixtext fixref="F-75335r1_fix">Change the timeout value by editing the webclient.properties file.
 
 On the system where vCenter is installed locate the webclient.properties file.
 
 Windows: C:\ProgramData\VMware\vCenter Server\cfg\vsphere-client
 
 Edit the file to include the line "session.timeout = 10" where "10" is the timeout value in minutes. Uncomment the line if necessary.
 
 After editing the file the vSphere Web Client service must be restarted.</fixtext><fix id="F-75335r1_fix" /><check system="C-69587r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_VMware_NSX_Distributed_Firewall_STIG.xml" /><check-content>Verify the vSphere Web Client sessions terminate after "10" minutes of idle time, requiring the user to log in again to resume using the client. You can view the timeout value by viewing the webclient.properties file.
 
 On the system where vCenter is installed locate the webclient.properties file.
 
 Windows: C:\ProgramData\VMware\vCenter Server\cfg\vsphere-client
 
 Find the session.timeout = line in the webclient.properties file.
 
 If the session timeout is not set to "10" in the webclient.properties file, this is a finding.</check-content></check></Rule></Group><Group id="V-69151"><title>SRG-NET-000334-ALG-000050</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-83755r1_rule" severity="medium" weight="10.0"><version>VNSX-FW-000090</version><title>The NSX Distributed Firewall must off-load audit records onto a centralized log server.</title><description>&lt;VulnDiscussion&gt;Information stored in one location is vulnerable to accidental or incidental deletion or alteration.
 
Off-loading is a common process in information systems with limited audit storage capacity.
 
This does not apply to audit logs generated on behalf of the device itself (management).&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware NSX 6 ALG</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware NSX 6 ALG</dc:subject><dc:identifier>2987</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-001851</ident><fixtext fixref="F-75337r2_fix">Log into vSphere Web Client with credentials authorized for administration, navigate and select the ESXi host and click "Manage" &gt;&gt; "Advanced System Settings", and enter "Syslog.global.logHost" in the filter.

Verify the correct setting for "Syslog.global.logHost" to the hostname of your syslog server.

Verify each ESXi host is set to a remote syslog server.</fixtext><fix id="F-75337r2_fix" /><check system="C-69589r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_VMware_NSX_Distributed_Firewall_STIG.xml" /><check-content>Log into vSphere Web Client with credentials authorized for administration, navigate and select the ESXi host and click "Manage" &gt;&gt; "Advanced System Settings", and enter "Syslog.global.logHost" in the filter.

Verify the correct setting for "Syslog.global.logHost" to the hostname of your syslog server.

If this setting does not specify the appropriate syslog server on each ESXi host, this is a finding.</check-content></check></Rule></Group><Group id="V-69153"><title>SRG-NET-000492-ALG-000027</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-83757r1_rule" severity="medium" weight="10.0"><version>VNSX-FW-000124</version><title>The NSX Distributed Firewall must generate audit records when successful/unsuccessful attempts to access security objects occur.</title><description>&lt;VulnDiscussion&gt;Without generating audit records that log usage of objects by subjects and other objects, it would be difficult to establish, correlate, and investigate the events relating to an incident, or identify those responsible for one.
 
Audit records can be generated from various components within the information system (e.g., module or policy filter). Security objects are data objects which are controlled by security policy and bound to security attributes.
 
This requirement applies to the ALG traffic management functions. This does not apply to audit logs generated on behalf of the device (device management).&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware NSX 6 ALG</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware NSX 6 ALG</dc:subject><dc:identifier>2987</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000172</ident><fixtext fixref="F-75339r1_fix">Log into vSphere Web Client with credentials authorized for administration, navigate and select Networking and Security &gt;&gt; Firewall tab to display a list of firewall rules deployed across the NSX environment.

Click on the dropdown arrow to expand each firewall rule's section.
For each rule, select the pencil icon in the "Action" column.
Select the radio button next to the "Log" option to turn on logging for each rule.</fixtext><fix id="F-75339r1_fix" /><check system="C-69591r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_VMware_NSX_Distributed_Firewall_STIG.xml" /><check-content>Verify each rule in the NSX Firewall has been configured to "Log". 

Log into vSphere Web Client with credentials authorized for administration, navigate and select Networking and Security &gt;&gt; Firewall tab to display a list of firewall rules deployed across the NSX environment.

Click on the dropdown arrow to expand each firewall rule's section.
For each rule, select the pencil icon in the "Action" column.
The "Log" option must be selected for each rule.  

If the "Log" option has not been enabled for all rules, this is a finding.</check-content></check></Rule></Group><Group id="V-69155"><title>SRG-NET-000496-ALG-000031</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-83759r1_rule" severity="medium" weight="10.0"><version>VNSX-FW-000128</version><title>The NSX Distributed Firewall must generate audit records when successful/unsuccessful attempts to modify security objects occur.</title><description>&lt;VulnDiscussion&gt;Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident, or identify those responsible for one.
 
Audit records can be generated from various components within the information system (e.g., module or policy filter). Security objects are data objects which are controlled by security policy and bound to security attributes.
 
This requirement applies to the ALG traffic management functions such as content filtering or intermediary services. This does not apply to audit logs generated on behalf of the device (device management).&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware NSX 6 ALG</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware NSX 6 ALG</dc:subject><dc:identifier>2987</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000172</ident><fixtext fixref="F-75341r1_fix">Log into vSphere Web Client with credentials authorized for administration, navigate and select Networking and Security &gt;&gt; Firewall tab to display a list of firewall rules deployed across the NSX environment.

Click on the dropdown arrow to expand each firewall rule's section.
For each rule, select the pencil icon in the "Action" column.
Select the radio button next to the "Log" option to turn on logging for each rule.</fixtext><fix id="F-75341r1_fix" /><check system="C-69593r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_VMware_NSX_Distributed_Firewall_STIG.xml" /><check-content>Verify each rule in the NSX Firewall has been configured to "Log". 

Log into vSphere Web Client with credentials authorized for administration, navigate and select Networking and Security &gt;&gt; Firewall tab to display a list of firewall rules deployed across the NSX environment.

Click on the dropdown arrow to expand each firewall rule's section.
For each rule, select the pencil icon in the "Action" column.
The "Log" option must be selected for each rule.  

If the "Log" option has not been enabled for all rules, this is a finding.</check-content></check></Rule></Group><Group id="V-69157"><title>SRG-NET-000501-ALG-000036</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-83761r1_rule" severity="medium" weight="10.0"><version>VNSX-FW-000133</version><title>The NSX Distributed Firewall must generate audit records when successful/unsuccessful attempts to delete security objects occur.</title><description>&lt;VulnDiscussion&gt;Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident, or identify those responsible for one.
 
Audit records can be generated from various components within the information system (e.g., module or policy filter). Security objects are data objects which are controlled by security policy and bound to security attributes.
 
This requirement applies to the ALG traffic management functions such as content filtering or intermediary services. This does not apply to audit logs generated on behalf of the device (device management).&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware NSX 6 ALG</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware NSX 6 ALG</dc:subject><dc:identifier>2987</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000172</ident><fixtext fixref="F-75343r1_fix">Log into vSphere Web Client with credentials authorized for administration, navigate and select Networking and Security &gt;&gt; Firewall tab to display a list of firewall rules deployed across the NSX environment.

Click on the dropdown arrow to expand each firewall rule's section.
For each rule, select the pencil icon in the "Action" column.
Select the radio button next to the "Log" option to turn on logging for each rule.</fixtext><fix id="F-75343r1_fix" /><check system="C-69595r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_VMware_NSX_Distributed_Firewall_STIG.xml" /><check-content>Verify each rule in the NSX Firewall has been configured to "Log". 

Log into vSphere Web Client with credentials authorized for administration, navigate and select Networking and Security &gt;&gt; Firewall tab to display a list of firewall rules deployed across the NSX environment.

Click on the dropdown arrow to expand each firewall rule's section.
For each rule, select the pencil icon in the "Action" column.
The "Log" option must be selected for each rule.  

If the "Log" option has not been enabled for all rules, this is a finding.</check-content></check></Rule></Group><Group id="V-69159"><title>SRG-NET-000512-ALG-000062</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-83763r1_rule" severity="medium" weight="10.0"><version>VNSX-FW-000151</version><title>The NSX Distributed Firewall must be configured to restrict it from accepting outbound IP packets that contain an illegitimate address in the source address field via egress filter or by enabling Unicast Reverse Path Forwarding.</title><description>&lt;VulnDiscussion&gt;A compromised host in an enclave can be used by a malicious actor as a platform to launch cyber attacks on third parties. This is a common practice in "botnets", which are a collection of compromised computers using malware to attack (usually DDoS) other computers or networks. DDoS attacks frequently leverage IP source address spoofing, in which packets with false source IP addresses send traffic to multiple hosts, which then send return traffic to the hosts with the IP addresses that were forged. This can generate significant, even massive, amounts of traffic. Therefore, protection measures to counteract IP source address spoofing must be taken.
 
The router must not accept any outbound IP packets that contain an illegitimate address in the source address field by enabling Unicast Reverse Path Forwarding (uRPF) strict mode or by implementing an egress ACL. Unicast Reverse Path Forwarding (uRPF) provides an IP address spoof protection capability. When uRPF is enabled in strict mode, the packet must be received on the interface that the device would use to forward the return packet.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware NSX 6 ALG</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware NSX 6 ALG</dc:subject><dc:identifier>2987</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000366</ident><fixtext fixref="F-75345r1_fix">Set "SpoofGuard" Default Policy to "Enabled" and "firewall" service to "Enabled" on all hosts.

Log into vSphere Web Client with credentials authorized for administration, navigate and select Networking and Security &gt;&gt; select the "SpoofGuard" tab on the left side menu.

Set the  Default Policy for All Networks Operation Mode to "Enabled".
Next, select the "Installation" tab on the left side menu.
Select Firewall and set to "Enabled".</fixtext><fix id="F-75345r1_fix" /><check system="C-69597r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_VMware_NSX_Distributed_Firewall_STIG.xml" /><check-content>Verify "SpoofGuard" Default Policy is "Enabled" and "firewall" service is "Enabled" on all hosts.

Log into vSphere Web Client with credentials authorized for administration, navigate and select Networking and Security &gt;&gt; select the "SpoofGuard" tab on the left side menu.

Verify Default Policy for "All Networks Operation Mode" is set to "Enabled".
Next, select the "Installation" tab on the left side menu and verify "firewall" is "Enabled".

If "SpoofGuard" Default Policy is not "Enabled" or "firewall" service is not "Enabled" on all hosts, this is a finding.</check-content></check></Rule></Group></Benchmark>