<?xml version="1.0" encoding="utf-8"?><?xml-stylesheet type='text/xsl' href='STIG_unclass.xsl'?><Benchmark xmlns:dsig="http://www.w3.org/2000/09/xmldsig#" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" id="Network_-_Infrastructure_Layer_3_Switch_-_Cisco" xml:lang="en" xsi:schemaLocation="http://checklists.nist.gov/xccdf/1.1 http://nvd.nist.gov/schema/xccdf-1.1.4.xsd http://cpe.mitre.org/dictionary/2.0 http://cpe.mitre.org/files/cpe-dictionary_2.1.xsd" xmlns="http://checklists.nist.gov/xccdf/1.1"><status date="2013-10-08">accepted</status><title>Infrastructure L3 Switch Secure Technical Implementation Guide - Cisco</title><description>Infrastructure L3 Switch Secure Technical Implementation Guide - Cisco</description><notice id="terms-of-use" xml:lang="en"></notice><reference><dc:publisher>DISA, Field Security Operations</dc:publisher><dc:source>STIG.DOD.MIL</dc:source></reference><plain-text id="release-info">Release: 16 Benchmark Date: 25 Oct 2013</plain-text><version>8</version><Profile id="MAC-1_Classified"><title>I - Mission Critial Classified</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-3000" selected="true" /><select idref="V-3008" selected="true" /><select idref="V-3012" selected="true" /><select idref="V-3013" selected="true" /><select idref="V-3014" selected="true" /><select idref="V-3020" selected="true" /><select idref="V-3034" selected="true" /><select idref="V-3043" selected="true" /><select idref="V-3056" selected="true" /><select idref="V-3057" selected="true" /><select idref="V-3058" selected="true" /><select idref="V-3062" selected="true" /><select idref="V-3069" selected="true" /><select idref="V-3070" selected="true" /><select idref="V-3072" selected="true" /><select idref="V-3078" selected="true" /><select idref="V-3079" selected="true" /><select idref="V-3080" selected="true" /><select idref="V-3081" selected="true" /><select idref="V-3083" selected="true" /><select idref="V-3085" selected="true" /><select idref="V-3086" selected="true" /><select idref="V-3143" selected="true" /><select idref="V-3160" selected="true" /><select idref="V-3175" selected="true" /><select idref="V-3196" selected="true" /><select idref="V-3210" selected="true" /><select idref="V-3966" selected="true" /><select idref="V-3967" selected="true" /><select idref="V-3969" selected="true" /><select idref="V-3971" selected="true" /><select idref="V-3972" selected="true" /><select idref="V-3973" selected="true" /><select idref="V-3984" selected="true" /><select idref="V-4582" selected="true" /><select idref="V-4584" selected="true" /><select idref="V-5611" selected="true" /><select idref="V-5612" selected="true" /><select idref="V-5613" selected="true" /><select idref="V-5614" selected="true" /><select idref="V-5615" selected="true" /><select idref="V-5616" selected="true" /><select idref="V-5618" selected="true" /><select idref="V-5622" selected="true" /><select idref="V-5623" selected="true" /><select idref="V-5624" selected="true" /><select idref="V-5626" selected="true" /><select idref="V-5628" selected="true" /><select idref="V-5645" selected="true" /><select idref="V-5646" selected="true" /><select idref="V-7009" selected="true" /><select idref="V-7011" selected="true" /><select idref="V-14667" selected="true" /><select idref="V-14669" selected="true" /><select idref="V-14671" selected="true" /><select idref="V-14672" selected="true" /><select idref="V-14673" selected="true" /><select idref="V-14674" selected="true" /><select idref="V-14675" selected="true" /><select idref="V-14676" selected="true" /><select idref="V-14677" selected="true" /><select idref="V-14681" selected="true" /><select idref="V-14693" selected="true" /><select idref="V-14705" selected="true" /><select idref="V-14707" selected="true" /><select idref="V-14717" selected="true" /><select idref="V-15288" selected="true" /><select idref="V-15432" selected="true" /><select idref="V-15434" selected="true" /><select idref="V-17754" selected="true" /><select idref="V-17814" selected="true" /><select idref="V-17815" selected="true" /><select idref="V-17816" selected="true" /><select idref="V-17817" selected="true" /><select idref="V-17818" selected="true" /><select idref="V-17819" selected="true" /><select idref="V-17821" selected="true" /><select idref="V-17822" selected="true" /><select idref="V-17823" selected="true" /><select idref="V-17824" selected="true" /><select idref="V-17825" selected="true" /><select idref="V-17826" selected="true" /><select idref="V-17827" selected="true" /><select idref="V-17832" selected="true" /><select idref="V-17833" selected="true" /><select idref="V-17834" selected="true" /><select idref="V-17835" selected="true" /><select idref="V-17836" selected="true" /><select idref="V-17837" selected="true" /><select idref="V-18522" selected="true" /><select idref="V-18523" selected="true" /><select idref="V-18544" selected="true" /><select idref="V-18545" selected="true" /><select idref="V-18565" selected="true" /><select idref="V-18566" selected="true" /><select idref="V-18790" selected="true" /><select idref="V-19188" selected="true" /><select idref="V-19189" selected="true" /><select idref="V-23747" selected="true" /><select idref="V-28784" selected="true" /><select idref="V-30577" selected="true" /><select idref="V-30578" selected="true" /><select idref="V-30585" selected="true" /><select idref="V-30617" selected="true" /><select idref="V-30660" selected="true" /><select idref="V-30736" selected="true" /><select idref="V-30744" selected="true" /><select idref="V-31285" selected="true" /></Profile><Profile id="MAC-1_Public"><title>I - Mission Critial Public</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-3000" selected="true" /><select idref="V-3008" selected="true" /><select idref="V-3012" selected="true" /><select idref="V-3013" selected="true" /><select idref="V-3014" selected="true" /><select idref="V-3020" selected="true" /><select idref="V-3021" selected="true" /><select idref="V-3034" selected="true" /><select idref="V-3043" selected="true" /><select idref="V-3056" selected="true" /><select idref="V-3057" selected="true" /><select idref="V-3058" selected="true" /><select idref="V-3062" selected="true" /><select idref="V-3069" selected="true" /><select idref="V-3070" selected="true" /><select idref="V-3072" selected="true" /><select idref="V-3078" selected="true" /><select idref="V-3079" selected="true" /><select idref="V-3080" selected="true" /><select idref="V-3081" selected="true" /><select idref="V-3083" selected="true" /><select idref="V-3085" selected="true" /><select idref="V-3086" selected="true" /><select idref="V-3143" selected="true" /><select idref="V-3160" selected="true" /><select idref="V-3175" selected="true" /><select idref="V-3196" selected="true" /><select idref="V-3210" selected="true" /><select idref="V-3966" selected="true" /><select idref="V-3967" selected="true" /><select idref="V-3969" selected="true" /><select idref="V-3971" selected="true" /><select idref="V-3972" selected="true" /><select idref="V-3973" selected="true" /><select idref="V-3984" selected="true" /><select idref="V-4582" selected="true" /><select idref="V-4584" selected="true" /><select idref="V-5611" selected="true" /><select idref="V-5612" selected="true" /><select idref="V-5613" selected="true" /><select idref="V-5614" selected="true" /><select idref="V-5615" selected="true" /><select idref="V-5616" selected="true" /><select idref="V-5618" selected="true" /><select idref="V-5622" selected="true" /><select idref="V-5623" selected="true" /><select idref="V-5624" selected="true" /><select idref="V-5626" selected="true" /><select idref="V-5628" selected="true" /><select idref="V-5645" selected="true" /><select idref="V-5646" selected="true" /><select idref="V-7009" selected="true" /><select idref="V-7011" selected="true" /><select idref="V-14667" selected="true" /><select idref="V-14669" selected="true" /><select idref="V-14671" selected="true" /><select idref="V-14672" selected="true" /><select idref="V-14673" selected="true" /><select idref="V-14674" selected="true" /><select idref="V-14675" selected="true" /><select idref="V-14676" selected="true" /><select idref="V-14677" selected="true" /><select idref="V-14681" selected="true" /><select idref="V-14693" selected="true" /><select idref="V-14705" selected="true" /><select idref="V-14707" selected="true" /><select idref="V-14717" selected="true" /><select idref="V-15288" selected="true" /><select idref="V-15432" selected="true" /><select idref="V-15434" selected="true" /><select idref="V-17754" selected="true" /><select idref="V-17814" selected="true" /><select idref="V-17815" selected="true" /><select idref="V-17816" selected="true" /><select idref="V-17817" selected="true" /><select idref="V-17818" selected="true" /><select idref="V-17819" selected="true" /><select idref="V-17821" selected="true" /><select idref="V-17822" selected="true" /><select idref="V-17823" selected="true" /><select idref="V-17824" selected="true" /><select idref="V-17825" selected="true" /><select idref="V-17826" selected="true" /><select idref="V-17827" selected="true" /><select idref="V-17832" selected="true" /><select idref="V-17833" selected="true" /><select idref="V-17834" selected="true" /><select idref="V-17835" selected="true" /><select idref="V-17836" selected="true" /><select idref="V-17837" selected="true" /><select idref="V-18522" selected="true" /><select idref="V-18523" selected="true" /><select idref="V-18544" selected="true" /><select idref="V-18545" selected="true" /><select idref="V-18566" selected="true" /><select idref="V-18790" selected="true" /><select idref="V-19188" selected="true" /><select idref="V-19189" selected="true" /><select idref="V-23747" selected="true" /><select idref="V-28784" selected="true" /><select idref="V-30577" selected="true" /><select idref="V-30578" selected="true" /><select idref="V-30585" selected="true" /><select idref="V-30617" selected="true" /><select idref="V-30660" selected="true" /><select idref="V-30736" selected="true" /><select idref="V-30744" selected="true" /><select idref="V-31285" selected="true" /></Profile><Profile id="MAC-1_Sensitive"><title>I - Mission Critial Sensitive</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-3000" selected="true" /><select idref="V-3008" selected="true" /><select idref="V-3012" selected="true" /><select idref="V-3013" selected="true" /><select idref="V-3014" selected="true" /><select idref="V-3020" selected="true" /><select idref="V-3021" selected="true" /><select idref="V-3034" selected="true" /><select idref="V-3043" selected="true" /><select idref="V-3056" selected="true" /><select idref="V-3057" selected="true" /><select idref="V-3058" selected="true" /><select idref="V-3062" selected="true" /><select idref="V-3069" selected="true" /><select idref="V-3070" selected="true" /><select idref="V-3072" selected="true" /><select idref="V-3078" selected="true" /><select idref="V-3079" selected="true" /><select idref="V-3080" selected="true" /><select idref="V-3081" selected="true" /><select idref="V-3083" selected="true" /><select idref="V-3085" selected="true" /><select idref="V-3086" selected="true" /><select idref="V-3143" selected="true" /><select idref="V-3160" selected="true" /><select idref="V-3175" selected="true" /><select idref="V-3196" selected="true" /><select idref="V-3210" selected="true" /><select idref="V-3966" selected="true" /><select idref="V-3967" selected="true" /><select idref="V-3969" selected="true" /><select idref="V-3971" selected="true" /><select idref="V-3972" selected="true" /><select idref="V-3973" selected="true" /><select idref="V-3984" selected="true" /><select idref="V-4582" selected="true" /><select idref="V-4584" selected="true" /><select idref="V-5611" selected="true" /><select idref="V-5612" selected="true" /><select idref="V-5613" selected="true" /><select idref="V-5614" selected="true" /><select idref="V-5615" selected="true" /><select idref="V-5616" selected="true" /><select idref="V-5618" selected="true" /><select idref="V-5622" selected="true" /><select idref="V-5623" selected="true" /><select idref="V-5624" selected="true" /><select idref="V-5626" selected="true" /><select idref="V-5628" selected="true" /><select idref="V-5645" selected="true" /><select idref="V-5646" selected="true" /><select idref="V-7009" selected="true" /><select idref="V-7011" selected="true" /><select idref="V-14667" selected="true" /><select idref="V-14669" selected="true" /><select idref="V-14671" selected="true" /><select idref="V-14672" selected="true" /><select idref="V-14673" selected="true" /><select idref="V-14674" selected="true" /><select idref="V-14675" selected="true" /><select idref="V-14676" selected="true" /><select idref="V-14677" selected="true" /><select idref="V-14681" selected="true" /><select idref="V-14693" selected="true" /><select idref="V-14705" selected="true" /><select idref="V-14707" selected="true" /><select idref="V-14717" selected="true" /><select idref="V-15288" selected="true" /><select idref="V-15432" selected="true" /><select idref="V-15434" selected="true" /><select idref="V-17754" selected="true" /><select idref="V-17814" selected="true" /><select idref="V-17815" selected="true" /><select idref="V-17816" selected="true" /><select idref="V-17817" selected="true" /><select idref="V-17818" selected="true" /><select idref="V-17819" selected="true" /><select idref="V-17821" selected="true" /><select idref="V-17822" selected="true" /><select idref="V-17823" selected="true" /><select idref="V-17824" selected="true" /><select idref="V-17825" selected="true" /><select idref="V-17826" selected="true" /><select idref="V-17827" selected="true" /><select idref="V-17832" selected="true" /><select idref="V-17833" selected="true" /><select idref="V-17834" selected="true" /><select idref="V-17835" selected="true" /><select idref="V-17836" selected="true" /><select idref="V-17837" selected="true" /><select idref="V-18522" selected="true" /><select idref="V-18523" selected="true" /><select idref="V-18544" selected="true" /><select idref="V-18545" selected="true" /><select idref="V-18566" selected="true" /><select idref="V-18790" selected="true" /><select idref="V-19188" selected="true" /><select idref="V-19189" selected="true" /><select idref="V-23747" selected="true" /><select idref="V-28784" selected="true" /><select idref="V-30577" selected="true" /><select idref="V-30578" selected="true" /><select idref="V-30585" selected="true" /><select idref="V-30617" selected="true" /><select idref="V-30660" selected="true" /><select idref="V-30736" selected="true" /><select idref="V-30744" selected="true" /><select idref="V-31285" selected="true" /></Profile><Profile id="MAC-2_Classified"><title>II - Mission Support Classified</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-3000" selected="true" /><select idref="V-3008" selected="true" /><select idref="V-3012" selected="true" /><select idref="V-3013" selected="true" /><select idref="V-3014" selected="true" /><select idref="V-3020" selected="true" /><select idref="V-3034" selected="true" /><select idref="V-3043" selected="true" /><select idref="V-3056" selected="true" /><select idref="V-3057" selected="true" /><select idref="V-3058" selected="true" /><select idref="V-3062" selected="true" /><select idref="V-3069" selected="true" /><select idref="V-3070" selected="true" /><select idref="V-3072" selected="true" /><select idref="V-3078" selected="true" /><select idref="V-3079" selected="true" /><select idref="V-3080" selected="true" /><select idref="V-3081" selected="true" /><select idref="V-3083" selected="true" /><select idref="V-3085" selected="true" /><select idref="V-3086" selected="true" /><select idref="V-3143" selected="true" /><select idref="V-3160" selected="true" /><select idref="V-3175" selected="true" /><select idref="V-3196" selected="true" /><select idref="V-3210" selected="true" /><select idref="V-3966" selected="true" /><select idref="V-3967" selected="true" /><select idref="V-3969" selected="true" /><select idref="V-3971" selected="true" /><select idref="V-3972" selected="true" /><select idref="V-3973" selected="true" /><select idref="V-3984" selected="true" /><select idref="V-4582" selected="true" /><select idref="V-4584" selected="true" /><select idref="V-5611" selected="true" /><select idref="V-5612" selected="true" /><select idref="V-5613" selected="true" /><select idref="V-5614" selected="true" /><select idref="V-5615" selected="true" /><select idref="V-5616" selected="true" /><select idref="V-5618" selected="true" /><select idref="V-5622" selected="true" /><select idref="V-5623" selected="true" /><select idref="V-5624" selected="true" /><select idref="V-5626" selected="true" /><select idref="V-5628" selected="true" /><select idref="V-5645" selected="true" /><select idref="V-5646" selected="true" /><select idref="V-7009" selected="true" /><select idref="V-7011" selected="true" /><select idref="V-14667" selected="true" /><select idref="V-14669" selected="true" /><select idref="V-14671" selected="true" /><select idref="V-14672" selected="true" /><select idref="V-14673" selected="true" /><select idref="V-14674" selected="true" /><select idref="V-14675" selected="true" /><select idref="V-14676" selected="true" /><select idref="V-14677" selected="true" /><select idref="V-14681" selected="true" /><select idref="V-14693" selected="true" /><select idref="V-14705" selected="true" /><select idref="V-14707" selected="true" /><select idref="V-14717" selected="true" /><select idref="V-15288" selected="true" /><select idref="V-15432" selected="true" /><select idref="V-15434" selected="true" /><select idref="V-17754" selected="true" /><select idref="V-17814" selected="true" /><select idref="V-17815" selected="true" /><select idref="V-17816" selected="true" /><select idref="V-17817" selected="true" /><select idref="V-17818" selected="true" /><select idref="V-17819" selected="true" /><select idref="V-17821" selected="true" /><select idref="V-17822" selected="true" /><select idref="V-17823" selected="true" /><select idref="V-17824" selected="true" /><select idref="V-17825" selected="true" /><select idref="V-17826" selected="true" /><select idref="V-17827" selected="true" /><select idref="V-17832" selected="true" /><select idref="V-17833" selected="true" /><select idref="V-17834" selected="true" /><select idref="V-17835" selected="true" /><select idref="V-17836" selected="true" /><select idref="V-17837" selected="true" /><select idref="V-18522" selected="true" /><select idref="V-18523" selected="true" /><select idref="V-18544" selected="true" /><select idref="V-18545" selected="true" /><select idref="V-18565" selected="true" /><select idref="V-18566" selected="true" /><select idref="V-18790" selected="true" /><select idref="V-19188" selected="true" /><select idref="V-19189" selected="true" /><select idref="V-23747" selected="true" /><select idref="V-28784" selected="true" /><select idref="V-30577" selected="true" /><select idref="V-30578" selected="true" /><select idref="V-30585" selected="true" /><select idref="V-30617" selected="true" /><select idref="V-30660" selected="true" /><select idref="V-30736" selected="true" /><select idref="V-30744" selected="true" /><select idref="V-31285" selected="true" /></Profile><Profile id="MAC-2_Public"><title>II - Mission Support Public</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-3000" selected="true" /><select idref="V-3008" selected="true" /><select idref="V-3012" selected="true" /><select idref="V-3013" selected="true" /><select idref="V-3014" selected="true" /><select idref="V-3020" selected="true" /><select idref="V-3021" selected="true" /><select idref="V-3034" selected="true" /><select idref="V-3043" selected="true" /><select idref="V-3056" selected="true" /><select idref="V-3057" selected="true" /><select idref="V-3058" selected="true" /><select idref="V-3062" selected="true" /><select idref="V-3069" selected="true" /><select idref="V-3070" selected="true" /><select idref="V-3072" selected="true" /><select idref="V-3078" selected="true" /><select idref="V-3079" selected="true" /><select idref="V-3080" selected="true" /><select idref="V-3081" selected="true" /><select idref="V-3083" selected="true" /><select idref="V-3085" selected="true" /><select idref="V-3086" selected="true" /><select idref="V-3143" selected="true" /><select idref="V-3160" selected="true" /><select idref="V-3175" selected="true" /><select idref="V-3196" selected="true" /><select idref="V-3210" selected="true" /><select idref="V-3966" selected="true" /><select idref="V-3967" selected="true" /><select idref="V-3969" selected="true" /><select idref="V-3971" selected="true" /><select idref="V-3972" selected="true" /><select idref="V-3973" selected="true" /><select idref="V-3984" selected="true" /><select idref="V-4582" selected="true" /><select idref="V-4584" selected="true" /><select idref="V-5611" selected="true" /><select idref="V-5612" selected="true" /><select idref="V-5613" selected="true" /><select idref="V-5614" selected="true" /><select idref="V-5615" selected="true" /><select idref="V-5616" selected="true" /><select idref="V-5618" selected="true" /><select idref="V-5622" selected="true" /><select idref="V-5623" selected="true" /><select idref="V-5624" selected="true" /><select idref="V-5626" selected="true" /><select idref="V-5628" selected="true" /><select idref="V-5645" selected="true" /><select idref="V-5646" selected="true" /><select idref="V-7009" selected="true" /><select idref="V-7011" selected="true" /><select idref="V-14667" selected="true" /><select idref="V-14669" selected="true" /><select idref="V-14671" selected="true" /><select idref="V-14672" selected="true" /><select idref="V-14673" selected="true" /><select idref="V-14674" selected="true" /><select idref="V-14675" selected="true" /><select idref="V-14676" selected="true" /><select idref="V-14677" selected="true" /><select idref="V-14681" selected="true" /><select idref="V-14693" selected="true" /><select idref="V-14705" selected="true" /><select idref="V-14707" selected="true" /><select idref="V-14717" selected="true" /><select idref="V-15288" selected="true" /><select idref="V-15432" selected="true" /><select idref="V-15434" selected="true" /><select idref="V-17754" selected="true" /><select idref="V-17814" selected="true" /><select idref="V-17815" selected="true" /><select idref="V-17816" selected="true" /><select idref="V-17817" selected="true" /><select idref="V-17818" selected="true" /><select idref="V-17819" selected="true" /><select idref="V-17821" selected="true" /><select idref="V-17822" selected="true" /><select idref="V-17823" selected="true" /><select idref="V-17824" selected="true" /><select idref="V-17825" selected="true" /><select idref="V-17826" selected="true" /><select idref="V-17827" selected="true" /><select idref="V-17832" selected="true" /><select idref="V-17833" selected="true" /><select idref="V-17834" selected="true" /><select idref="V-17835" selected="true" /><select idref="V-17836" selected="true" /><select idref="V-17837" selected="true" /><select idref="V-18522" selected="true" /><select idref="V-18523" selected="true" /><select idref="V-18544" selected="true" /><select idref="V-18545" selected="true" /><select idref="V-18566" selected="true" /><select idref="V-18790" selected="true" /><select idref="V-19188" selected="true" /><select idref="V-19189" selected="true" /><select idref="V-23747" selected="true" /><select idref="V-28784" selected="true" /><select idref="V-30577" selected="true" /><select idref="V-30578" selected="true" /><select idref="V-30585" selected="true" /><select idref="V-30617" selected="true" /><select idref="V-30660" selected="true" /><select idref="V-30736" selected="true" /><select idref="V-30744" selected="true" /><select idref="V-31285" selected="true" /></Profile><Profile id="MAC-2_Sensitive"><title>II - Mission Support Sensitive</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-3000" selected="true" /><select idref="V-3008" selected="true" /><select idref="V-3012" selected="true" /><select idref="V-3013" selected="true" /><select idref="V-3014" selected="true" /><select idref="V-3020" selected="true" /><select idref="V-3021" selected="true" /><select idref="V-3034" selected="true" /><select idref="V-3043" selected="true" /><select idref="V-3056" selected="true" /><select idref="V-3057" selected="true" /><select idref="V-3058" selected="true" /><select idref="V-3062" selected="true" /><select idref="V-3069" selected="true" /><select idref="V-3070" selected="true" /><select idref="V-3072" selected="true" /><select idref="V-3078" selected="true" /><select idref="V-3079" selected="true" /><select idref="V-3080" selected="true" /><select idref="V-3081" selected="true" /><select idref="V-3083" selected="true" /><select idref="V-3085" selected="true" /><select idref="V-3086" selected="true" /><select idref="V-3143" selected="true" /><select idref="V-3160" selected="true" /><select idref="V-3175" selected="true" /><select idref="V-3196" selected="true" /><select idref="V-3210" selected="true" /><select idref="V-3966" selected="true" /><select idref="V-3967" selected="true" /><select idref="V-3969" selected="true" /><select idref="V-3971" selected="true" /><select idref="V-3972" selected="true" /><select idref="V-3973" selected="true" /><select idref="V-3984" selected="true" /><select idref="V-4582" selected="true" /><select idref="V-4584" selected="true" /><select idref="V-5611" selected="true" /><select idref="V-5612" selected="true" /><select idref="V-5613" selected="true" /><select idref="V-5614" selected="true" /><select idref="V-5615" selected="true" /><select idref="V-5616" selected="true" /><select idref="V-5618" selected="true" /><select idref="V-5622" selected="true" /><select idref="V-5623" selected="true" /><select idref="V-5624" selected="true" /><select idref="V-5626" selected="true" /><select idref="V-5628" selected="true" /><select idref="V-5645" selected="true" /><select idref="V-5646" selected="true" /><select idref="V-7009" selected="true" /><select idref="V-7011" selected="true" /><select idref="V-14667" selected="true" /><select idref="V-14669" selected="true" /><select idref="V-14671" selected="true" /><select idref="V-14672" selected="true" /><select idref="V-14673" selected="true" /><select idref="V-14674" selected="true" /><select idref="V-14675" selected="true" /><select idref="V-14676" selected="true" /><select idref="V-14677" selected="true" /><select idref="V-14681" selected="true" /><select idref="V-14693" selected="true" /><select idref="V-14705" selected="true" /><select idref="V-14707" selected="true" /><select idref="V-14717" selected="true" /><select idref="V-15288" selected="true" /><select idref="V-15432" selected="true" /><select idref="V-15434" selected="true" /><select idref="V-17754" selected="true" /><select idref="V-17814" selected="true" /><select idref="V-17815" selected="true" /><select idref="V-17816" selected="true" /><select idref="V-17817" selected="true" /><select idref="V-17818" selected="true" /><select idref="V-17819" selected="true" /><select idref="V-17821" selected="true" /><select idref="V-17822" selected="true" /><select idref="V-17823" selected="true" /><select idref="V-17824" selected="true" /><select idref="V-17825" selected="true" /><select idref="V-17826" selected="true" /><select idref="V-17827" selected="true" /><select idref="V-17832" selected="true" /><select idref="V-17833" selected="true" /><select idref="V-17834" selected="true" /><select idref="V-17835" selected="true" /><select idref="V-17836" selected="true" /><select idref="V-17837" selected="true" /><select idref="V-18522" selected="true" /><select idref="V-18523" selected="true" /><select idref="V-18544" selected="true" /><select idref="V-18545" selected="true" /><select idref="V-18566" selected="true" /><select idref="V-18790" selected="true" /><select idref="V-19188" selected="true" /><select idref="V-19189" selected="true" /><select idref="V-23747" selected="true" /><select idref="V-28784" selected="true" /><select idref="V-30577" selected="true" /><select idref="V-30578" selected="true" /><select idref="V-30585" selected="true" /><select idref="V-30617" selected="true" /><select idref="V-30660" selected="true" /><select idref="V-30736" selected="true" /><select idref="V-30744" selected="true" /><select idref="V-31285" selected="true" /></Profile><Profile id="MAC-3_Classified"><title>III - Administrative Classified</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-3000" selected="true" /><select idref="V-3008" selected="true" /><select idref="V-3012" selected="true" /><select idref="V-3013" selected="true" /><select idref="V-3014" selected="true" /><select idref="V-3020" selected="true" /><select idref="V-3034" selected="true" /><select idref="V-3043" selected="true" /><select idref="V-3056" selected="true" /><select idref="V-3057" selected="true" /><select idref="V-3058" selected="true" /><select idref="V-3062" selected="true" /><select idref="V-3069" selected="true" /><select idref="V-3070" selected="true" /><select idref="V-3072" selected="true" /><select idref="V-3078" selected="true" /><select idref="V-3079" selected="true" /><select idref="V-3080" selected="true" /><select idref="V-3081" selected="true" /><select idref="V-3083" selected="true" /><select idref="V-3085" selected="true" /><select idref="V-3086" selected="true" /><select idref="V-3143" selected="true" /><select idref="V-3160" selected="true" /><select idref="V-3175" selected="true" /><select idref="V-3196" selected="true" /><select idref="V-3210" selected="true" /><select idref="V-3966" selected="true" /><select idref="V-3967" selected="true" /><select idref="V-3969" selected="true" /><select idref="V-3971" selected="true" /><select idref="V-3972" selected="true" /><select idref="V-3973" selected="true" /><select idref="V-3984" selected="true" /><select idref="V-4582" selected="true" /><select idref="V-4584" selected="true" /><select idref="V-5611" selected="true" /><select idref="V-5612" selected="true" /><select idref="V-5613" selected="true" /><select idref="V-5614" selected="true" /><select idref="V-5615" selected="true" /><select idref="V-5616" selected="true" /><select idref="V-5618" selected="true" /><select idref="V-5622" selected="true" /><select idref="V-5623" selected="true" /><select idref="V-5624" selected="true" /><select idref="V-5626" selected="true" /><select idref="V-5628" selected="true" /><select idref="V-5645" selected="true" /><select idref="V-5646" selected="true" /><select idref="V-7009" selected="true" /><select idref="V-7011" selected="true" /><select idref="V-14667" selected="true" /><select idref="V-14669" selected="true" /><select idref="V-14671" selected="true" /><select idref="V-14672" selected="true" /><select idref="V-14673" selected="true" /><select idref="V-14674" selected="true" /><select idref="V-14675" selected="true" /><select idref="V-14676" selected="true" /><select idref="V-14677" selected="true" /><select idref="V-14681" selected="true" /><select idref="V-14693" selected="true" /><select idref="V-14705" selected="true" /><select idref="V-14707" selected="true" /><select idref="V-14717" selected="true" /><select idref="V-15288" selected="true" /><select idref="V-15432" selected="true" /><select idref="V-15434" selected="true" /><select idref="V-17754" selected="true" /><select idref="V-17814" selected="true" /><select idref="V-17815" selected="true" /><select idref="V-17816" selected="true" /><select idref="V-17817" selected="true" /><select idref="V-17818" selected="true" /><select idref="V-17819" selected="true" /><select idref="V-17821" selected="true" /><select idref="V-17822" selected="true" /><select idref="V-17823" selected="true" /><select idref="V-17824" selected="true" /><select idref="V-17825" selected="true" /><select idref="V-17826" selected="true" /><select idref="V-17827" selected="true" /><select idref="V-17832" selected="true" /><select idref="V-17833" selected="true" /><select idref="V-17834" selected="true" /><select idref="V-17835" selected="true" /><select idref="V-17836" selected="true" /><select idref="V-17837" selected="true" /><select idref="V-18522" selected="true" /><select idref="V-18523" selected="true" /><select idref="V-18544" selected="true" /><select idref="V-18545" selected="true" /><select idref="V-18565" selected="true" /><select idref="V-18566" selected="true" /><select idref="V-18790" selected="true" /><select idref="V-19188" selected="true" /><select idref="V-19189" selected="true" /><select idref="V-23747" selected="true" /><select idref="V-28784" selected="true" /><select idref="V-30577" selected="true" /><select idref="V-30578" selected="true" /><select idref="V-30585" selected="true" /><select idref="V-30617" selected="true" /><select idref="V-30660" selected="true" /><select idref="V-30736" selected="true" /><select idref="V-30744" selected="true" /><select idref="V-31285" selected="true" /></Profile><Profile id="MAC-3_Public"><title>III - Administrative Public</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-3000" selected="true" /><select idref="V-3008" selected="true" /><select idref="V-3012" selected="true" /><select idref="V-3013" selected="true" /><select idref="V-3014" selected="true" /><select idref="V-3020" selected="true" /><select idref="V-3021" selected="true" /><select idref="V-3034" selected="true" /><select idref="V-3043" selected="true" /><select idref="V-3056" selected="true" /><select idref="V-3057" selected="true" /><select idref="V-3058" selected="true" /><select idref="V-3062" selected="true" /><select idref="V-3069" selected="true" /><select idref="V-3070" selected="true" /><select idref="V-3072" selected="true" /><select idref="V-3078" selected="true" /><select idref="V-3079" selected="true" /><select idref="V-3080" selected="true" /><select idref="V-3081" selected="true" /><select idref="V-3083" selected="true" /><select idref="V-3085" selected="true" /><select idref="V-3086" selected="true" /><select idref="V-3143" selected="true" /><select idref="V-3160" selected="true" /><select idref="V-3175" selected="true" /><select idref="V-3196" selected="true" /><select idref="V-3210" selected="true" /><select idref="V-3966" selected="true" /><select idref="V-3967" selected="true" /><select idref="V-3969" selected="true" /><select idref="V-3971" selected="true" /><select idref="V-3972" selected="true" /><select idref="V-3973" selected="true" /><select idref="V-3984" selected="true" /><select idref="V-4582" selected="true" /><select idref="V-4584" selected="true" /><select idref="V-5611" selected="true" /><select idref="V-5612" selected="true" /><select idref="V-5613" selected="true" /><select idref="V-5614" selected="true" /><select idref="V-5615" selected="true" /><select idref="V-5616" selected="true" /><select idref="V-5618" selected="true" /><select idref="V-5622" selected="true" /><select idref="V-5623" selected="true" /><select idref="V-5624" selected="true" /><select idref="V-5626" selected="true" /><select idref="V-5628" selected="true" /><select idref="V-5645" selected="true" /><select idref="V-5646" selected="true" /><select idref="V-7009" selected="true" /><select idref="V-7011" selected="true" /><select idref="V-14667" selected="true" /><select idref="V-14669" selected="true" /><select idref="V-14671" selected="true" /><select idref="V-14672" selected="true" /><select idref="V-14673" selected="true" /><select idref="V-14674" selected="true" /><select idref="V-14675" selected="true" /><select idref="V-14676" selected="true" /><select idref="V-14677" selected="true" /><select idref="V-14681" selected="true" /><select idref="V-14693" selected="true" /><select idref="V-14705" selected="true" /><select idref="V-14707" selected="true" /><select idref="V-14717" selected="true" /><select idref="V-15288" selected="true" /><select idref="V-15432" selected="true" /><select idref="V-15434" selected="true" /><select idref="V-17754" selected="true" /><select idref="V-17814" selected="true" /><select idref="V-17815" selected="true" /><select idref="V-17816" selected="true" /><select idref="V-17817" selected="true" /><select idref="V-17818" selected="true" /><select idref="V-17819" selected="true" /><select idref="V-17821" selected="true" /><select idref="V-17822" selected="true" /><select idref="V-17823" selected="true" /><select idref="V-17824" selected="true" /><select idref="V-17825" selected="true" /><select idref="V-17826" selected="true" /><select idref="V-17827" selected="true" /><select idref="V-17832" selected="true" /><select idref="V-17833" selected="true" /><select idref="V-17834" selected="true" /><select idref="V-17835" selected="true" /><select idref="V-17836" selected="true" /><select idref="V-17837" selected="true" /><select idref="V-18522" selected="true" /><select idref="V-18523" selected="true" /><select idref="V-18544" selected="true" /><select idref="V-18545" selected="true" /><select idref="V-18566" selected="true" /><select idref="V-18790" selected="true" /><select idref="V-19188" selected="true" /><select idref="V-19189" selected="true" /><select idref="V-23747" selected="true" /><select idref="V-28784" selected="true" /><select idref="V-30577" selected="true" /><select idref="V-30578" selected="true" /><select idref="V-30585" selected="true" /><select idref="V-30617" selected="true" /><select idref="V-30660" selected="true" /><select idref="V-30736" selected="true" /><select idref="V-30744" selected="true" /><select idref="V-31285" selected="true" /></Profile><Profile id="MAC-3_Sensitive"><title>III - Administrative Sensitive</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-3000" selected="true" /><select idref="V-3008" selected="true" /><select idref="V-3012" selected="true" /><select idref="V-3013" selected="true" /><select idref="V-3014" selected="true" /><select idref="V-3020" selected="true" /><select idref="V-3021" selected="true" /><select idref="V-3034" selected="true" /><select idref="V-3043" selected="true" /><select idref="V-3056" selected="true" /><select idref="V-3057" selected="true" /><select idref="V-3058" selected="true" /><select idref="V-3062" selected="true" /><select idref="V-3069" selected="true" /><select idref="V-3070" selected="true" /><select idref="V-3072" selected="true" /><select idref="V-3078" selected="true" /><select idref="V-3079" selected="true" /><select idref="V-3080" selected="true" /><select idref="V-3081" selected="true" /><select idref="V-3083" selected="true" /><select idref="V-3085" selected="true" /><select idref="V-3086" selected="true" /><select idref="V-3143" selected="true" /><select idref="V-3160" selected="true" /><select idref="V-3175" selected="true" /><select idref="V-3196" selected="true" /><select idref="V-3210" selected="true" /><select idref="V-3966" selected="true" /><select idref="V-3967" selected="true" /><select idref="V-3969" selected="true" /><select idref="V-3971" selected="true" /><select idref="V-3972" selected="true" /><select idref="V-3973" selected="true" /><select idref="V-3984" selected="true" /><select idref="V-4582" selected="true" /><select idref="V-4584" selected="true" /><select idref="V-5611" selected="true" /><select idref="V-5612" selected="true" /><select idref="V-5613" selected="true" /><select idref="V-5614" selected="true" /><select idref="V-5615" selected="true" /><select idref="V-5616" selected="true" /><select idref="V-5618" selected="true" /><select idref="V-5622" selected="true" /><select idref="V-5623" selected="true" /><select idref="V-5624" selected="true" /><select idref="V-5626" selected="true" /><select idref="V-5628" selected="true" /><select idref="V-5645" selected="true" /><select idref="V-5646" selected="true" /><select idref="V-7009" selected="true" /><select idref="V-7011" selected="true" /><select idref="V-14667" selected="true" /><select idref="V-14669" selected="true" /><select idref="V-14671" selected="true" /><select idref="V-14672" selected="true" /><select idref="V-14673" selected="true" /><select idref="V-14674" selected="true" /><select idref="V-14675" selected="true" /><select idref="V-14676" selected="true" /><select idref="V-14677" selected="true" /><select idref="V-14681" selected="true" /><select idref="V-14693" selected="true" /><select idref="V-14705" selected="true" /><select idref="V-14707" selected="true" /><select idref="V-14717" selected="true" /><select idref="V-15288" selected="true" /><select idref="V-15432" selected="true" /><select idref="V-15434" selected="true" /><select idref="V-17754" selected="true" /><select idref="V-17814" selected="true" /><select idref="V-17815" selected="true" /><select idref="V-17816" selected="true" /><select idref="V-17817" selected="true" /><select idref="V-17818" selected="true" /><select idref="V-17819" selected="true" /><select idref="V-17821" selected="true" /><select idref="V-17822" selected="true" /><select idref="V-17823" selected="true" /><select idref="V-17824" selected="true" /><select idref="V-17825" selected="true" /><select idref="V-17826" selected="true" /><select idref="V-17827" selected="true" /><select idref="V-17832" selected="true" /><select idref="V-17833" selected="true" /><select idref="V-17834" selected="true" /><select idref="V-17835" selected="true" /><select idref="V-17836" selected="true" /><select idref="V-17837" selected="true" /><select idref="V-18522" selected="true" /><select idref="V-18523" selected="true" /><select idref="V-18544" selected="true" /><select idref="V-18545" selected="true" /><select idref="V-18566" selected="true" /><select idref="V-18790" selected="true" /><select idref="V-19188" selected="true" /><select idref="V-19189" selected="true" /><select idref="V-23747" selected="true" /><select idref="V-28784" selected="true" /><select idref="V-30577" selected="true" /><select idref="V-30578" selected="true" /><select idref="V-30585" selected="true" /><select idref="V-30617" selected="true" /><select idref="V-30660" selected="true" /><select idref="V-30736" selected="true" /><select idref="V-30744" selected="true" /><select idref="V-31285" selected="true" /></Profile><Group id="V-3000"><title>Interface ACL deny statements are not logged.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-15474r3_rule" severity="low" weight="10.0"><version>NET1020</version><title>The network device must log all access control lists (ACL) deny statements.</title><description>&lt;VulnDiscussion&gt;Auditing and logging are key components of any security architecture.  It is essential for security personnel to know what is being done, attempted to be done, and by whom in order to compile an accurate risk assessment.  Auditing the actions on network devices provides a means to recreate an attack, or identify a configuration mistake on the device.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECAT-1, ECAT-2, ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-3025r4_fix">Configure interface ACLs to log all deny statements.</fixtext><fix id="F-3025r4_fix" /><check system="C-12940r3_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Review the network device interface ACLs to verify all deny statements are logged.

Cisco IOS example:
interface FastEthernet 0/0 
description external interface peering with ISP or non-DoD network
ip address 199.36.92.1 255.255.255.252
ip access-group 100 in
…
access-list 100 deny icmp any any fragments log
access-list 100 deny ip 169.254.0.0 0.0.255.255 any log
access-list 100 deny ip 10.0.0.0 0.255.255.255 any log
access-list 100 deny ip 172.16.0.0 0.15.255.255 any log
access-list 100 deny ip 192.168.0.0 0.0.255.255 any log
access-list 100 permit icmp any host 199.36.92.1 echo-reply
access-list 100 permit icmp any host 199.36.90.10 echo-reply
access-list 100 deny icmp any any log
access-list 100 deny ip any any log</check-content></check></Rule></Group><Group id="V-3008"><title>IPSec VPN is not configured as a tunnel type VPN.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-3008r1_rule" severity="medium" weight="10.0"><version>NET1800</version><title>The IAO will ensure IPSec VPNs are established as tunnel type VPNs when transporting management traffic across an ip backbone network.</title><description>&lt;VulnDiscussion&gt;Using dedicated paths, the OOBM backbone connects the OOBM gateway routers located at the premise of the managed networks and at the NOC.  Dedicated links can be deployed using provisioned circuits (ATM, Frame Relay, SONET, T-carrier, and others or VPN technologies such as subscribing to MPLS Layer 2 and Layer 3 VPN services) or implementing a secured path with gateway-to-gateway IPsec tunnel.  The tunnel mode ensures that the management traffic will be logically separated from any other traffic traversing the same path.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;EBVC-1, ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-3033r1_fix">Establish the VPN as a tunneled VPN.

Terminate the tunneled VPN outside of the firewall.

Ensure all host-to-host VPN are established between trusted known hosts.

</fixtext><fix id="F-3033r1_fix" /><check system="C-3837r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Have the SA display the configuration settings that enable this feature.

Review the network topology diagram, and review VPN concentrators. Determine if tunnel mode is being used by reviewing the configuration. Examples:

In CISCO 
Router(config)# crypto ipsec transform-set transform-set-name transform1 
Router(cfg-crypto-tran)# mode tunnel 

OR in Junos 
edit security ipsec security-association sa-name] mode tunnel</check-content></check></Rule></Group><Group id="V-3012"><title>Network element is not password protected.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-3012r2_rule" severity="high" weight="10.0"><version>NET0230</version><title>The network element must be password protected.</title><description>&lt;VulnDiscussion&gt;Network access control mechanisms interoperate to prevent unauthorized access and to enforce the organization’s security policy. Access to the network must be categorized as administrator, user, or guest so the appropriate authorization can be assigned to the user requesting access to the network or a network element. Authorization requires an individual account identifier that has been approved, assigned, and configured on an authentication server. Authentication of user identities is accomplished through the use of passwords, tokens, biometrics, or in the case of multi-factor authentication, some combination thereof. Lack of authentication enables anyone to gain access to the network or possibly a network element providing opportunity for intruders to compromise resources within the network infrastructure.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1, IAIA-1, IAIA-2&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-3037r5_fix">Configure the network element so it will require a password to gain administrative access to the device.</fixtext><fix id="F-3037r5_fix" /><check system="C-3456r3_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Review the network element configuration to determine if administrative access to the device requires some form of authentication—at a minimum a password is required.</check-content></check></Rule></Group><Group id="V-3013"><title>Login banner is non-existent or not DOD approved.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-3013r2_rule" severity="medium" weight="10.0"><version>NET0340</version><title>The network element must display the DoD approved login banner warning in accordance with the CYBERCOM DTM-08-060 document.</title><description>&lt;VulnDiscussion&gt;All network devices must present  a DoD approved warning banner prior to a system administrator logging on. The banner should warn any unauthorized user not to proceed. It also should provide clear and unequivocal notice to both authorized and unauthorized personnel that access to the device is subject to monitoring to detect unauthorized usage. Failure to display the required login warning banner prior to logon attempts will limit DoD’s ability to prosecute unauthorized access and also presents the potential to give rise to criminal and civil liability for systems administrators and information systems managers. In addition, DISA’s ability to monitor the device’s usage is limited unless a proper warning banner is displayed.

DoD CIO has issued new, mandatory policy standardizing the wording of “notice and consent” banners and matching user agreements for all Secret and below DoD information systems, including stand-alone systems by releasing DoD CIO Memo, “Policy on Use of Department of Defense (DoD) Information Systems Standard Consent Banner and User Agreement”, dated 9 May 2008. The banner is mandatory and deviations are not permitted except as authorized in writing by the Deputy Assistant Secretary of Defense for Information and Identity Assurance. Implementation of this banner verbiage is further directed to all DoD components for all DoD assets via USCYBERCOM CTO 08-008A.
&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECWM-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-3038r6_fix">Configure all management interfaces to the network device to display the DoD mandated warning banner verbiage at login regardless of the means of connection or communication. The required banner verbiage that must be displayed verbatim is as follows:

Option A

You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only. By using this IS (which includes any device attached to this IS), you consent to the following conditions:

-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and
counterintelligence (CI) investigations.
-At any time, the USG may inspect and seize data stored on this IS.
-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.
-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.
-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.

Option B

If the system is incapable of displaying the required banner verbiage due to its size, a smaller banner must be used. The mandatory verbiage follows: “I've read &amp; consent to terms in IS user agreem't.”</fixtext><fix id="F-3038r6_fix" /><check system="C-3474r8_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Review the device configuration or request that the administrator login to the device and observe the terminal. Verify either Option A or Option B (for systems with character limitations) of the Standard Mandatory DoD Notice and Consent Banner is displayed at logon. The required banner verbiage follows and must be displayed verbatim:

Option A

You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only. By using this IS (which includes any device attached to this IS), you consent to the following conditions:

-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and
counterintelligence (CI) investigations.
-At any time, the USG may inspect and seize data stored on this IS.
-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.
-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.
-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.

Option B

If the system is incapable of displaying the required banner verbiage due to its size, a smaller banner must be used. The mandatory verbiage follows: “I've read &amp; consent to terms in IS user agreem't.”</check-content></check></Rule></Group><Group id="V-3014"><title>Management connection does not timeout.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-15453r2_rule" severity="medium" weight="10.0"><version>NET1639</version><title>The network element must timeout management connections for administrative access after 10 minutes or less of inactivity.</title><description>&lt;VulnDiscussion&gt;Setting the timeout of the session to 10 minutes or less increases the level of protection afforded critical network components.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-3039r4_fix">Configure the network element to ensure the timeout for unattended administrative access connections is no longer than 10 minutes. </fixtext><fix id="F-3039r4_fix" /><check system="C-12918r4_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Review the management connection for administrative access and verify the network element is configured to time-out the connection after 10 minutes or less of inactivity. The default for the VTY line is 10 minutes and may not appear in the display of the configuration. The VTY line should contain the following command:

exec-timeout 10
</check-content></check></Rule></Group><Group id="V-3020"><title>DNS servers must be defined for client resolver. </title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-15330r2_rule" severity="low" weight="10.0"><version>NET0820</version><title>The network element must have DNS servers defined if it is configured as a client resolver.</title><description>&lt;VulnDiscussion&gt;The susceptibility of IP addresses to spoofing translates to DNS host name and IP address mapping vulnerabilities.  For example, suppose a source host wishes to establish a connection with a destination host and queries a DNS server for the IP address of the destination host name.  If the response to this query is the IP address of a host operated by an attacker, the source host will establish a connection with the attackers host, rather than the intended target.  The user on the source host might then provide logon, authentication, and other sensitive data.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-3045r2_fix">Configure the device to include DNS servers or disable domain lookup.</fixtext><fix id="F-3045r2_fix" /><check system="C-12796r2_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Review the device configuration to ensure that DNS servers have been defined if it has been configured as a client resolver (name lookup). The configuration should look similar to one of the following examples: 
ip domain-lookup
ip name-server 192.168.1.253

or

no ip domain-lookup		

The first configuration example has DNS lookup enabled and hence has defined its DNS server. The second example has DNS lookup disabled.

Note: ip domain-lookup is enabled by default. Hence it may not be shown—depending on the IOS release. If it is enabled, it will be shown near the beginning of the configuration.
</check-content></check></Rule></Group><Group id="V-3021"><title>SNMP access is not restricted by IP address.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-15332r2_rule" severity="medium" weight="10.0"><version>NET0890</version><title>The network element must only allow SNMP access from addresses belonging to the management network.</title><description>&lt;VulnDiscussion&gt;Detailed information about the network is sent across the network via SNMP.  If this information is discovered by attackers it could be used to trace the network, show the networks topology, and possibly gain access to network devices.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-3046r3_fix">Configure the network element to only allow SNMP access from only addresses belonging to the management network.</fixtext><fix id="F-3046r3_fix" /><check system="C-12798r3_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Review device configuration and verify that it is configured to only allow SNMP access from only addresses belonging to the management network. The following examples for SNMP v1, 2, and 3 depict the use of an ACL to restrict SNMP access to the device.

SNMP v1/v2c Configuration Example

The example ACL NMS_LIST is used to define what network management stations can access the device for write and read only (poll).

ip access-list standard NMS_LIST
 permit 10.1.1.24
 permit 10.1.1.22
 permit 10.1.1.23
!         
snmp-server community ourCommStr RO RW NMS_LIST
snmp-server community write_pw RW NMS_LIST
snmp-server enable traps snmp linkdown linkup
snmp-server host 10.1.1.1 trap_comm_string 

Note: If you enter the snmp-server host command with no keywords, the default is version 1 and to send all enabled traps to the host.  No informs will be sent to this host.  If no traps or informs keyword is present, traps are sent.

SNMP v3 Configuration Example

The example ACL NMS_LIST  and ADMIN_LIST are used to define what network management stations and administrator (users) desktops can access the device.

ip access-list standard ADMIN_LIST
 permit 10.1.1.35
 permit 10.1.1.36
ip access-list standard NMS_LIST
 permit 10.1.1.24
 permit 10.1.1.22
 permit 10.1.1.23
!
snmp-server group NOC v3 priv read VIEW_ALL write VIEW_LIMIT access NMS_LIST
snmp-server group TRAP_GROUP v3 priv notify
*tv.FFFFFFFF.FFFFFFFF.FFFFFFFF.FFFFFFFF0F 
snmp-server group ADMIN_GROUP v3 priv read VIEW_ALL write VIEW_ALL access ADMIN_LIST
snmp-server view VIEW_ALL internet included
snmp-server view VIEW_LIMIT internet included
snmp-server view VIEW_LIMIT internet.6.3.15 excluded
snmp-server view VIEW_LIMIT internet.6.3.16 excluded
snmp-server view VIEW_LIMIT internet.6.3.18 excluded
snmp-server enable traps snmp linkdown linkup
snmp-server host 10.1.1.24 version 3 priv TRAP_NMS1 

Note: For the configured group TRAP_GROUP, the notify view is auto-generated by the snmp-server host command which bind the user (TRAP_NMS1) and the group it belongs to (TRAP_GROUP) to the list of notifications (traps or informs) which are sent to the host. Hence, the configuration snmp-server group TRAP_GROUP v3 results in the following:
snmp-server group TRAP_GROUP v3 priv notify *tv.FFFFFFFF.FFFFFFFF.FFFFFFFF.FFFFFFFF0F


Note: Not required but for illustration purpose, the VIEW_LIMIT excludes MIB objects which could potentially reveal information about configured SNMP credentials. These objects are snmpUsmMIB, snmpVacmMIB, and snmpCommunityMIB which is configured as 1.3.6.1.6.3.15, 1.3.6.1.6.3.16, and 1.3.6.1.6.3.18 respectively


Note that SNMPv3 users are not shown in a running configuration. You can view them with the show snmp user command. So for example, if the following users were configured as such.

snmp-server user HP_OV NOC v3 auth sha HPOVpswd priv aes 256 HPOVsecretkey
snmp-server user Admin1 ADMIN_GROUP v3 auth sha Admin1PW priv aes 256 Admin1key
snmp-server user Admin2 ADMIN_GROUP v3 auth md5 Admin2pass priv 3des Admin2key
snmp-server user TRAP_NMS1 TRAP_GROUP  v3 auth sha trap_nms1_pw priv aes trap_nms1_key

The show snmp user command would depict the configured users as follows:

R1#show snmp user

User name: HP_OV
Engine ID: AB12CD34EF56
storage-type: nonvolatile        active
Authentication Protocol: SHA
Privacy Protocol: AES256
Group-name: NOC

User name: Admin1
Engine ID: 800000090300C20013080000
storage-type: nonvolatile        active
Authentication Protocol: SHA
Privacy Protocol: AES256
Group-name: ADMIN_GROUP

User name: Admin2
Engine ID: 800000090300C20013080000
storage-type: nonvolatile        active
Authentication Protocol: MD5
Privacy Protocol: 3DES
Group-name: ADMIN_GROUP

User name: TRAP_NMS1
Engine ID: 800000090300C20013080000
storage-type: nonvolatile        active
Authentication Protocol: SHA
Privacy Protocol: AES256
Group-name: TRAP_GROUP

R1#
</check-content></check></Rule></Group><Group id="V-3034"><title>Interior routing protocols are not authenticated.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-15290r2_rule" severity="medium" weight="10.0"><version>NET0400</version><title>The network element must authenticate all IGP peers.</title><description>&lt;VulnDiscussion&gt;A rogue router could send a fictitious routing update to convince a site’s premise router to send traffic to an incorrect or even a rogue destination.  This diverted traffic could be analyzed to learn confidential information of the site’s network, or merely used to disrupt the network’s ability to effectively communicate with other networks.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-3059r3_fix">Configure authentication for all IGP peers.</fixtext><fix id="F-3059r3_fix" /><check system="C-3489r3_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Ensure authentication is implemented for IGP peers.</check-content></check><check system="C-12679r2_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>OSPF Example

interface Ethernet0
 ip address 10.10.10.10 255.255.255.0
 ip ospf message-digest-key 10 md5 mypassword
…
router ospf 10
 network 10.10.0.0 0.0.255.255 area 0
 area 0 authentication message-digest

Note: Authentication has to be enabled for each area. In OSPF, an interface belongs to only one area; hence, there would always be a network statement under the OSPF process ID for each interface that has OSPF traffic. The network statement defines the area in which the network belongs. The MD5 key-id and password is defined under each interface connected to an OSPF neighbor.

EIGRP Example

interface Ethernet0
 ip address 10.10.10.10 255.255.255.0
 ip authentication mode eigrp 1 md5
 ip authentication key-chain eigrp 1 mypassword
…
key chain mypassword
 key 12
 key-string abcdefg
 accept-lifetime infinite
…
router eigrp 1
 network 10.0.0.0
 no auto-summary
</check-content></check></Rule></Group><Group id="V-3043"><title>SNMP privileged and non-privileged access.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-3043r2_rule" severity="medium" weight="10.0"><version>NET1675</version><title>The network element must use different SNMP community names or groups for various levels of read and write access.</title><description>&lt;VulnDiscussion&gt;Numerous vulnerabilities exist with SNMP; therefore, without unique SNMP community names, the risk of compromise is dramatically increased. This is especially true with vendors default community names which are widely known by hackers and other networking experts. If a hacker gains access to these devices and can easily guess the name, this could result in denial of service, interception of sensitive information, or other destructive actions.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-3068r2_fix">Configure the SNMP community strings on the network element and change them from the default values.  SNMP community strings and user passwords must be unique and do not match any other network device passwords.  Different community strings (V1/2) or groups (V3) must be configured for various levels of read and write access.</fixtext><fix id="F-3068r2_fix" /><check system="C-3825r5_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Review the SNMP configuration of all managed nodes to ensure different community names (V1/2) or groups/users (V3) are configured for read-only and read-write access. </check-content></check></Rule></Group><Group id="V-3056"><title>Group accounts are defined.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-3056r5_rule" severity="high" weight="10.0"><version>NET0460</version><title>Group accounts must not be configured for use on the network device.
</title><description>&lt;VulnDiscussion&gt;Group accounts configured for use on a network device do not allow for accountability or repudiation of individuals using the shared account.  If group accounts are not changed when someone leaves the group, that person could possibly gain control of the network device.  Having group accounts does not allow for proper auditing of who is accessing or changing the network.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;IAIA-1, IAIA-2&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-3081r9_fix">Configure individual user accounts for each authorized person then remove any group accounts.</fixtext><fix id="F-3081r9_fix" /><check system="C-3503r9_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Review the network device configuration and validate there are no group accounts configured for access.</check-content></check></Rule></Group><Group id="V-3057"><title>Accounts assigned least privileges necessary to perform duties.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-15471r3_rule" severity="medium" weight="10.0"><version>NET0465</version><title>Authorized accounts must be assigned the least privilege level necessary to perform assigned duties.</title><description>&lt;VulnDiscussion&gt;By not restricting authorized accounts to their proper privilege level, access to restricted functions may be allowed before authorized personell are trained or experienced enough to use those functions.  Network disruptions or outages may occur due to mistakes made by inexperienced persons using accounts with greater privileges than necessary.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-3082r5_fix">Configure authorized accounts with the least privilege rule. Each user will have access to only the privileges they require to perform their assigned duties.</fixtext><fix id="F-3082r5_fix" /><check system="C-12937r4_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Review the accounts authorized for access to the network device. Determine if the accounts are assigned the lowest privilege level necessary to perform assigned duties. User accounts must be set to a specific privilege level which can be mapped to specific commands or a group of commands. Authorized accounts should have the greatest privilege level unless deemed necessary for assigned duties.

If it is determined that authorized accounts are assigned to greater privileges than necessary, this is a finding.

Below is an example of assigning a privilege level to a local user account and changing the default privilege level of the configure terminal command.

username junior-engineer1 privilege 7 password xxxxxx
privilege exec level 7 configure terminal

The above example only covers local accounts. You will also need to check the accounts and their associated privilege levels configured in the authentication server. You can also use TACACS+ for even more granularity at the command level as shown in the following example:

user = junior-engineer1 {
       password = clear "xxxxx"
       service = shell  {
             set priv-lvl = 7
       }
}</check-content></check></Rule></Group><Group id="V-3058"><title>Unauthorized accounts are configured to access device.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-3058r3_rule" severity="medium" weight="10.0"><version>NET0470</version><title>Unauthorized accounts must not be configured for access to the network device.</title><description>&lt;VulnDiscussion&gt;A malicious user attempting to gain access to the network device may compromise an account that may be unauthorized for use.  The unauthorized account may be a temporary or inactive account that is no longer needed to access the device.  Denial of Service, interception of sensitive information, or other destructive actions could potentially take place if an unauthorized account is configured to access the network device.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1, IAAC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-3083r5_fix">Remove any account configured for access to the network device that is not defined in the organization's responsibilities list.</fixtext><fix id="F-3083r5_fix" /><check system="C-3505r4_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Review the organization's responsibilities list and reconcile the list of authorized account with those accounts defined for access to the network device.

If an unauthorized account is configured for access to the device, this is a finding.</check-content></check></Rule></Group><Group id="V-3062"><title>Passwords are viewable when displaying the config.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-41449r2_rule" severity="high" weight="10.0"><version>NET0600</version><title>The network element must be configured to ensure passwords are not viewable when displaying configuration information.  </title><description>&lt;VulnDiscussion&gt;Many attacks information systems and network elements are launched from within the network. Hence, it is imperative that all passwords are encrypted so they cannot be intercepted by viewing the console or printout of the configuration. 
&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-40534r1_fix">Configure the network element to ensure passwords are not viewable when displaying configuration information.

Device(config)# service password
Device(config)# username name secret S3cr3T!
Device(config)# enable secret $MyS3cr3TPW$
Device(config)# end</fixtext><fix id="F-40534r1_fix" /><check system="C-39960r6_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Review all Cisco IOS routers and switches to determine if the global command "service password-encryption" is present in the configurations.

Also, review all accounts created on the device to ensure they have been setup using the "username name secret password" command.  The following command will be found in the device configurations

Device# show run
!
service password-encryption
!
username name secret 5 $1$geU5$vc/uDRS5dWiOrpQJTimBw/
enable secret 5 $1%mer9396y30d$FDA/292/</check-content></check></Rule></Group><Group id="V-3069"><title>Management connections  must be secured by FIPS 140-2. </title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-15451r3_rule" severity="medium" weight="10.0"><version>NET1638</version><title>Management connections to a network device must be established using secure protocols with FIPS 140-2 validated cryptographic modules.</title><description>&lt;VulnDiscussion&gt;Administration and management connections performed across a network are inherently dangerous because anyone with a packet sniffer and access to the right LAN segment can acquire the network device account and password information.  With this intercepted information they could gain access to the router and cause denial of service attacks, intercept sensitive information, or perform other destructive actions.
&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;DCNR-1, ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-3094r5_fix">Configure the network device to use secure protocols with FIPS 140-2 validated cryptographic modules.</fixtext><fix id="F-3094r5_fix" /><check system="C-12916r5_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Review the network device configuration to verify only secure protocols using FIPS 140-2 validated cryptographic modules are used for any administrative access.  Some of the secure protocols used for administrative and management access are listed below.  This list is not all inclusive and represents a sample selection of secure protocols.  

-SSHv2
-SCP
-HTTPS
-SSL
-TLS

This is an example that enables SSHv2/SCP/HTTPS on an IOS Device:
!
ip domain-name example.com
!
crypto key generate rsa modulus 2048
!
ip ssh time-out 60
ip ssh authentication-retries 3
ip ssh source-interface GigabitEthernet 0/1
ip ssh version 2
!
line vty 0 15
transport input ssh
!
ip scp server enable
!
ip http secure-server

If management connections are established using protocols without FIPS 140-2 validated cryptographic modules, this is a finding.</check-content></check></Rule></Group><Group id="V-3070"><title>Management connections must be logged.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-15455r2_rule" severity="low" weight="10.0"><version>NET1640</version><title>The network element must log all attempts to establish a management connection for administrative access.</title><description>&lt;VulnDiscussion&gt;Audit logs are necessary to provide a trail of evidence in case the network is compromised.  Without an audit trail that provides a when, where, who and how set of information, repeat offenders could continue attacks against the network indefinitely.  With this information, the network administrator can devise ways to block the attack and possibly identify and prosecute the attacker.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECAT-1, ECAT-2&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-3095r3_fix">Configure the device to log all access attempts to the device to establish a management connection for administrative access.</fixtext><fix id="F-3095r3_fix" /><check system="C-12920r2_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Review each Cisco router configuration to ensure that all connection attempts to the VTY ports are logged as shown in the following example:

access-list 3 permit 192.168.1.10 log
access-list 3 permit 192.168.1.11 log
access-list 3 deny any log
…
line vty 0 4
access-class 3 in
</check-content></check></Rule></Group><Group id="V-3072"><title>Running and startup configurations are not synchronized.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-3072r2_rule" severity="low" weight="10.0"><version>NET1030</version><title>The network element’s running configuration must be synchronized with the startup configuration after changes have been made and implemented.</title><description>&lt;VulnDiscussion&gt;If the running and startup router configurations are not synchronized properly and a router malfunctions, it will not restart with all of the recent changes incorporated.  If the recent changes were security related, then the routers would be vulnerable to attack.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;COBR-1, ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-3097r4_fix">Add procedures to the standard operating procedure to keep the running configuration synchronized with the startup configuration.</fixtext><fix id="F-3097r4_fix" /><check system="C-3636r5_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>IOS Procedure: With online editing, the "show running-config" command will only show the current running configuration settings, which are different from the IOS defaults. The "show startup-config" command will show the NVRAM startup configuration. Compare the two configurations to ensure they are synchronized. 


JUNOS Procedure: This will never be a finding. The active configuration is stored on flash as juniper.conf. A candidate configuration allows configuration changes while in configuration mode without initiating operational changes. The router implements the candidate configuration when it is committed; thereby, making it the new active configuration—at which time it will be stored on flash as juniper.conf and the old juniper.conf will become juniper.conf.1.
</check-content></check></Rule></Group><Group id="V-3078"><title>TCP and UDP small server services are not disabled.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-3078r2_rule" severity="low" weight="10.0"><version>NET0720</version><title>The network element must have TCP &amp; UDP small servers disabled.</title><description>&lt;VulnDiscussion&gt;Cisco IOS provides the "small services" that include echo, chargen, and discard. These services, especially their User Datagram Protocol (UDP) versions, are infrequently used for legitimate purposes. However, they have been used to launch denial of service attacks that would otherwise be prevented by packet filtering. For example, an attacker might send a DNS packet, falsifying the source address to be a DNS server that would otherwise be unreachable, and falsifying the source port to be the DNS service port (port 53). If such a packet were sent to the Cisco's UDP echo port, the result would be Cisco sending a DNS packet to the server in question. No outgoing access list checks would be applied to this packet, since it would be considered locally generated by the router itself. The small services are disabled by default in Cisco IOS 12.0 and later software. In earlier software, they may be disabled using the commands no service tcp-small-servers and no service udp-small-servers.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-3103r4_fix">Change the device configuration to include the following IOS commands: no service tcp-small-servers and no service udp-small-servers for each device running an IOS version prior to 12.0.  This is the default for IOS versions 12.0 and later (i.e., these commands will not appear in the running configuration.)</fixtext><fix id="F-3103r4_fix" /><check system="C-3551r3_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Review all Cisco device configurations to verify service udp-small-servers and service tcp-small-servers are not found.  

Note:  The TCP and UDP small servers are enabled by default on Cisco IOS Software Version 11.2 and earlier.  They are disabled by default on Cisco IOS Software Versions 11.3 and later.  
</check-content></check></Rule></Group><Group id="V-3079"><title>The finger service is not disabled.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-15305r2_rule" severity="low" weight="10.0"><version>NET0730</version><title>The network element must have the Finger service disabled.</title><description>&lt;VulnDiscussion&gt;The finger service supports the UNIX finger protocol, which is used for querying a host about the users that are logged on. This service is not necessary for generic users. If an attacker were to find out who is using the network, they may use social engineering practices to try to elicit classified DoD information.

&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-3104r3_fix">Disable the finger service.</fixtext><fix id="F-3104r3_fix" /><check system="C-12701r2_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Review the device configuration. Beginning with IOS 12.1(5), finger is disabled by default. For IOS version 12.0 through 12.1(4), verify that the no ip finger command is present. For any version prior to 12.0, verify that the no service finger command is present.</check-content></check></Rule></Group><Group id="V-3080"><title>Configuration auto-loading must be disabled.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-3080r2_rule" severity="medium" weight="10.0"><version>NET0760</version><title>The router must have configuration auto-loading disabled.</title><description>&lt;VulnDiscussion&gt;Routers can find their startup configuration either in their own NVRAM or access it over the network via TFTP or Remote Copy (rcp). Loading the image from the network is taking a security risk since the image could be intercepted by an attacker who could corrupt the image resulting in a denial of service.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-3105r4_fix">IOS Procedure: Disable configuration auto-loading by entering the "no boot network" and "no service config" commands. </fixtext><fix id="F-3105r4_fix" /><check system="C-3574r5_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>IOS Procedure: Review the router configuration and verify the "boot network" and "service config" commands are not defined.  Since version 12.0, these commands have been disabled by default. If configured, the "service config" command will be found right after the version, and the "boot network" command will be found between the boot-start-marker and boot-end-marker commands.   </check-content></check></Rule></Group><Group id="V-3081"><title>IP Source Routing is not disabled on all routers.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-15316r2_rule" severity="medium" weight="10.0"><version>NET0770</version><title>The router must have IP source routing disabled.</title><description>&lt;VulnDiscussion&gt;Source routing is a feature of IP, whereby individual packets can specify routes. This feature is used in several different network attacks by bypassing perimeter and internal defense mechanisms.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-3106r2_fix">Configure the router to disable IP source routing.</fixtext><fix id="F-3106r2_fix" /><check system="C-12782r2_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Review the configuration to determine if source routing is enabled. The IOS command no ip source-route must be included in the configuration.</check-content></check></Rule></Group><Group id="V-3083"><title>IP directed broadcast is not disabled.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-3083r2_rule" severity="low" weight="10.0"><version>NET0790</version><title>The router must have IP directed broadcast disabled on all layer 3 interfaces.</title><description>&lt;VulnDiscussion&gt;An IP directed broadcast is a datagram sent to the broadcast address of a subnet that is not directly attached to the sending machine. The directed broadcast is routed through the network as a unicast packet until it arrives at the target subnet, where it is converted into a link-layer broadcast. Because of the nature of the IP addressing architecture, only the last router in the chain, which is connected directly to the target subnet, can conclusively identify a directed broadcast.

IP directed broadcasts are used in the extremely common and popular smurf, or Denial of Service (DoS), attacks. In a smurf attack, the attacker sends ICMP echo requests from a falsified source address to a directed broadcast address, causing all the hosts on the target subnet to send replies to the falsified source. By sending a continuous stream of such requests, the attacker can create a much larger stream of replies, which can completely inundate the host whose address is being falsified. This service should be disabled on all interfaces when not needed to prevent smurf and DoS attacks.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-3108r3_fix">Change the router configuration files to disable IP directed broadcast on all interfaces.</fixtext><fix id="F-3108r3_fix" /><check system="C-3578r3_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>IOS Procedure:  IP directed broadcast is disabled by default in IOS version 12.0 and higher so the command "no ip directed-broadcast" will not be displayed in the running configuration—verify that the running configuration does not contain the command "ip directed-broadcast".  For versions prior to 12.0 ensure the command "no ip directed-broadcast" is displayed in the running configuration.    

Directed broadcast can be enabled on internal facing interfaces to support services such as Wake-On-LAN. Case scenario may also include support for legacy applications where the content server and the clients do not support multicast.  The content servers send streaming data using UDP broadcast. Used in conjunction with the ip multicast helper-map feature, broadcast data can be sent across a multicast topology. The broadcast streams are converted to multicast and vice versa at the first-hop routers and last-hop routers before entering leaving the multicast transit area respectively. The last-hop router must convert the multicast to broadcast. Hence, this interface must be configured to forward a broadcast packet (i.e. a directed broadcast address is converted to the all nodes broadcast address).
</check-content></check></Rule></Group><Group id="V-3085"><title>HTTP server is not disabled </title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-41467r1_rule" severity="medium" weight="10.0"><version>NET0740</version><title>The network element must have HTTP service for administrative access disabled.</title><description>&lt;VulnDiscussion&gt;The additional services that the router is enabled for increases the risk for an attack since the router will listen for these services. In addition, these services provide an unsecured method for an attacker to gain access to the router.  Most recent software versions support remote configuration and monitoring using the World Wide Web's HTTP protocol.  In general, HTTP access is equivalent to interactive access to the router.  The authentication protocol used for HTTP is equivalent to sending a clear-text password across the network, and, unfortunately, there is no effective provision in HTTP for challenge-based or one-time passwords.  This makes HTTP a relatively risky choice for use across the public Internet.  Any additional services that are enabled increase the risk for an attack since the router will listen for these services.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-3110r4_fix">Configure the device to disable using HTTP (port 80) for administrative access.</fixtext><fix id="F-3110r4_fix" /><check system="C-39966r2_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Verify that the command "ip http-server" is not defined in the configuration. As of 12.4, the http server is still disabled by default. However, since many defaults are not shown by IOS, you may not see the command "no ip http-server" in the configuration depending on the release.</check-content></check></Rule></Group><Group id="V-3086"><title>The Bootp service is not disabled.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-3086r2_rule" severity="low" weight="10.0"><version>NET0750</version><title>The router must have Bootp service disabled.</title><description>&lt;VulnDiscussion&gt;Bootp is a user datagram protocol (UDP) that can be used by Cisco routers to access copies of Cisco IOS Software on another Cisco router running the Bootp service. In this scenario, one Cisco router acts as a Cisco IOS Software server that can download the software to other Cisco routers acting as Bootp clients. In reality, this service is rarely used and can allow an attacker to download a copy of a router’s Cisco IOS Software.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSD-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-3111r5_fix">Change the configuration to include the IOS command "no ip bootp server". 
</fixtext><fix id="F-3111r5_fix" /><check system="C-3573r4_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Review the router configuration to verify the IOS command "no ip bootp server" is present.     

</check-content></check></Rule></Group><Group id="V-3143"><title>Devices exist with standard default passwords.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-3143r2_rule" severity="high" weight="10.0"><version>NET0240</version><title>The network element must not have any default manufacturer passwords.</title><description>&lt;VulnDiscussion&gt;Network elements not protected with strong password schemes provide the opportunity for anyone to crack the password thus gaining access to the device and causing network outage or denial of service.  Many default vendor passwords are well known; hence, not removing them prior to deploying the network element into production provides an opportunity for a malicious user to gain unauthorized access to the device.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-35391r2_fix">Remove any vendor default passwords from the network element configuration.</fixtext><fix id="F-35391r2_fix" /><check system="C-40236r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Review the network element configuration to determine if the vendor default password is active.</check-content></check></Rule></Group><Group id="V-3160"><title>Operating system is not at a current release level.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-15302r2_rule" severity="medium" weight="10.0"><version>NET0700</version><title>The network element must be running a current and supported operating system with all IAVMs addressed.</title><description>&lt;VulnDiscussion&gt;Network devices that are not running the latest tested and approved versions of software are vulnerable to network attacks. Running the most current, approved version of system and device software helps the site maintain a stable base of security fixes and patches, as well as enhancements to IP security. Viruses, denial of service attacks, system weaknesses, back doors and other potentially harmful situations could render a system vulnerable, allowing unauthorized access to DoD assets.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-3185r2_fix">Update operating system and address all related IAVMs. 
</fixtext><fix id="F-3185r2_fix" /><check system="C-12697r2_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Have the administrator enter the show version command to determine the installed IOS version. As of June 2010, the latest major release is 12.4 for routers and 12.2 for switches (both access and multi-layer). The release being used must have all IAVMs resolved and must not be in a Cisco deferred status or has been made obsolete. 

Ask the administrator login to the Cisco Software Center to download software. Select the specific router or switch model. Select the IOS Software link and then Verify that the release being used is listed under the release family (will need to expand the list) and not in the deferred list. If the release is not listed in either the release family or deferred, then the release is obsolete.

Verify that all IAVMs have been addressed.

Note: Cisco software in a differed state will still be at the Cisco Software Center and available for download under the deferred group, whereas software made obsolete is no longer available for download. Deferred status occurs when a software maintenance release is made obsolete and removed from order ability and service outside of Cisco's normal release schedule, or Cisco cancels a scheduled maintenance release from reaching the First-Customer-Ship (FCS) milestone. Deferrals are most often related to software quality issues. A deferral can be performed for an entire maintenance release, or just for certain sets of platforms or features within a release. A deferral prior to the FCS milestone may be performed by Cisco to protect customers from receiving software with known catastrophic defects. A deferral after FCS will expedite obsolescence for the release to limit the exposure of customers.
</check-content></check></Rule></Group><Group id="V-3175"><title>Management connections must require passwords.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-15448r3_rule" severity="high" weight="10.0"><version>NET1636</version><title>The network devices must require authentication prior to establishing a management connection for administrative access.</title><description>&lt;VulnDiscussion&gt;Network devices with no password for administrative access via a management connection provide the opportunity for anyone with network access to the device to make configuration changes enabling them to disrupt network operations resulting in a network outage.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-3200r3_fix">Configure authentication for all management connections.</fixtext><fix id="F-3200r3_fix" /><check system="C-12913r7_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Review the network device configuration to verify all management connections for administrative access require authentication.

The vty ports should look similar to the example below that references an authentication list configured as AUTH_LIST. 

line vty 0 4
login authentication AUTH_LIST
 exec-timeout 10 0
 transport input ssh</check-content></check></Rule></Group><Group id="V-3196"><title>An insecure version of SNMP is being used.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-3196r2_rule" severity="high" weight="10.0"><version>NET1660</version><title>The network element must use SNMP Version 3 Security Model with FIPS 140-2 validated cryptography for any SNMP agent configured on the device.</title><description>&lt;VulnDiscussion&gt;SNMP Versions 1 and 2 are not considered secure. Without the strong authentication and privacy that is provided by the SNMP Version 3 User-based Security Model (USM), an unauthorized user can gain access to network management information used to launch an attack against the network.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-3221r3_fix">If SNMP is enabled, configure the network element to use SNMP Version 3 Security Model with FIPS 140-2 validated cryptography (i.e., SHA authentication and AES encryption).
</fixtext><fix id="F-3221r3_fix" /><check system="C-3820r5_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Review the device configuration to verify it is configured to use SNMPv3 with both SHA authentication and privacy using AES encryption.

If the site is using Version 1 or Version 2 with all of the appropriate patches and has developed a migration plan to implement the Version 3 Security Model, this finding can be downgraded to a Category II.

To verify the appropriate patches on CISCO devices: Check the following IAVMs associated with SNMPv1: 

1. 2001-B-0001 (V0005809) Cisco IOS Software SNMP Read-Write ILMI Community String Vulnerability
2. 2002-A-SNMP-001 (V0005835) Multiple Simple Network Management Protocol Vulnerabilities in Perimeter Devices (Cisco Security Advisory: Malformed SNMP Message-Handling Vulnerabilities)

To verify the appropriate patches on other vendors refer to this web site: http://www.cert.org/advisories/CA-2002-03.html.

If the targeted asset is running SNMPv3 and does not support SHA or AES, but the device is configured to use MD5 authentication and DES or 3DES encryption, then the finding can be downgraded to a Category III.

If the site is using Version 1 or Version 2 and has installed all of the appropriate patches or upgrades to mitigate any known security vulnerabilities, this finding can be downgraded to a Category II. In addition, if the device does not support SNMPv3, this finding can be downgraded to a Category III provided all of the appropriate patches to mitigate any known security vulnerabilities have been applied and has developed a migration plan that includes the device upgrade to support Version 3 and the implementation of the Version 3 Security Model.
 </check-content></check></Rule></Group><Group id="V-3210"><title>Using default SNMP community names.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-3210r2_rule" severity="high" weight="10.0"><version>NET1665</version><title>The network element must not use the default or well-known SNMP community strings public and private.</title><description>&lt;VulnDiscussion&gt;Network elements may be distributed by the vendor pre-configured with an SNMP agent using the well known SNMP community strings public for read only and private for read and write authorization.  An attacker can obtain information about a network element using the read community string "public". In addition, an attacker can change a system configuration using the write community string "private".&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1, IAIA-1, IAIA-2&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-3235r4_fix">Configure unique SNMP community strings replacing the default community strings.</fixtext><fix id="F-3235r4_fix" /><check system="C-3822r5_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Review the network element configuration and verify if either of the SNMP community strings “public” or “private” is being used.</check-content></check></Rule></Group><Group id="V-3966"><title>More than one emergency account is defined.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-15469r3_rule" severity="medium" weight="10.0"><version>NET0440</version><title>In the event the authentication server is down or unavailable, there must only be one local account created for emergency use.</title><description>&lt;VulnDiscussion&gt;Authentication for administrative access to the device is required at all times. A single account can be created on the device's local database for use in an emergency such as when the authentication server is down or connectivity between the device and the authentication server is not operable. The console or emergency account logon credentials must be stored in a sealed envelope and kept in a safe.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-3899r4_fix">Configure the device to only allow one local account for emergency access and store the credentials in a secret manner.</fixtext><fix id="F-3899r4_fix" /><check system="C-12935r3_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Review the network device configuration to determine if an authentication server is defined for gaining administrative access. If so, there must be only one account configured locally for an emergency. Verify the username and password for the emergency account is contained within a sealed envelope kept in a safe.

The following is an example of a local account:

username emergency.accnt secret !Em3rgencyp4ssw0rd!</check-content></check></Rule></Group><Group id="V-3967"><title>The console port does not timeout after 10 minutes.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-15444r2_rule" severity="medium" weight="10.0"><version>NET1624</version><title>The network element must time out access to the console port after 10 minutes or less of inactivity.</title><description>&lt;VulnDiscussion&gt;Terminating an idle session within a short time period reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been left unattended. In addition quickly terminating an idle session will also free up resources committed by the managed network element. Setting the timeout of the session to 10 minutes or less increases the level of protection afforded critical network components.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-3900r4_fix">Configure the timeout for idle console connection to 10 minutes or less.</fixtext><fix id="F-3900r4_fix" /><check system="C-12909r2_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Review the configuration and verify that a session using the console port will time out after 10 minutes or less of inactivity as shown in the following example:

line con 0
exec-timeout 10 0 
</check-content></check></Rule></Group><Group id="V-3969"><title>Network element must only allow SNMP read access.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-30086r3_rule" severity="medium" weight="10.0"><version>NET0894</version><title>The network device must only allow SNMP read-only access.</title><description>&lt;VulnDiscussion&gt;Enabling write access to the device via SNMP provides a mechanism that can be exploited by an attacker to set configuration variables that can disrupt network operations.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-3902r7_fix">Configure the network device to allow for read-only SNMP access when using SNMPv1, v2c, or basic v3 (no authentication or privacy). Write access may be used if authentication is configured when using SNMPv3.</fixtext><fix id="F-3902r7_fix" /><check system="C-12800r7_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Review the network device configuration and verify SNMP community strings are read-only when using SNMPv1, v2c, or basic v3 (no authentication or privacy). Write access may be used if authentication is configured when using SNMPv3. 

If write-access is used for SNMP versions 1, 2c, or 3-noAuthNoPriv mode and there is no documented approval by the IAO, this is a finding.

SNMP v1/v2c Configuration Example

Device# show run
!
ip access-list standard NMS_LIST
 permit 10.1.1.22
 permit 10.1.1.24
!         
snmp-server community c0macc3ss RO NMS_LIST
snmp-server community R34dWr1t3 RW NMS_LIST
snmp-server location Somewhere USA
snmp-server contact snmp.admin@snmp.mil
snmp-server enable traps
snmp host 10.1.1.22 traps SNMPv1
snmp host 10.1.1.24 traps SNMPv2c


SNMP v3 Configuration Example

The example ACL NMS_LIST  and ADMIN_LIST are used to define what network management stations and administrator (users) desktops can access the device. Examine all group statements to determine what groups are allowed write access. Have the administrator enter a "show snmp user" command and examine all users for these groups to verify that they must be authenticated.

Device# show run
!
ip access-list standard ADMIN_LIST
 permit 10.1.1.35
 permit 10.1.1.36
ip access-list standard NMS_LIST
 permit 10.1.1.24
 permit 10.1.1.22
 permit 10.1.1.23
!
snmp-server group NOC v3 priv read VIEW_ALL write VIEW_LIMIT access NMS_LIST
snmp-server group TRAP_GROUP v3 priv notify
*tv.FFFFFFFF.FFFFFFFF.FFFFFFFF.FFFFFFFF0F 
snmp-server group ADMIN_GROUP v3 priv read VIEW_ALL write VIEW_ALL access ADMIN_LIST
snmp-server view VIEW_ALL internet included
snmp-server view VIEW_LIMIT internet included
snmp-server view VIEW_LIMIT internet.6.3.15 excluded
snmp-server view VIEW_LIMIT internet.6.3.16 excluded
snmp-server view VIEW_LIMIT internet.6.3.18 excluded
snmp-server enable traps snmp linkdown linkup
snmp-server host 10.1.1.24 version 3 priv TRAP_NMS1 

Note: For the configured group TRAP_GROUP, the notify view is auto-generated by the snmp-server host command which bind the user (TRAP_NMS1) and the group it belongs to (TRAP_GROUP) to the list of notifications (traps or informs) which are sent to the host. Hence, the configuration snmp-server group TRAP_GROUP v3 results in the following:
snmp-server group TRAP_GROUP v3 priv notify *tv.FFFFFFFF.FFFFFFFF.FFFFFFFF.FFFFFFFF0F

Note: Also, for illustration purpose only, the VIEW_LIMIT excludes MIB objects which could potentially reveal information about configured SNMP credentials. These objects are snmpUsmMIB, snmpVacmMIB, and snmpCommunityMIB which is configured as 1.3.6.1.6.3.15, 1.3.6.1.6.3.16, and 1.3.6.1.6.3.18 respectively


SNMPv3 users are not shown in a running configuration. You can view them with the show "snmp user" command. So for example, if the following users were configured as such.

snmp-server user HP_OV NOC v3 auth sha HPOVpswd priv aes 256 HPOVsecretkey
snmp-server user Admin1 ADMIN_GROUP v3 auth sha Admin1PW priv aes 256 Admin1key
snmp-server user Admin2 ADMIN_GROUP v3 auth md5 Admin2pass priv 3des Admin2key
snmp-server user TRAP_NMS1 TRAP_GROUP  v3 auth sha trap_nms1_pw priv aes trap_nms1_key

The show snmp user command would depict the configured users as follows:

Device#show snmp user

User name: HP_OV
Engine ID: AB12CD34EF56
storage-type: nonvolatile        active
Authentication Protocol: SHA
Privacy Protocol: AES256
Group-name: NOC

User name: Admin1
Engine ID: 800000090300C20013080000
storage-type: nonvolatile        active
Authentication Protocol: SHA
Privacy Protocol: AES256
Group-name: ADMIN_GROUP

User name: Admin2
Engine ID: 800000090300C20013080000
storage-type: nonvolatile        active
Authentication Protocol: MD5
Privacy Protocol: 3DES
Group-name: ADMIN_GROUP

User name: TRAP_NMS1
Engine ID: 800000090300C20013080000
storage-type: nonvolatile        active
Authentication Protocol: SHA
Privacy Protocol: AES256
Group-name: TRAP_GROUP</check-content></check></Rule></Group><Group id="V-3971"><title>VLAN 1 is being used as a user VLAN.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-3971r1_rule" severity="medium" weight="10.0"><version>NET-VLAN-004</version><title>The IAO/NSO will ensure VLAN1 is not used for user VLANs.</title><description>&lt;VulnDiscussion&gt;In a VLAN-based network, switches use VLAN1 as the default VLAN for in-band management and to communicate with other networking devices using Spanning-Tree Protocol (STP), Cisco Discovery Protocol (CDP), Dynamic Trunking Protocol (DTP), VLAN Trunking Protocol (VTP), and Port Aggregation Protocol (PAgP)—all untagged traffic. As a consequence, VLAN 1 may unwisely span the entire network if not appropriately pruned. If its scope is large enough, the risk of compromise can increase significantly.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;DCCS-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-3904r1_fix">Best practices for VLAN-based networks is to prune unnecessary ports from gaining access to VLAN1 as well as the management VLAN, and to separate in-band management, device protocol, and data traffic.</fixtext><fix id="F-3904r1_fix" /><check system="C-4028r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Review the switch configurations and verify that no access ports have been assigned membership to the VLAN 1.  A good method of ensuring there is not membership to VLAN 1 is to have the following configured:   

interface VLAN1   
no ip address   
shutdown   

This technique does not prevent switch control plane protocols such as CDP, DTP, VTP, and PAgP from using VLAN 1.   

A show vlan 1 command can be used to verify what ports are assigned to VLAN 1.</check-content></check></Rule></Group><Group id="V-3972"><title>VLAN 1 traffic traverses across unnecessary trunk </title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-3972r1_rule" severity="low" weight="10.0"><version>NET-VLAN-005</version><title>The IAO/NSO will ensure VLAN1 is pruned from all trunk and access ports that do not require it.</title><description>&lt;VulnDiscussion&gt;VLAN 1 is a special VLAN that tags and handles most of the control plane traffic such as Spanning-Tree Protocol (STP), Cisco Discovery Protocol (CDP), Dynamic Trunking Protocol (DTP), VLAN Trunking Protocol (VTP), and Port Aggregation Protocol (PAgP)all VLAN 1 tagged traffic. VLAN 1 is enabled on all trunks and ports by default. With larger campus networks, care needs to be taken about the diameter of the VLAN 1 STP domain; instability in one part of the network could affect VLAN 1, thereby influencing control-plane stability and therefore STP stability for all other VLANs.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-3905r1_fix">Best practice for VLAN-based networks is to prune unnecessary ports from gaining access to VLAN1 and insure that it does not traverse trunks not requiring VLAN1 traffic.</fixtext><fix id="F-3905r1_fix" /><check system="C-4030r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Review the switch configurations and note any ports assigned to VLAN 1.  A show vlan command can also be used to verify what ports are assigned to VLAN 1.</check-content></check></Rule></Group><Group id="V-3973"><title>Disabled ports are not kept in an unused VLAN.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-3973r1_rule" severity="low" weight="10.0"><version>NET-VLAN-002</version><title>The IAO/NSO will ensure disabled ports are placed in an unused VLAN (do not use VLAN1). </title><description>&lt;VulnDiscussion&gt;It is possible that a disabled port that is assigned to a user or management VLAN becomes enabled by accident or by an attacker and as a result gains access to that VLAN as a member.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-3906r1_fix">Assign all disabled ports to an unused VLAN. Do not use VLAN1.</fixtext><fix id="F-3906r1_fix" /><check system="C-4035r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Review the switch configurations and examine all interfaces.  Each interface not in use should have membership to a VLAN that is not used for any other purpose.  Below would be an example.interface FastEthernet0/5switchport mode accessswitchport access vlan 999shutdownFor older switches such as the Catalyst 1900, you would see something like the following:interface FastEthernet0/5vlan-membership static 999shutdown</check-content></check></Rule></Group><Group id="V-3984"><title>Access switchports are assigned to the native VLAN</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-3984r1_rule" severity="medium" weight="10.0"><version>NET-VLAN-009</version><title>The IAO/NSO will ensure access switchports are not assigned to the native VLAN.</title><description>&lt;VulnDiscussion&gt;Double encapsulation can be initiated by an attacker who has access to a switch port belonging to the native VLAN of the trunk port. Knowing the victim’s MAC address and with the victim attached to a different switch belonging to the same trunk group, thereby requiring the trunk link and frame tagging, the malicious user can begin the attack by sending frames with two sets of tags. The outer tag that will have the attacker’s VLAN ID (probably the well known and omnipresent VLAN1) is stripped off by the switch, and the inner tag that will have the victim’s VLAN ID is used by the switch as the next hop and sent out the trunk port.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-3917r1_fix">To insure the integrity of the trunk link and prevent unauthorized access, the native VLAN of the trunk port should be changed from the default VLAN1 to its own unique VLAN. Access switchports must never be assigned to the native VLAN.</fixtext><fix id="F-3917r1_fix" /><check system="C-4034r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Review the switch configurations and examine all access ports. Verify that they do not belong to the native VLAN. If a native VLAN has not been configured (see NET-VLAN-008), the default is VLAN 1.</check-content></check></Rule></Group><Group id="V-4582"><title>Authentication required for console access.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-19270r3_rule" severity="high" weight="10.0"><version>NET1623</version><title>The network device must require authentication for console access.</title><description>&lt;VulnDiscussion&gt;Network devices with no password for administrative access via the console provide the opportunity for anyone with physical access to the device to make configuration changes enabling them to disrupt network operations resulting in a network outage.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;IAIA-1, IAIA-2&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-4515r4_fix">Configure authentication for console access on the network device.</fixtext><fix id="F-4515r4_fix" /><check system="C-20059r3_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Review the network device's configuration and verify authentication is required for console access. 

If the device is accessed via the aux port, then verify that this port also requires authentication. If it is not used, then it must be disabled. The console port and the disabled aux port should look similar to the configuration example below that references an authentication list configured as AUTH_LIST. 

line con 0
 login authentication AUTH_LIST
 exec-timeout 10 0
line aux 0
 no exec</check-content></check></Rule></Group><Group id="V-4584"><title>The network element must log all messages except debugging.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-15476r2_rule" severity="low" weight="10.0"><version>NET1021</version><title>The network element must log all messages except debugging and send all log data to a syslog server.</title><description>&lt;VulnDiscussion&gt;Logging is a critical part of router security. Maintaining an audit trail of system activity logs (syslog) can help identify configuration errors, understand past intrusions, troubleshoot service disruptions, and react to probes and scans of the network. Syslog levels 0-6 are the levels required to collect the necessary information to help in the recovery process.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECAT-1, ECAT-2, ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-4517r2_fix">Configure the network element to log all messages except debugging and send all log data to a syslog server.</fixtext><fix id="F-4517r2_fix" /><check system="C-12942r2_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Cisco IOS routers and switches use level 6 (informational) when logging packets that are dropped via access control list. (%SEC-6-IPACCESSLOGNP: list 1 denied 0 1.1.1.2 -&gt; 1.1.1.1, 1 packet). Hence, it is imperative that log messages at level 6 are captured for further analysis and incident reporting. However, these messages do not need to go to the console, but must go to the syslog server. 

To avoid being locked out of the console in the event of an intensive log message generation such as when a large number of packets are being dropped, you can implement any of the following:

1.  Limit the amount of logging based on same packet matching via the access-list log-update threshold command. The configured threshold specifies how often syslog messages are generated and sent after the initial packet match on a per flow basis. 
2.  Rate-limit messages at specific severity levels destined to be logged at the console via logging rate-limit command.
3.  Have only messages at levels 0-5 (or 0-4) go to the console and messages at level 0-6 go to the syslog server. 

The buffer could be set to notification level or altered to a different level when required (i.e. debugging).

Following would be an example configuration:

!
logging buffered 4096 informational
logging console notifications
…
!
logging trap debugging 
logging host 1.1.1.1
!

The default state for logging is on and the default for the syslog server is informational (i.e. logging trap informational). Hence, the commands logging on and logging trap informational will not be shown via show run command. Hence, have the operator issue a show logging command to verify logging is on and the level for the syslog server (i.e. trap).



R1#show logging

Syslog logging: enabled (12 messages dropped, 0 messages rate-limited,
                0 flushes, 0 overruns, xml disabled, filtering disabled)
  
…
 
    Console logging: level notifications, 56 messages logged, xml disabled,
                     filtering disabled
    Monitor logging: level debugging, 0 messages logged, xml disabled,
                     filtering disabled
    Buffer logging:  level informational, 6 messages logged, xml disabled,
                     filtering disabled
…

     Trap logging: level informational, 73 message lines logged
        Logging to 1.1.1.1  (udp port 514,  audit disabled,
              authentication disabled, encryption disabled, link up),
              37 message lines logged, 
              0 message lines rate-limited, 
              0 message lines dropped-by-MD, 
              xml disabled, sequence number disabled
              filtering disabled          


The table below lists the severity levels and message types for all log data.

Severity 
Level                   Message Type

0                           Emergencies
1                           Alerts
2                           Critical
3                           Errors
4                           Warning
5                           Notifications
6                           Informational
7                           Debugging
</check-content></check></Rule></Group><Group id="V-5611"><title>Management connections are not restricted.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-15449r2_rule" severity="medium" weight="10.0"><version>NET1637</version><title>The network element must only allow management connections for administrative access from hosts residing in to the management network.</title><description>&lt;VulnDiscussion&gt;Remote administration is inherently dangerous because anyone with a sniffer and access to the right LAN segment, could acquire the device account and password information. With this intercepted information they could gain access to the infrastructure and cause denial of service attacks, intercept sensitive information, or perform other destructive actions.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-5522r3_fix">Configure an ACL or filter to restrict management access to the device from only the management network.

</fixtext><fix id="F-5522r3_fix" /><check system="C-12914r3_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Review the configuration and verify that management access to the device is allowed only from the management network address space. The configuration should look similar to the following:

access-list 3 permit 192.168.1.10 log
access-list 3 permit 192.168.1.11 log
access-list 3 deny any
…..
line vty 0 4
 access-class 3 in
</check-content></check></Rule></Group><Group id="V-5612"><title>SSH session timeout is not 60 seconds or less.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-15457r2_rule" severity="medium" weight="10.0"><version>NET1645</version><title>The network element must be configured to timeout after 60 seconds or less for incomplete or broken SSH sessions.</title><description>&lt;VulnDiscussion&gt;An attacker may attempt to connect to the device using SSH by guessing the authentication method, encryption algorithm, and keys. Limiting the amount of time allowed for authenticating and negotiating the SSH session reduces the window of opportunity for the malicious user attempting to make a connection to the network element.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-5523r4_fix">Configure the network element so it will require a secure shell timeout of 60 seconds or less.</fixtext><fix id="F-5523r4_fix" /><check system="C-12922r2_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Review the configuration and verify the timeout is set for 60 seconds or less. The SSH service terminates the connection if protocol negotiation (that includes user authentication) is not complete within this timeout period.

ip ssh time-out 60 </check-content></check></Rule></Group><Group id="V-5613"><title>SSH login attempts value is greater than 3.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-15458r2_rule" severity="medium" weight="10.0"><version>NET1646</version><title>The network element must be configured for a maximum number of unsuccessful SSH login attempts set at 3 before resetting the interface.</title><description>&lt;VulnDiscussion&gt;An attacker may attempt to connect to the device using SSH by guessing the authentication method and authentication key or shared secret. Setting the authentication retry to 3 or less strengthens against a Brute Force attack.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-5524r7_fix">Configure the network element to require a maximum number of unsuccessful SSH login attempts at 3.</fixtext><fix id="F-5524r7_fix" /><check system="C-12923r2_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Review the configuration and verify the number of unsuccessful SSH login attempts is set at 3.

ip ssh authentication-retries 3</check-content></check></Rule></Group><Group id="V-5614"><title>The PAD service is enabled.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-5614r2_rule" severity="low" weight="10.0"><version>NET0722</version><title>The network element must have the PAD service disabled.</title><description>&lt;VulnDiscussion&gt;Packet Assembler Disassembler (PAD) is an X.25 component seldom used.  It collects the data transmissions from the terminals and gathers them into a X.25 data stream and vice versa.  PAD acts like a multiplexer for the terminals.  If enabled, it can render the device open to attacks. Some voice vendors use PAD on internal routers.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-5525r4_fix">IOS Procedure: Change the configuration to include the following commands: no service pad</fixtext><fix id="F-5525r4_fix" /><check system="C-3552r3_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>IOS Procedure: Review all Cisco router and switch configurations to verify that the service pad command is not found.   </check-content></check></Rule></Group><Group id="V-5615"><title>TCP Keep-Alives must be enabled.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-5615r2_rule" severity="low" weight="10.0"><version>NET0724</version><title>The network element must have TCP Keep-Alives enabled for TCP sessions.</title><description>&lt;VulnDiscussion&gt;Idle TCP sessions can be susceptible to unauthorized access and hijacking attacks. By default, routers do not continually test whether a previously connected TCP endpoint is still reachable. If one end of a TCP connection idles out or terminates abnormally, the opposite end of the connection may still believe the session is available. These “orphaned” sessions use up valuable router resources and can also be hijacked by an attacker. To mitigate this risk, routers must be configured to send periodic keepalive messages to check that the remote end of a session is still connected. If the remote device fails to respond to the keepalive message, the sending router will clear the connection and free resources allocated to the session.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-5526r6_fix">IOS Procedure: Change the configuration to include the "service tcp-keepalives-in" command.</fixtext><fix id="F-5526r6_fix" /><check system="C-3559r4_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>IOS Procedure: Review the device configuration to verify the "service tcp-keepalives-in" command is configured.   </check-content></check></Rule></Group><Group id="V-5616"><title>Identification support is enabled.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-5616r2_rule" severity="low" weight="10.0"><version>NET0726</version><title>The network element must have identification support disabled.</title><description>&lt;VulnDiscussion&gt;Identification support allows one to query a TCP port for identification.  This feature enables an unsecured protocol to report the identity of a client initiating a TCP connection and a host responding to the connection.  Identification support can connect a TCP port on a host, issue a simple text string to request information, and receive a simple text-string reply.  This is another mechanism to learn the router vendor, model number, and software version being run.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-5527r4_fix">IOS Procedure: Disable identification support by configuring the global "no ip identd" command.</fixtext><fix id="F-5527r4_fix" /><check system="C-3562r4_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>IOS Procedure: Review the device configuration to verify that identification support is not enabled via "ip identd" global command. It is disabled by default.</check-content></check></Rule></Group><Group id="V-5618"><title>Gratuitous ARP must be disabled.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-5618r2_rule" severity="medium" weight="10.0"><version>NET0781</version><title>The router must have gratuitous ARP disabled.</title><description>&lt;VulnDiscussion&gt;A gratuitous ARP is an ARP broadcast in which the source and destination MAC addresses are the same. It is used to inform the network about a hosts IP address. A spoofed gratuitous ARP message can cause network mapping information to be stored incorrectly, causing network malfunction.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-5529r4_fix">The administrator must ensure the device configuration does not include the "ip gratuitous-arp" command.</fixtext><fix id="F-5529r4_fix" /><check system="C-3577r5_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>IOS Procedure: Review the configuration and verify that the "ip gratuitous-arps" global command is not configured. It is disabled by default in release 12.3 and above.

</check-content></check></Rule></Group><Group id="V-5622"><title>A dedicated VLAN is required for all trunk ports.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-5622r1_rule" severity="medium" weight="10.0"><version>NET-VLAN-008</version><title>The IAS/NSO will ensure that the native VLAN is assigned to a VLAN ID other than the default VLAN for all 802.1q trunk links.</title><description>&lt;VulnDiscussion&gt;VLAN hopping can be initiated by an attacker who has access to a switch port belonging to the same VLAN as the native VLAN of the trunk link connecting to another switch in which the victim is connected to. If the attacker knows the victim’s MAC address, it can forge a frame with two 802.1q tags and a layer 2 header with the destination address of the victim. Since the frame will ingress the switch from a port belonging to its native VLAN, the trunk port connecting to victim’s switch will simply remove the outer tag because native VLAN traffic is to be untagged. The switch will forward the frame unto the trunk link unaware of the inner tag with a VLAN ID for which the victim’s switchport is a member of.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-5533r1_fix">To ensure the integrity of the trunk link and prevent unauthorized access, the native VLAN of the trunk port should be changed from the default VLAN1 to its own unique VLAN.  The native VLAN must be the same on both ends of the trunk link; otherwise traffic could accidently leak between broadcast domains.</fixtext><fix id="F-5533r1_fix" /><check system="C-3770r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Review the switch configurations and examine all trunk links. Verify the native VLAN has been configured to a VLAN other than the default VLAN 1. Following is an example of assigning a trunk port to a VLAN: 

Review the switch configurations and examine all trunk links. Verify that the native VLAN has been configured to a VLAN other than the default VLAN 1. Following is an example of defining the native VLAN for a trunk port: 

interface FastEthernet0/23   
description Trunk Port   
no ip address   
no cdp enable   
switchport trunk encapsulation dot1q   
switchport mode trunk   
switchport trunk native vlan 55   
no shutdown   

A show vlan command can also be used to verify what VLAN the trunked ports are assigned to.

An alterative to configuring a dedicated native VLAN is to ensure that all native VLAN traffic is tagged. This will mitigate the risk of VLAN hopping since there will always be an outer tag for native traffic as it traverses an 802.1q trunk link. For CatOS, the switch can be configured with the dot1q-all-tagged global command. Introduced with IOS release 12.2(25), the global command vlan dot1q tag native can be used.</check-content></check></Rule></Group><Group id="V-5623"><title>Ensure trunking is disabled on all access ports.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-5623r1_rule" severity="medium" weight="10.0"><version>NET-VLAN-007</version><title>The IAO/NSO will ensure trunking is disabled on all access ports (do not configure trunk on, desirable, non-negotiate, or auto—only off).</title><description>&lt;VulnDiscussion&gt;Double encapsulation can be initiated by an attacker who has access to a switch port belonging to the native VLAN of the trunk port. Knowing the victims MAC address and with the victim attached to a different switch belonging to the same trunk group, thereby requiring the trunk link and frame tagging, the malicious user can begin the attack by sending frames with two sets of tags. The outer tag that will have the attackers VLAN ID (probably the well known and omnipresent VLAN1) is stripped off by the switch, and the inner tag that will have the victims VLAN ID is used by the switch as the next hop and sent out the trunk port.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-5534r1_fix">Disable trunking on all access ports.</fixtext><fix id="F-5534r1_fix" /><check system="C-3769r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Review the switch configurations and examine all access ports.  Verify that the port is not in trunk mode (i.e. for Catalyst using IOS the interface should have the command  switchport mode access—not switchport mode trunk or older switches trunk off and not trunk on).  A show trunk command can also be used to display all ports in trunk mode.  Trace the connections from the physical port with trunk mode.  This should be a Gigabit Ethernet or Fast Ethernet connection to another switch or router—it should not be connected to a workstation.</check-content></check></Rule></Group><Group id="V-5624"><title>Re-authentication must occur every 60 minutes.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-5624r1_rule" severity="medium" weight="10.0"><version>NET-NAC-012</version><title>The IAO/NSO will ensure if 802.1x Port Authentication is implemented, re-authentication must occur every 60 minutes.</title><description>&lt;VulnDiscussion&gt;Eliminating unauthorized access to the network from inside the enclave is vital to keeping a network secure. Internal access to the private network is enabled by simply connecting a workstation or laptop to a wall plate or access point located in the work area.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-5535r1_fix">Ensure 802.1x reauthentication occurs every 60 minutes.</fixtext><fix id="F-5535r1_fix" /><check system="C-3773r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Review the switch configuration for the following interface command: dot1x reauthentication 

Once re-authentication is enabled, the default is 60 minutes. 

The interval can be made smaller. For example, if you would want re-authentication to occur every 30 minutes, you would configure the following interface commnand: dot1x timeout reauth-period 1800</check-content></check></Rule></Group><Group id="V-5626"><title>NET-NAC-009</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-42190r2_rule" severity="high" weight="10.0"><version>NET-NAC-009</version><title>The switch must be configured to use 802.1x authentication on host facing access switch ports.</title><description>&lt;VulnDiscussion&gt;The IEEE 802.1x standard is a client-server based access control and authentication protocol that restricts unauthorized clients from connecting to a local area network through host facing switch ports.  The authentication server authenticates each client connected to to a switch port before making any services available to the client from the LAN.  Unless the client is successfully authenticated, 802.1x access control allows only Extensible Authentication Protocol over LAN (EAPOL) traffic through the port to which the client is connected.  After authentication is successful, normal traffic can pass through the port.  Without the use of 802.1x, a malicious user could use the switch port to connect an unauthorized piece of computer or other network device to inject or steal data from the network without detection.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;At this time, NET-NAC-009 can be downgraded to a CAT III finding if Static MAC filter is used in lieu of 802.1x authentication on host facing switch ports.&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;Responsibility&gt;Network Security Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-5537r4_fix">Configure 802.1x authentication on all host facing access switch ports.</fixtext><fix id="F-5537r4_fix" /><check system="C-40570r4_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Verify if the switch configuration has 802.1x authentication implemented for all access switch ports connecting to LAN outlets (i.e. RJ-45 wall plates) or devices not located in the telecom room, wiring closets, or equipment rooms. If 802.1x authentication is not configured on these host-facing access switch ports, this is a CAT 1 finding. If MAC address filtering is implemented in lieu of 802.1x authentication, this finding will be downgraded to a CAT 3.

Verify 802.1x authentication is enabled on the switch and host facing switch ports: 
Step 1:  Verify that an 802.1x authentication server has been configured similar to the following example:

Switch(config)# radius-server host x.x.x.x auth-port 1813 key !R4d1u$K3y!
Switch(config)# aaa new-model
Switch(config)# aaa authentication dot1x default group radius

Step 2: Verify 802.1x authentication has been enabled globally on the network device similar to the following example:

Switch(config)# dot1x system-auth-control
 
Step 3:  Verify that all host-facing access switchports are configured to use 802.1x similar to the examples below:

Switch(config)# interface fastethernet0/2
Switch(config-if)# switchport mode access
Switch(config-if)# switchport port-security
Switch(config-if)# dot1x port-control auto

OR

Switch(config)# interface fastethernet0/2
Switch(config-if)# switchport mode access
Switch(config-if)# switchport port-security
Switch(config-if)# authentication port-control auto

If 802.1x is not being used, determine if MAC filtering is used on each host-facing access switch port as shown in the following example: 

Switch(config)# interface fastethernet0/3
Switch(config-if)# switchport mode access
Switch(config-if)# switchport port-security
Switch(config-if)# switchport port-security maximum 1
Switch(config-if)# switchport port-security mac-address 1000.2000.3000

NOTE: The section below is intended for classified networks. If it’s determined that 802.1x is not implemented on a classified network, the Traditional review team must be notified to determine if the physical requirements are implemented.  For a site to be downgraded to a CAT III open finding, the physical security requirements must be implemented in addition to static MAC or sticky secure MAC port security.  If both physical and logical downgrades are not implemented, a CAT I open finding will be issued.  

If classified LAN drops are not authenticated by an 802.1x implementation, they must be located within spaces properly established as Secret vaults, Secret Secure Rooms (AKA: Collateral Classified Open Storage Areas), TS secure room, or SCIF. Otherwise, one of the following supplemental physical security controls must be implemented.

1. Wall jacks must be secured when unattended by persons with Secret or higher clearance with a properly constructed lock box (Hoffman or similar commercial product or locally fabricated).  The lock box must have no exposed or removable hinges. The hasp hardware must be riveted to the box or otherwise installed so that removal will require physical breaking of the box; thereby leaving evidence of actual or attempted entry.  The lock box must be secured with a 3-position high security combination padlock (IAW the NSTISSI 7003).  The S&amp;G 8077 combination padlock is the only existing padlock meeting this standard.
 
2.  If lock boxes are not used, the alternative is to physically disconnect the SIPRNet link at the SIPRNet point of presence (PoP) after normal duty hours.  The PoP must be located within a proper Secret or higher secure room.</check-content></check></Rule></Group><Group id="V-5628"><title>The VLAN1 is being used for management traffic.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-5628r1_rule" severity="medium" weight="10.0"><version>NET-VLAN-006</version><title>The IAO/NSO will ensure VLAN1 is not used for in-band management traffic.  A dedicated management VLAN or VLANs will be defined to keep management traffic separate from user data and control plane traffic.</title><description>&lt;VulnDiscussion&gt;All ports, including the internal sc0 interface, are configured by default to be members of VLAN 1. In a VLAN-based network, switches use VLAN1 as the default VLAN for in-band management and to communicate with other networking devices using Spanning-Tree Protocol (STP), Cisco Discovery Protocol (CDP), Dynamic Trunking Protocol (DTP), VLAN Trunking Protocol (VTP), and Port Aggregation Protocol (PAgP)all untagged traffic. As a consequence, VLAN 1 may unwisely span the entire network if not appropriately pruned. If its scope is large enough, the risk of compromise can increase significantly.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-5539r1_fix">Best practices for VLAN-based networks is create a dedicated management VLAN, prune unnecessary ports from gaining access to VLAN1 as well as the management VLAN, and to separate in-band management, device protocol, and data traffic.</fixtext><fix id="F-5539r1_fix" /><check system="C-3767r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>If switch clustering is used, review the configuration of the VLAN command switch and look for the command cluster management-vlan. The new management VLAN ID follows this command.     

For unclustered switches, review the configuration of  each switch. All ports, including the internal management interface (sc0), are configured by default to be members of VLAN 1.  The management VLAN can be identified by its switch virtual interface (SVI) defined that contains the IP address for the internal management interface.  Note the IP address defined for the sc0 interface. The IP address of the sc0 interface can be accessed only by hosts connected to ports that belong to the management VLAN. Below is an example of disabling VLAN 1 and creating an SVI that could be used for the management VLAN.   

interface VLAN1   
no ip address   
shutdown   
interface VLAN10   
ip address 10.0.1.10 255.255.255.0   
no shutdown   

Note: The management VLAN can also be defined by the set command when configuring the IP address of the Sc0.    

set interface sc0 10.0.1.10 255.255.255.0</check-content></check></Rule></Group><Group id="V-5645"><title>Cisco Express Fowarding (CEF) not enabled on supported devices.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-5645r3_rule" severity="medium" weight="10.0"><version>NET0949</version><title>Cisco Express Forwarding (CEF) must be enabled on all supported Cisco Layer 3 IP devices.</title><description>&lt;VulnDiscussion&gt;The Cisco Express Forwarding (CEF) switching mode replaces the traditional Cisco routing cache with a data structure that mirrors the entire system routing table. Because there is no need to build cache entries when traffic starts arriving for new destinations, CEF behaves more predictably when presented with large volumes of traffic addressed to many destinations such as a SYN flood attacks. Because many SYN flood attacks use randomized source addresses to which the hosts under attack will reply to, there can be a substantial amount of traffic for a large number of destinations that the router will have to handle. Consequently, routers configured for CEF will perform better under SYN floods directed at hosts inside the network than routers using the traditional cache. &lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-5556r6_fix">1. If the Cisco Layer 3 IP device not enabled by default, enable Distributed CEF Mode globally.

Router(config)# ip cef distributed

2. If Distributed CEF Mode is not supported, enable Centralized CEF Mode globally.

Router(config)# ip cef

3. If CEF is not supported in any capacity on the device, this finding is NA.</fixtext><fix id="F-5556r6_fix" /><check system="C-3605r8_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Determine if the Cisco Layer 3 device supports the use of CEF switching mode.  If the current IOS version available for the device does not support CEF in any capacity, this is requirement will be NA.

Most Cisco Layer 3 devices will support CEF in either Distributed or Central Mode.  

1. If the device supports Distributed CEF Mode (dCEF), verify that it has been globally enabled. 
2. If the device only supports Central CEF Mode (CEF), verify the function has been globally enabled.   

Many of the devices have CEF enabled by default and many of the configurations will not show if CEF functionality is enabled.  To verify CEF is running on a Cisco Layer 3 device with IOS run the following command:
 
router#show ip cef
%CEF not running

If CEF is shown to be not running, this is a finding.</check-content></check></Rule></Group><Group id="V-5646"><title>Devices not configured to filter and drop half-open connections.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-15435r4_rule" severity="medium" weight="10.0"><version>NET0965</version><title>The network device must drop half-open TCP connections through filtering thresholds or timeout periods.</title><description>&lt;VulnDiscussion&gt;A TCP connection consists of a three-way handshake message sequence. A connection request is transmitted by the originator, an acknowledgement is returned from the receiver, and then an acceptance of that acknowledgement is sent by the originator.

An attacker’s goal in this scenario is to cause a denial of service to the network or device by initiating a high volume of TCP packets, then never sending an acknowledgement, leaving connections in a half-opened state.  Without the device having a connection or time threshold for these half-opened sessions, the device risks being a victim of a denial of service attack.  Setting a TCP timeout threshold will instruct the device to shut down any incomplete connections. Services such as SSH, BGP, SNMP, LDP, etc. are some services that may be prone to these types of denial of service attacks. If the router does not have any BGP connections with BGP neighbors across WAN links, values could be set to even tighter constraints.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-5557r6_fix">Configure the device to drop half-open TCP connections through threshold filtering or timeout periods.</fixtext><fix id="F-5557r6_fix" /><check system="C-12900r6_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Review the device configuration to validate threshold filters or timeout periods are set for dropping excessive half-open TCP connections.

For timeout periods, the time should be set to 10 seconds or less.  If the device can not be configured for 10 seconds or less, it should be set to the least amount of time allowable in the configuration.  Threshold filters will need to be determined by the organization for optimal filtering.

IOS Configuration Example: 
ip tcp synwait-time 10</check-content></check></Rule></Group><Group id="V-7009"><title>An Infinite Lifetime key has not been implemented</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-7363r1_rule" severity="high" weight="10.0"><version>NET0425</version><title>The IAO/NSO will ensure the lifetime of a MD5 Key expiration is set to never expire. The lifetime of the MD5 key will be configured as infinite for route authentication, if supported by the current approved router software version.

Note: Only Enhanced Interior Gateway Routing Protocol (EIGRP), and Routing Information Protocol (RIP) Version 2 use key chains.</title><description>&lt;VulnDiscussion&gt;Only Enhanced Interior Gateway Routing Protocol (EIGRP), and Routing Information Protocol (RIP) Version 2 use key chains.  When configuring authentication for routing protocols that provide key chains, configure two rotating keys with overlapping expiration dates—both with a 180-day lifetime. A third key must also be defined with an infinite lifetime. Both of these steps will ensure that there will always be a key that can be placed into service by all peers. If a time period occurs during which no key is activated, authentication cannot occur; hence, route updates will not occur. The lifetime key should be changed 7 days after successful key rotation and synchronization has occurred with all peers.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-6611r1_fix">This check is in place to ensure keys do not expire creating a DOS due to adjacencies being dropped and routes being aged out. The recommendation is to use two rotating six month keys with a third key set as infinite lifetime. The lifetime key should be changed 7 days after the rotating keys have expired and redefined.</fixtext><fix id="F-6611r1_fix" /><check system="C-3496r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Review the running configuration to determine if key authentication has been defined with an infinite lifetime.

RIP 2 Example					EIGRP Example

interface ethernet 0                                		 	interface ethernet 0
  ip rip authentication key-chain trees       		  	 ip authentication mode eigrp 1 md5
  ip rip authentication mode md5				 ip authentication key-chain eigrp 1 trees

router rip					router eigrp 1
 network 172.19.0.0					network 172.19.0.0
 version 2

key chain trees					key chain trees
key 1 					     	key 1                                
  key-string willow				       	key-string willow
  accept-lifetime 22:45:00 Feb 10 2005 22:45:00 Aug 10 2005 	accept-lifetime 22:45:00 Feb 10 2005 22:45:00 Aug 10 2005    
  send-lifetime 23:00:00 Feb 10 2005 22:45:00 Aug 10 2005    	send-lifetime 23:00:00 Feb 10 2005 22:45:00 Aug 10 2005 
key 2 					    	key 2                                   
  key-string birch				       	key-string birch
  accept-lifetime 22:45:00 Aug 9 2005 22:45:00 Feb 10 2006	 accept-lifetime 22:45:00 Dec 10 2005 22:45:00 Feb 10 2006  
  send-lifetime 23:00:00 Aug 9 2005 22:45:00 Feb 10 2006 	 send-lifetime 23:00:00 Dec 10 2005 22:45:00 Jan 10 2006
key 9999 					 key 9999                                     
  key-string maple				    	 key-string maple
  accept-lifetime 22:45:00 Feb 9 2005 infinite	    	 accept-lifetime 22:45:00 Feb 9 2005 infinite
  send-lifetime 23:00:00 Feb 9 2005 infinite	    	 	 send-lifetime 23:00:00 Feb 9 2005 infinite

Notes:	Note: Only Enhanced Interior Gateway Routing Protocol (EIGRP), and Routing Information Protocol (RIP) Version 2 use key chains

Notes: 	When using MD5 authentication keys, it is imperative the site is in compliance with the NTP policies. The router has to know the time!

Notes: 	Must make this a high number to ensure you  have plenty of room to put keys in before it.  All subsequent keys will be decremented by one (9998, 9997…)
</check-content></check></Rule></Group><Group id="V-7011"><title>The auxiliary port is not disabled.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-15446r2_rule" severity="low" weight="10.0"><version>NET1629</version><title>The network element’s auxiliary port must be disabled unless it is connected to a secured modem providing encryption and authentication.</title><description>&lt;VulnDiscussion&gt;The use of POTS lines to modems connecting to network devices provides clear text of authentication traffic over commercial circuits that could be captured and used to compromise the network.  Additional war dial attacks on the device could degrade the device and the production network.

Secured modem devices must be able to authenticate users and must negotiate a key exchange before full encryption takes place.  The modem will provide full encryption capability (Triple DES) or stronger.  The technician who manages these devices will be authenticated using a key fob and granted access to the appropriate maintenance port, thus the technician will gain access to the managed device (router, switch, etc.).  The token provides a method of strong (two-factor) user authentication.  The token works in conjunction with a server to generate one-time user passwords that will change values at second intervals.  The user must know a personal identification number (PIN) and possess the token to be allowed access to the device.
&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-6614r3_fix">Disable the auxiliary port. If used for out-of-band administrative access, the port must be connected to a secured modem providing encryption and authentication.</fixtext><fix id="F-6614r3_fix" /><check system="C-12911r2_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Review the configuration and verify that the auxiliary port is disabled unless a secured modem providing encryption and authentication is connected to it. The following configuration disables the Cisco IOS auxiliary port:
 
line aux 0
 no exec

Note: The command transport input none must be configured under the line aux 0. However, this is the default and will not be shown in the running configuration.
</check-content></check></Rule></Group><Group id="V-14667"><title>Key expiration exceeds 180 days.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-15301r2_rule" severity="low" weight="10.0"><version>NET0422</version><title>The network element must not be configured with rotating keys used for authenticating IGP peers that have a duration exceeding 180 days.</title><description>&lt;VulnDiscussion&gt;If the keys used for routing protocol authentication are guessed, the malicious user could create havoc within the network by advertising incorrect routes and redirecting traffic. Changing the keys frequently reduces the risk of them eventually being guessed.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;IAKM-1, IAKM-2, IAKM-3&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-14125r3_fix">The IAO or SA will ensure a key has an expiration of 180 days or less. </fixtext><fix id="F-14125r3_fix" /><check system="C-12696r3_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Review key expirations. When configuring authentication for routing protocols that provide key chains, configure two rotating keys with overlapping expiration dates, both with 180-day expirations.</check-content></check></Rule></Group><Group id="V-14669"><title>BSDr commands are not disabled.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-15314r2_rule" severity="medium" weight="10.0"><version>NET0744</version><title>The administrator must ensure BSD r command services are disabled. </title><description>&lt;VulnDiscussion&gt;Berkeley Software Distribution (BSD) “r” commands allow users to execute commands on remote systems using a variety of protocols.  The BSD "r" commands (e.g., rsh, rlogin, rcp, rdump, rrestore, and rdist) are designed to provide convenient remote access without passwords to services such as remote command execution (rsh), remote login (rlogin), and remote file copy (rcp and rdist).  The difficulty with these commands is that they use address-based authentication.  An attacker who convinces a server that he is coming from a "trusted" machine can essentially get complete and unrestricted access to a system.  The attacker can convince the server by impersonating a trusted machine and using IP address, by confusing DNS so that DNS thinks that the attacker's IP address maps to a trusted machine's name, or by any of a number of other methods&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-14130r4_fix">Configure the device to disable BSDr command services.</fixtext><fix id="F-14130r4_fix" /><check system="C-12780r2_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Verify that the following BSDr global commands are not defined in the configuration:

     ip rcmd rcp-enable
     ip rcmd rsh-enable

These commands have been disabled by default in IOS since version 12.0. 
</check-content></check></Rule></Group><Group id="V-14671"><title>NTP messages are not authenticated.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-16089r2_rule" severity="medium" weight="10.0"><version>NET0813</version><title>The network element must authenticate all NTP messages received from NTP servers and peers.</title><description>&lt;VulnDiscussion&gt;Since NTP is used to ensure accurate log file timestamp information, NTP could pose a security risk if a malicious user were able to falsify NTP information. To launch an attack on the NTP infrastructure, a hacker could inject time that would be accepted by NTP clients by spoofing the IP address of a valid NTP server. To mitigate this risk, the time messages must be authenticated by the client before accepting them as a time source. 

Two NTP-enabled devices can communicate in either client-server mode or peer-to-peer mode (aka “symmetric mode”). The peering mode is configured manually on the device and indicated in the outgoing NTP packets. The fundamental difference is the synchronization behavior: an NTP server can synchronize to a peer with better stratum, whereas it will never synchronize to its client regardless of the client’s stratum. From a protocol perspective, NTP clients are no different from the NTP servers. The NTP client can synchronize to multiple NTP servers, select the best server and synchronize with it, or synchronize to the averaged value returned by the servers.

A hierarchical model can be used to improve scalability. With this implementation, an NTP client can also become an NTP server providing time to downstream clients at a higher stratum level and of decreasing accuracy than that of its upstream server. To increase availability, NTP peering can be used between NTP servers. In the event the device looses connectivity to it upstream NTP server, it will be able to choose time from one of its peers. 

The NTP authentication model is opposite of the typical client-server authentication model. NTP authentication enables an NTP client or peer to authenticate time received from their servers and peers. It’s not used to authenticate NTP clients because NTP servers don’t care about the authenticity of their clients, as they never accept any time from them. 
&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-14132r1_fix">Configure the device to authenticate all received NTP messages using either PKI (supported in NTP v4) or SHA-1 hashing algorithm. If SHA-1 is not supported by this client or the NTP peer or server, then MD5 can be used.</fixtext><fix id="F-14132r1_fix" /><check system="C-13749r2_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Review the device configuration and verify that it is authenticating the NTP messages received from the NTP server or peer. Authentication must be performed using either PKI (supported in NTP v4) or SHA-1 hashing algorithm. If SHA-1 is not supported by both the NTP client and server, then MD5 can be used. You should find a configuration similar to the example below:
 
ntp authentication-key 1 md5 *********
ntp authenticate
ntp trusted-key 1
ntp server 10.1.0.5 key 1
ntp server 10.1.0.8 key 1
</check-content></check></Rule></Group><Group id="V-14672"><title>Authentication traffic does not use loopback address.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-16091r2_rule" severity="low" weight="10.0"><version>NET0897</version><title>The router must use its loopback or OOB management interface address as the source address when originating TACACS+ or RADIUS traffic.</title><description>&lt;VulnDiscussion&gt;Using a loopback address as the source address offers a multitude of uses for security, access, management, and scalability of routers. It is easier to construct appropriate ingress filters for router management plane traffic destined to the network management subnet since the source addresses will be from the range used for loopback interfaces instead of a larger range of addresses used for physical interfaces. Log information recorded by authentication and syslog servers will record the router’s loopback address instead of the numerous physical interface addresses. TACACS+, RADIUS messages sent to management servers should use the loopback address as the source address. &lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-14134r4_fix">Configure the router to use its loopback or OOBM interface address as the source address when originating TACACS+ or RADIUS traffic.
</fixtext><fix id="F-14134r4_fix" /><check system="C-13848r5_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Review the configuration and verify the loopback interface address is used as the source address when originating TACACS+ or RADIUS traffic. If the device is managed from an OOB management network, the OOB interface must be used instead. Verify that a loopback address has been configured as shown in the following example:

interface loopback 0
 ip address 10.10.2.1 255.255.255.255        
…
ip tacacs source-interface Loopback0
ip radius source-interface Loopback0

Note: IOS allows multiple loopback interfaces to be defined. 
</check-content></check></Rule></Group><Group id="V-14673"><title>Syslog traffic is not using loopback address.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-15340r2_rule" severity="low" weight="10.0"><version>NET0898</version><title>The router must use its loopback or OOB management interface address as the source address when originating syslog traffic.</title><description>&lt;VulnDiscussion&gt;Using a loopback address as the source address offers a multitude of uses for security, access, management, and scalability of routers. It is easier to construct appropriate ingress filters for router management plane traffic destined to the network management subnet since the source addresses will be from the range used for loopback interfaces instead of a larger range of addresses used for physical interfaces. Log information recorded by authentication and syslog servers will record the router’s loopback address instead of the numerous physical interface addresses. Syslog messages sent to management servers should use the loopback address as the source address.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-14135r3_fix">Configure the router to use its loopback or OOB management interface address as the source address when originating syslog traffic.</fixtext><fix id="F-14135r3_fix" /><check system="C-12806r2_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Review the configuration and verify the loopback interface address is used as the source address when originating syslog traffic. If the device is managed from an OOB management network, the OOB interface must be used instead. The configuration should look similar as shown in the following example:
interface loopback 0
 ip address 10.10.2.1 255.255.255.255        
…
logging on
logging host 192.168.1.100
logging source-interface Loopback0

Note: IOS allows multiple loopback interfaces to be defined. 
</check-content></check></Rule></Group><Group id="V-14674"><title>NTP traffic is not using loopback address.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-15343r2_rule" severity="low" weight="10.0"><version>NET0899</version><title>The router must use its loopback or OOB management interface address as the source address when originating NTP traffic.</title><description>&lt;VulnDiscussion&gt;Using a loopback address as the source address offers a multitude of uses for security, access, management, and scalability of routers. It is easier to construct appropriate ingress filters for router management plane traffic destined to the network management subnet since the source addresses will be from the range used for loopback interfaces instead of a larger range of addresses used for physical interfaces. Log information recorded by authentication and syslog servers will record the router’s loopback address instead of the numerous physical interface addresses. NTP messages sent to management servers should use the loopback address as the source address. &lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-14136r3_fix">Configure the router to use its loopback or OOB management interface address as the source address when originating NTP traffic.</fixtext><fix id="F-14136r3_fix" /><check system="C-12809r3_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Review the configuration and verify the loopback interface address is used as the source address when originating NTP traffic. If the device is managed from an OOB management network, the OOB interface must be used instead. The configuration should look similar as shown in the following example:

interface loopback 0
 ip address 10.10.2.1 255.255.255.255        
…
ntp server 129.237.32.2
ntp server 142.181.31.6
ntp source Loopback0

Note: IOS allows multiple loopback interfaces to be defined. 
</check-content></check></Rule></Group><Group id="V-14675"><title>SNMP traffic does not use loopback address.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-15346r2_rule" severity="low" weight="10.0"><version>NET0900</version><title>The router must use its loopback or OOB management interface address as the source address when originating SNMP traffic.</title><description>&lt;VulnDiscussion&gt;Using a loopback address as the source address offers a multitude of uses for security, access, management, and scalability of routers. It is easier to construct appropriate ingress filters for router management plane traffic destined to the network management subnet since the source addresses will be from the range used for loopback interfaces instead of a larger range of addresses used for physical interfaces. Log information recorded by authentication and syslog servers will record the router’s loopback address instead of the numerous physical interface addresses. SNMP messages sent to management servers should use the loopback address as the source address. &lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-14137r3_fix">Configure the router to use its loopback or OOB management interface address as the source address when originating SNMP traffic.</fixtext><fix id="F-14137r3_fix" /><check system="C-12812r2_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Review the configuration and verify the loopback interface address is used as the source address when originating SNMP traffic. If the device is managed from an OOB management network, the OOB interface must be used instead. The configuration should look similar as shown in the following example:
interface loopback 0
 ip address 10.10.2.1 255.255.255.255        
…
…
snmp-server trap-source Loopback0

Note: IOS allows multiple loopback interfaces to be defined. 
</check-content></check></Rule></Group><Group id="V-14676"><title>Netflow traffic is not using loopback address.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-15349r2_rule" severity="low" weight="10.0"><version>NET0901</version><title>The router must use its loopback or OOB management interface address as the source address when originating NetFlow traffic.</title><description>&lt;VulnDiscussion&gt;Using a loopback address as the source address offers a multitude of uses for security, access, management, and scalability of routers. It is easier to construct appropriate ingress filters for router management plane traffic destined to the network management subnet since the source addresses will be from the range used for loopback interfaces instead of a larger range of addresses used for physical interfaces. Log information recorded by authentication and syslog servers will record the router’s loopback address instead of the numerous physical interface addresses. Netflow messages sent to management servers should use the loopback address as the source address. &lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-14138r2_fix">Configure the router to use its loopback or OOB management interface address as the source address when originating NetFlow traffic.</fixtext><fix id="F-14138r2_fix" /><check system="C-12815r2_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Review the configuration and verify the loopback interface address is used as the source address when originating NetFlow traffic. If the device is managed from an OOB management network, the OOB interface must be used instead. The configuration should look similar as shown in the following example:
interface loopback 0
 ip address 10.10.2.1 255.255.255.255        
…
…
ip flow-sampling-mode packet-interval 100
ip flow-export destination 192.168.3.33 9991
ip flow-export source Loopback0

Note: IOS allows multiple loopback interfaces to be defined. 
</check-content></check></Rule></Group><Group id="V-14677"><title>FTP/TFTP traffic does not use loopback address.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-15352r3_rule" severity="low" weight="10.0"><version>NET0902</version><title>The network device must use its loopback or OOB management interface address as the source address when originating TFTP or FTP traffic.</title><description>&lt;VulnDiscussion&gt;Using a loopback address as the source address offers a multitude of uses for security, access, management, and scalability of network devices. It is easier to construct appropriate ingress filters for management plane traffic destined to the network management subnet since the source addresses will be from the range used for loopback interfaces instead of a larger range of addresses used for physical interfaces. Log information recorded by authentication and syslog servers will record the router’s loopback address instead of the numerous physical interface addresses. TFTP and FTP messages sent to management servers should use the loopback address as the source address.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-40461r1_fix">Configure the network device to use a loopback interface address as the source address when originating TFTP or FTP traffic.

Example:
Router(config)# interface loopback 0
Router(config-if)# ip address x.x.x.x 255.255.255.255       
Router(config)# ip ftp source-interface loopback0
Router(config)# ip tftp source-interface loopback0

If an OOB management interface is being used, configure the interface for TFTP or FTP traffic origination.

Example:
Router(config)# ip ftp source-interface fe0/0
Router(config)# ip tftp source-interface fe0/0</fixtext><fix id="F-40461r1_fix" /><check system="C-12819r6_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Review the configuration and verify a loopback interface address is used as the source address when originating TFTP or FTP traffic.  

Router# show run
Building configuration...
!
!
interface Loopback0
  description Loopback interface
  ip address x.x.x.x 255.255.255.255
  no ip directed-broadcast
!
...
ip telnet source-interface Loopback0
ip tftp source-interface Loopback0
ip ftp source-interface Loopback0

If the device is managed from an OOB management network, the OOB interface must be used instead.

Router# show run
Building configuration...
!
...
ip tftp source-interface fe0/0
ip ftp source-interface fe0/0</check-content></check></Rule></Group><Group id="V-14681"><title>Loopback address is not used as the iBGP source IP.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-15359r2_rule" severity="low" weight="10.0"><version>NET0903</version><title>The router must use its loopback interface address as the source address for all iBGP peering sessions.</title><description>&lt;VulnDiscussion&gt;Using a loopback address as the source address offers a multitude of uses for security, access, management, and scalability. It is easier to construct appropriate filters for control plane traffic. Log information recorded by authentication and syslog servers will record the router’s loopback address instead of the numerous physical interface addresses.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-14148r2_fix">Ensure the router’s loopback address is used as the source address for iBGP peering. </fixtext><fix id="F-14148r2_fix" /><check system="C-12826r2_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Verify that the peering session with iBGP neighbors use the loopback address as the source address as shown in the example below:

interface loopback 0
ip address 10.10.2.1 255.255.255.255        
…
router bgp 100
neighbor 200.200.200.2 remote-as 200
neighbor 188.20.120.2 remote-as 144
neighbor 10.10.2.2 remote-as 100
neighbor 10.10.2.2 update-source Loopback0
neighbor 10.10.2.3 remote-as 100
neighbor 10.10.2.3 update-source Loopback0
</check-content></check></Rule></Group><Group id="V-14693"><title>IPv6 Site Local Unicast ADDR must not be defined</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-15397r1_rule" severity="medium" weight="10.0"><version>NET-IPV6-025</version><title>The network element must be configured to ensure IPv6 Site Local Unicast addresses are not defined in the enclave, (FEC0::/10). Note that this consist of all addresses that begin with FEC, FED, FEE and FEF.</title><description>&lt;VulnDiscussion&gt;As currently defined, site local addresses are ambiguous and can be present in multiple sites.  The address itself does not contain any indication of the site to which it belongs.  The use of site-local addresses has the potential to adversely affect network security through leaks, ambiguity and potential misrouting, as documented in section 2 of RFC3879.  RFC3879 formally deprecates the IPv6 site-local unicast prefix defined in RFC3513, i.e., 1111111011 binary or FEC0::/10.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-14158r1_fix">Configure the device using authorized IP addresses.</fixtext><fix id="F-14158r1_fix" /><check system="C-12864r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Procedure:  Review the device configuration to ensure FEC0::/10 IP addresses are not defined. </check-content></check></Rule></Group><Group id="V-14705"><title>IPv6 routers are not configured with CEF enabled </title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-15425r1_rule" severity="medium" weight="10.0"><version>NET-IPV6-033</version><title>The administrator will enable CEF to improve router stability during a SYN flood attack in an IPv6 enclave. </title><description>&lt;VulnDiscussion&gt;The Cisco Express Forwarding (CEF) switching mode replaces the traditional Cisco routing cache with a data structure that mirrors the entire system routing table. Because there is no need to build cache entries when traffic starts arriving for new destinations, CEF behaves more predictably when presented with large volumes of traffic addressed to many destinations—such as a SYN flood attacks that. Because many SYN flood attacks use randomized source addresses to which the hosts under attack will reply to, there can be a substantial amount of traffic for a large number of destinations that the router will have to handle. Consequently, routers configured for CEF will perform better under SYN floods directed at hosts inside the network than routers using the traditional cache. 

Note: Juniper’s FPC (Flexible PIC Concentrator) architecture with the integrated Packet Forwarding Engine provides similar functionality and capabilities and is far superior than the traditional routing cache that is vulnerable to a DoS attack described above. The forwarding plane on all Juniper M and T  Series platforms are built around this architecture and therefore is not configurable. The forwarding plane on all Juniper M and T Series platforms are built around the FPC (Flexible PIC Concentrator) architecture that has similar capabilities as CEF. FPC is not configurable and is totally integrated with the Packet Forwarding Engine; hence, this will always be not a finding.
&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-14170r1_fix">The IAO will ensure that the ipv6 cef command has been configured on Cisco routers. </fixtext><fix id="F-14170r1_fix" /><check system="C-12892r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>IOS Procedure:  Review all Cisco routers to ensure that CEF has been enabled. The configuration should look similar to the following: ipv6 cef  </check-content></check></Rule></Group><Group id="V-14707"><title>IPv6 Egress Outbound Spoofing Filter </title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-15429r1_rule" severity="medium" weight="10.0"><version>NET-IPV6-034</version><title>The network element must be configured from accepting any outbound IP packet that contains an illegitimate address in the source address field via egress ACL or by enabling Unicast Reverse Path Forwarding in an IPv6 enclave.</title><description>&lt;VulnDiscussion&gt;Unicast Reverse Path Forwarding (uRPF) provides a mechanism for IP address spoof protection.  When uRPF is enabled on an interface, the router examines all packets received as input on that interface to make sure that the source address and source interface appear in the routing table and match the interface on which the packet was received.  If the packet was received from one of the best reverse path routes, the packet is forwarded as normal.  If there is no reverse path route on the same interface from which the packet was received, it might mean that the source address was modified.  If Unicast RPF does not find a reverse path for the packet, the packet is dropped.

If internal nodes automatically configure an address based on a prefix from a bogus Router Advertisement a dangerous situation may exist. An internal host may contact an internal server which responds with a packet that could be routed outside of the network via default routing (because the routers do not recognize the destination address as an internal address).  

To prevent this, filtering should be applied to network interfaces between internal host LANs and internal server LANs to insure that source addresses have valid prefixes. 
&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-14172r1_fix">The network element must be configured to ensure that an ACL is configured to restrict the router from accepting any outbound IP packet that contains an external IP address in the source field. </fixtext><fix id="F-14172r1_fix" /><check system="C-12894r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Unicast Strict mode: Review the router configuration to ensure uRPF has been configured on all internal interfaces.</check-content></check><check system="C-12896r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>IOS example	
interface FastEthernet 1/1
description downstream link to our network
ipv6 address 2001:db8:60::f15:60c2 
ipv6 verify unicast source reachable-via rx  outbound-to-backbone 
 
ipv6  access-list outbound-to-backbone
remark explicitly block all other packets
deny   ipv6 any any log
</check-content></check></Rule></Group><Group id="V-14717"><title>The network element must not allow SSH Version 1.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-15460r2_rule" severity="medium" weight="10.0"><version>NET1647</version><title>The network element must not use SSH Version 1 for administrative access.</title><description>&lt;VulnDiscussion&gt;SSH Version 1 is a protocol that has never been defined in a standard.  Since SSH-1 has inherent design flaws which make it vulnerable to, e.g., man-in-the-middle attacks, it is now generally considered obsolete and should be avoided by explicitly disabling fallback to SSH-1. &lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-14184r3_fix">Configure the network element to use SSH version 2. </fixtext><fix id="F-14184r3_fix" /><check system="C-12925r2_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>If SSH is used for administrative access, then Version 2 must be configured as shown in the following example:

ip ssh version 2
</check-content></check></Rule></Group><Group id="V-15288"><title>ISATAP tunnels must terminate at interior router.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-16068r2_rule" severity="medium" weight="10.0"><version>NET-TUNL-017</version><title>ISATAP tunnels must terminate at an interior router.</title><description>&lt;VulnDiscussion&gt;ISATAP is an automatic tunnel mechanism that does not provide authentication such as IPSec.  As a result of this limitation, ISATAP is thought of as a tool that is used inside the enclave among trusted hosts, which would limit it to internal attacks.  ISATAP is a service versus a product, and is readily available to most users.  If a user knows the ISATAP router IP address, they can essentially get onto the IPv6 intranet.  To control the vulnerability of this tunnel mechanism, it is critical to control the use of protocol 41 and use IPv4 filters to control what IPv4 nodes can send protocol 41 packets to an ISATAP router interface.  Although the ISATAP tunneling mechanism is similar to other automatic tunneling mechanisms, such as IPv6 6to4 tunneling, ISATAP is designed for transporting IPv6 packets between sites within an enclave, not between enclaves.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-14730r6_fix">Terminate ISATAP tunnels at the infrastructure router to prohibit tunneled traffic from exiting the enclave perimeter prior to inspection by the IDS, IPS, or firewall.</fixtext><fix id="F-14730r6_fix" /><check system="C-13687r4_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Verify ISATAP tunnels are terminated on the infrastructure routers or L3 switches within the enclave.

Example configuration of an ISATAP tunnel endpoint: 
interface tunnel 1
no ip address
no ip redirects 
tunnel source ethernet 1
 tunnel mode ipv6ip isatap
 ipv6 address 2001:0DB8::/64 eui-64
 no ipv6 nd suppress-ra</check-content></check></Rule></Group><Group id="V-15432"><title>The device is not authenticated using a AAA server.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-16259r2_rule" severity="medium" weight="10.0"><version>NET0433</version><title>The network element must use two or more authentication servers for the purpose of granting administrative access.</title><description>&lt;VulnDiscussion&gt;The use of Authentication, Authorization, and Accounting (AAA) affords the best methods for controlling user access, authorization levels, and activity logging.  By enabling AAA on the routers in conjunction with an authentication server such as TACACS+ or RADIUS, the administrators can easily add or remove user accounts, add or remove command authorizations, and maintain a log of user activity.

The use of an authentication server provides the capability to assign router administrators to tiered groups that contain their privilege level that is used for authorization of specific commands.   For example, user mode would be authorized for all authenticated administrators while configuration or edit mode should only be granted to those administrators that are permitted to implement router configuration changes. 
&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;IAIA-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-15096r2_fix">Ensure an authentication server is required to access the device and that there are two or more authentication servers defined.</fixtext><fix id="F-15096r2_fix" /><check system="C-14439r4_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Verify an authentication server is required to access the device and that there are two or more authentication servers defined.
</check-content></check></Rule></Group><Group id="V-15434"><title>Emergency account privilege level is not set.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-16261r2_rule" severity="high" weight="10.0"><version>NET0441</version><title>The network element’s emergency account must be set to an appropriate authorization level to perform necessary administrative functions when the authentication server is not online.</title><description>&lt;VulnDiscussion&gt;The emergency account is to be configured as a local account on the network element. It is to be used only when the authentication server is offline or not reachable via the network. The emergency account must be set to an appropriate authorization level to perform necessary administrative functions during this time.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-15098r6_fix">Assign a privilege level to the emergency account to allow the administrator to perform necessary administrative functions when the authentication server is not online.</fixtext><fix id="F-15098r6_fix" /><check system="C-14441r3_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Review the emergency account configured on the network element and verify that it has been assigned to a privilege level that will enable the administrator to perform necessary administrative functions when the authentication server is not online.</check-content></check></Rule></Group><Group id="V-17754"><title>Management traffic is not restricted</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-19321r1_rule" severity="medium" weight="10.0"><version>NET1807</version><title>Management traffic is not restricted to only the authorized management packets based on destination and source IP address.   </title><description>&lt;VulnDiscussion&gt;The Out-of-Band Management (OOBM) network is an IP network used exclusively for the transport of OAM&amp;P data from the network being managed to the OSS components located at the NOC. Its design provides connectivity to each managed network element enabling network management traffic to flow between the managed NEs and the NOC.  This allows the use of paths separate from those used by the network being managed. Traffic from the managed network to the management network and vice-versa must be secured via IPSec encapsulation. &lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECNK-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target OOBM Gateway</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>OOBM Gateway</dc:subject><dc:identifier>1440</dc:identifier></reference><fixtext fixref="F-17652r1_fix">Where IPSec technology is deployed to connect the OOBM gateway routers or firewall, traffic entering the tunnels is restricted to only the authorized management packets based on destination and source IP address from the address block used for the management network.</fixtext><fix id="F-17652r1_fix" /><check system="C-20302r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Where IPSec technology is deployed to connect the OOBM gateway routers or firewall, the traffic entering the tunnels must be restricted to only the authorized management packets based on destination and source IP address from the address block used for the management network. Verify that all traffic from the managed network to the management network and vice-versa is secured via IPSec encapsulation. In the configuration examples, 10.2.2.0/24 is the management network at the NOC and 10.1.1.0/24 is the management address block used at the network being managed (i.e., the enclave).

For Cisco router, the access-list referenced by the crypto map must have the source and destination addresses belonging to the management network address space at the enclave and NOC respectively.

hostname OOBM-Gateway1
!
interface Serial1/0
 ip address 19.16.1.1 255.255.255.0
 description NIPRNet_Link
 crypto map myvpn
interface Fastethernet 0/0
 description Enclave_Management_LAN
 ip address 10.1.1.1 255.255.255.0 
!
crypto isakmp policy 1
 authentication pre-share
 lifetime 84600
 crypto isakmp key ******* address 19.16.2.1
!
crypto ipsec transform-set toNOC esp-des esp-md5-hmac 
!
crypto map myvpn 10 ipsec-isakmp 
 set peer 19.16.2.1
 set transform-set toNOC
 match address 101
!
access-list 101 permit ip 10.1.1.0 0.0.0.255 10.2.2.0 0.0.0.255


</check-content></check></Rule></Group><Group id="V-17814"><title>Remote VPN end-point not a mirror of local gateway</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-19063r1_rule" severity="medium" weight="10.0"><version>NET1808</version><title>Gateway configuration at the remote VPN end-point is a not a mirror of the local gateway </title><description>&lt;VulnDiscussion&gt;The IPSec tunnel end points may be configured on the OOBM gateway routers connecting the managed network and the NOC. They may also be configured on a firewall or VPN concentrator located behind the gateway router. In either case, the crypto access-list used to identify the traffic to be protected must be a mirror (both IP source and destination address) of the crypto access list configured at the remote VPN peer.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;System Administrator&lt;/Responsibility&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-17724r1_fix">Configure he crypto access-list used to identify the traffic to be protected so that it is a mirror (both IP source and destination address) of the crypto access list configured at the remote VPN peer.</fixtext><fix id="F-17724r1_fix" /><check system="C-19020r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Verify the configuration at the remote VPN end-point is a mirror configuration as that reviewed for the local end-point.</check-content></check></Rule></Group><Group id="V-17815"><title>IGP instances do not peer with appropriate domain</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-19297r1_rule" severity="medium" weight="10.0"><version>NET0985</version><title>IGP instances configured on the OOBM gateway router do not peer only with their appropriate routing domain</title><description>&lt;VulnDiscussion&gt;If the gateway router is not a dedicated device for the OOBM network, several safeguards must be implemented for containment of management and production traffic boundaries. Since the managed network and the management network are separate routing domains, separate IGP routing instances must be configured on the router—one for the managed network and one for the OOBM network. &lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;System Administrator&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-17730r1_fix">Ensure that multiple IGP instances configured on the OOBM gateway router peer only with their appropriate routing domain. Verify that the all interfaces are configured for the appropriate IGP instance.</fixtext><fix id="F-17730r1_fix" /><check system="C-20142r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Verify that the OOBM interface is an adjacency only in the IGP routing domain for the management network. The following would be an example where EIGRP is run on the management network 10.0.0.0 and OSPF in the managed network 172.20.0.0. The network 10.1.20.0/24 is the OOBM backbone and 10.1.1.0 is the local management LAN connecting to the OOBM interfaces of the managed network (i.e., the private and service network) elements.

interface Serial0/0
 description to_OOBM_Backbone
 ip address 10.1.20.3 255.255.255.0
interface Fastethernet 0/0
 description Enclave_Management_LAN
 ip address 10.1.1.1 255.255.255.0 
interface Fastethernet 0/1
 description to_our_PrivateNet
 ip address 172.20.4.2 255.255.255.0 
interface Fastethernet 0/2
 description to_our_ServiceNet
 ip address 172.20.5.2 255.255.255.0 
!
router ospf 1
 network 172.20.0.0
!
router eigrp 12
 network 10.0.0.0
 passive-interface Fastethernet 0/1

Note: the passive-interface command is configured to avoid building an EIGRP adjacency with a managed router, while at the same time, enabling EIGRP to advertise the enclave’s management subnet to the EIGRP neighbors of the management network backbone.

If the non-dedicated OOBM gateway and the NOC gateway are not connected by an OOB backbone—that is, connectivity is provided over an IP backbone (i.e. NIPRNet)—and an IGP is used to advertise routes within the management network,  the IGP traffic must be encapsulated via  GRE so that it can traverse the IPsec tunnel. The configuration below is an example of GRE over IPSec. The IPSec policy is applied to the GRE traffic that will encapsulate IGP packets (notice the EIGRP network statement includes the GRE tunnel; hence, EIGRP will form adjacencies with neighbors on the other side of this tunnel.
 
Premise Router Configuration
crypto isakmp policy 10
 authentication pre-share
crypto isakmp key ourkey address 166.4.24.3
!
crypto ipsec transform-set VPN-trans esp-3des esp-md5-hmac
!
crypto map vpnmap 10 ipsec-isakmp
 set peer 166.4.24.3
 set transform-set VPN-trans
 match address 102
!
interface Ethernet1
 ip address 10.1.1.1 255.255.255.0
!
interface Serial1/0
 ip address 141.22.4.3 255.255.255.252
!
interface Tunnel0
 ip address 10.10.255.1 255.255.255.252
 ip mtu 1400
 tunnel source Serial0/0
 tunnel destination 166.4.24.3
 crypto map vpnmap
!
router eigrp 100
 network 10.0.0.0 0.0.0.255
 no auto-summary
!
ip route 0.0.0.0 0.0.0.0 141.22.4.1
!
access-list 102 permit gre host 141.22.4.3 host 166.4.24.3



OOBM VPN Gateway Configuration

crypto isakmp policy 10
 authentication pre-share
crypto isakmp key ourkey address 141.22.4.3
!
crypto ipsectransform-set VPN-trans esp-3des esp-md5-hmac
!
crypto map vpnmap 10 ipsec-isakmp
 set peer 141.22.4.3
 set transform-set VPN-trans
 match address 102
!
interface Ethernet1
 ip address 10.1.2.1 255.255.255.0
!
interface Serial1/0
ip address 166.4.24.3 255.255.255.252
!
interface Tunnel0
 ip address 10.10.255.2 255.255.255.252
 ip mtu 1400
 tunnel source Serial0/0
 tunnel destination 141.22.4.3
 crypto map vpnmap
!
router eigrp 100
 network 10.0.0.0 0.0.0.255
 no auto-summary
!
ip route 0.0.0.0 0.0.0.0 166.4.24.1
!
access-list 102 permit gre host 166.4.24.3 host 141.22.4.3

</check-content></check></Rule></Group><Group id="V-17816"><title>Routes from the two IGP domains are redistributed </title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-19299r1_rule" severity="medium" weight="10.0"><version>NET0986</version><title>The routes from the two IGP domains are redistributed to each other.</title><description>&lt;VulnDiscussion&gt;If the gateway router is not a dedicated device for the OOBM network, several safeguards must be implemented for containment of management and production traffic boundaries. Since the managed network and the management network are separate routing domains, separate IGP routing instances must be configured on the router—one for the managed network and one for the OOBM network. In addition, the routes from the two domains must not be redistributed to each other.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt; &lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;System Administrator&lt;/Responsibility&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-17731r1_fix">Ensure that the IGP instance used for the managed network does not redistribute routes into the IGP instance used for the management network and vice versa.</fixtext><fix id="F-17731r1_fix" /><check system="C-20200r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Verify that the IGP instance used for the managed network does not redistribute routes into the IGP instance used for the management network and vice versa.


Route advertisements between two the two routing domains such as OSPF and EIGRP can only be shared via redistribution. Verify that there are no redistribute commands configured under IGP domain for the management network that would enable distributing routes from the IGP domain of the managed network, or vice-versa. The following would be an example of redistributing routes from EIGRP into OSPF.

router ospf 1
 network 172.20.0.0
   redistribute eigrp 12


IOS supports multiple instances of OSPF and EIGRP that are configured using a different process ID.  Each EIGRP or OSPF process will run only on the interfaces of the networks specified. Each EIGRP process maintains a separate topology database; likewise, each OSPF process maintains a separate link-state database. Route advertisements between two processes can only be shared via redistribution.  Verify that there are no redistribution commands that would distribute routes from the IGP routing domain for the management network into the IGP routing domain of the managed network, or vice-versa. The following would be an example of redistributing routes from one EIGRP into another EIGRP.
!
router eigrp 15
 network 172.20.0.0
!
router eigrp 10
 network 10.0.0.0
 redistribute eigrp 15

As an alternative, static routes can be used to forward management traffic to the OOBM interface; however, this method may not scale well. 

If static routes are used to forward management traffic to the OOB backbone network, verify that the OOBM interface is not an IGP adjacency and that the correct destination prefix has been configured to forward the management traffic to the correct next-hop and interface for the static route. In the following configuration examples, 10.1.1.0/24 is the management network and 10.1.20.4 is the interface address of the OOB backbone router that the OOB gateway router connects to. The network 10.1.20.0/24 is the OOBM backbone.

interface Serial0/0
 description to_OOBM_Backbone
 ip address 10.1.20.3 255.255.255.0
interface Fastethernet 0/0
 description to_our_PrivateNet
 ip address 172.20.4.2 255.255.255.0 
interface Fastethernet 0/1
 description to_our_ServiceNet
 ip address 172.20.5.2 255.255.255.0 
!
router ospf 1
 network 172.20.0.0
!
ip route 10.1.1.0 255.255.255.0 10.1.20.4 Serial0/0


</check-content></check></Rule></Group><Group id="V-17817"><title>Managed network has access to OOBM gateway router</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-19301r1_rule" severity="medium" weight="10.0"><version>NET0987</version><title>Traffic from the managed network is able to access the OOBM gateway router</title><description>&lt;VulnDiscussion&gt;If the gateway router is not a dedicated device for the OOBM network, several safeguards must be implemented for containment of management and production traffic boundaries. It is imperative that hosts from the managed network are not able to access the OOBM gateway rouiter.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;System Administrator&lt;/Responsibility&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-17732r1_fix">Ensure that traffic from the managed network is not able to access the OOBM gateway router using either receive path or interface ingress ACLs.</fixtext><fix id="F-17732r1_fix" /><check system="C-20202r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Review the ACL or filters for the router’s receive path and verify that only traffic sourced from the management network is allowed to access the router. This would include both management and control plane traffic.

Step 1: Verify that the global ip receive acl statement has been configured as shown in the following example:

ip receive acl 199

Note: The IOS IP Receive ACL feature provides filtering capability for traffic that is destined for the router. The IP Receive ACL filtering occurs after any input ACL bound to the ingress interface. On distributed platforms (i.e., 12000 series), the IP receive ACL filters traffic on the distributed line cards before packets are received by the route processor; thereby preventing the flood from degrading the performance of the route processor.

Step 2: Determine the address block of the management network at the NOC. In the example configuration below, the 10.2.2.0/24 is the management network at the NOC.

Step 3: Verify that the ACL referenced by the ip receive acl statement restricts all management plane traffic to the validated network management address block at the NOC. Management traffic can include telnet, SSH, SNMP, TACACS, RADIUS, TFTP, FTP, and ICMP. Control plane traffic from OOBM backbone neighbors should also be allowed to access the router. The ACL configuration should look similar to the following: 

access-list 199 deny ip any any fragments
access-list 199 permit ospf 10.1.20.0 0.0.0.255 any
access-list 199 permit tcp 10.2.2.0 0.0.0.255 any eq ssh
access-list 199 permit udp host 10.2.2.24 any eq snmp
access-list 199 permit udp host 10.2.2.25 any eq snmp
access-list 199 permit udp host 10.2.2.26 any eq ntp
access-list 199 permit udp host 10.2.2.27 any eq ntp
access-list 199 permit tcp host 10.2.2.30 eq tacacs any gt 1023 established
access-list 199 permit tcp host 10.2.2.77 eq ftp any gt 1023 established
access-list 199 permit tcp host 10.2.2.77 gt 1024 any eq ftp-data
access-list 199 permit icmp 10.2.2.0 0.0.0.255 any 
access-list 199 deny ip any any log

In the example above, the OSPF neighbors would  be adjacencies with the OOBM backbone network 10.1.20.0/24. 

If the platform does not support the receive path filter, then verify that all non-OOBM interfaces have an ingress ACL to restrict access to that interface address or any of the router’s loopback addresses to only traffic sourced from the management network. Exception would be to allow packets destined to these interfaces used for troubleshooting such as ping and traceroute.

</check-content></check></Rule></Group><Group id="V-17818"><title>Traffic from the managed network will leak </title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-19303r1_rule" severity="medium" weight="10.0"><version>NET0988</version><title>Traffic from the managed network will leak into the management network via the gateway router interface connected to the OOBM backbone.</title><description>&lt;VulnDiscussion&gt;If the gateway router is not a dedicated device for the OOBM network, several safeguards must be implemented for containment of management and production traffic boundaries such as using interface ACLs or filters at the boundaries between the two networks. &lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;System Administrator&lt;/Responsibility&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-17733r1_fix">Configure the OOBM gateway router interface ACLs to ensure traffic from the managed network does not leak into the management network.</fixtext><fix id="F-17733r1_fix" /><check system="C-20204r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Examine the egress filter on the OOBM interface of the gateway router to verify that only traffic sourced from the management address space is allowed to transit the OOBM backbone. In the example configurations below, the 10.1.1.0/24 is the management network address space at the enclave or managed network and 10.2.2.0/24 is the management network address space at the NOC.

IOS

interface Serial0/0
 description to_OOBM_Backbone
 ip address 10.1.20.3 255.255.255.0
 ip access-group 101 out 
interface Fastethernet 0/0
 description Enclave_Management_LAN
 ip address 10.1.1.1 255.255.255.0 
interface Fastethernet 0/1
 description to_our_ServiceNet
 ip address 172.20.5.2 255.255.255.0 
!
access-list 101 permit ip 10.1.1.0 0.0.0.255 10.2.2.0 0.0.0.255
access-list 101 deny ip any any log
</check-content></check></Rule></Group><Group id="V-17819"><title>Management traffic leaks into the managed network</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-19305r1_rule" severity="medium" weight="10.0"><version>NET0989</version><title>Management network traffic is leaking into the managed network.</title><description>&lt;VulnDiscussion&gt;If the gateway router is not a dedicated device for the OOBM network, several safeguards must be implemented for containment of management and production traffic boundaries. To provide separation, access control lists or filters must be configured to block any traffic from the management network destined for the managed network’s production address spaces.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;System Administrator&lt;/Responsibility&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-17734r1_fix">Configure access control lists or filters to block any traffic from the management network destined for the managed network’s production address spaces.</fixtext><fix id="F-17734r1_fix" /><check system="C-20206r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Examine the ingress filter on the OOBM interface of the gateway router to verify that traffic is only destined to the local management address space. In the example configurations below, the 10.1.1.0/24 is the local management network address space at the enclave or managed network and 10.2.2.0/24 is the management network address space at the NOC.

IOS

interface Serial0/0
 description to_OOBM_Backbone
 ip address 10.1.20.3 255.255.255.0
 ip access-group 100 in 
 ip access-group 101 out 
interface Fastethernet 0/0
 description Enclave_Management_LAN
 ip address 10.1.1.2 255.255.255.0 
interface Fastethernet 0/1
 description to_our_ServiceNet
 ip address 172.20.5.2 255.255.255.0 
interface Fastethernet 0/2
 description to_our_PrivateNet
 ip address 172.20.4.2 255.255.255.0 
!
access-list 100 permit ip 10.2.2.0 0.0.0.255 10.1.1.0 0.0.0.255
access-list 100 deny ip any any log


</check-content></check></Rule></Group><Group id="V-17821"><title>The OOBM interface not configured correctly.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-20205r2_rule" severity="medium" weight="10.0"><version>NET0991</version><title>The network element’s OOBM interface must be configured with an OOBM network address.</title><description>&lt;VulnDiscussion&gt;The OOBM access switch will connect to the management interface of the managed network elements. The management interface of the managed network element will be directly connected to the OOBM network. An OOBM interface does not forward transit traffic; thereby, providing complete separation of production and management traffic. Since all management traffic is immediately forwarded into the management network, it is not exposed to possible tampering.  The separation also ensures that congestion or failures in the managed network do not affect the management of the device. If the OOBM interface does not have an IP address from the managed network address space, it will not have reachability from the NOC using scalable and normal control plane and forwarding mechanisms.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;System Administrator&lt;/Responsibility&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-17736r1_fix">Configure the managed network element’s OOBM interface with an IP address from the address space belonging to the OOBM network.</fixtext><fix id="F-17736r1_fix" /><check system="C-22335r2_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>After determining which interface is connected to the OOBM access switch, review the managed device configuration and verify that the interface has been assigned an address from the local management address block. In this example, that is 10.1.1.0/24.

Cisco router

interface Fastethernet 0/0
 description Enclave_Management_LAN
 ip address 10.1.1.22 255.255.255.0 

Cisco Catalyst MLS  Switch

interface VLAN 101
description Management_VLAN
ip address 10.1.1.22 255.255.255.0 
…
…
interface FastEthernet1/6
 switchport access vlan 101
 switchport mode access

or

interface FastEthernet1/6
 no switchport
 ip address 10.1.1.22 255.255.255.0 

Caveat: If the interface is configured as a routed interface as shown in the above configuration, the requirements specified in NOC180 must be implemented.
</check-content></check></Rule></Group><Group id="V-17822"><title>The management interface does not have an ACL.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-20208r1_rule" severity="medium" weight="10.0"><version>NET0992</version><title>The management interface is not configured with both an ingress and egress ACL. </title><description>&lt;VulnDiscussion&gt;The OOBM access switch will connect to the management interface of the managed network elements. The management interface can be a true OOBM interface or a standard interface functioning as the management interface. In either case, the management interface of the managed network element will be directly connected to the OOBM network.

An OOBM interface does not forward transit traffic; thereby, providing complete separation of production and management traffic. Since all management traffic is immediately forwarded into the management network, it is not exposed to possible tampering.  The separation also ensures that congestion or failures in the managed network do not affect the management of the device. If the device does not have an OOBM port, the interface functioning as the management interface must be configured so that management traffic does not leak into the managed network and that production traffic does not leak into the management network
&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;System Administrator&lt;/Responsibility&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-17737r1_fix">If the management interface is a routed interface, it must be configured with both an ingress and egress ACL. The ingress ACL should block any transit traffic, while the egress ACL should block any traffic that was not originated by the managed network elements.</fixtext><fix id="F-17737r1_fix" /><check system="C-22338r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Step 1: Verify that the managed interface has an inbound and outbound ACL configured  as shown in the following example:

interface FastEthernet1/1
 description Enclave_Management_LAN
 ip address 10.1.1.22 255.255.255.0 
 ip access-group 100 in 
 ip access-group 101 out 

Step 2: Verify that the ingress ACL blocks all transit traffic—that is, any traffic not destined to the router itself. In addition, traffic accessing the managed elements should be originated at the NOC. In the example the management network at the NOC is 10.2.2.0/24.

access-list 100 permit ip 10.2.2.0 0.0.0.255 host 10.1.1.22
access-list 100 deny ip any any log

Note that the destination used by any host within the management network to access the managed elements  must be via the management interface. The loopback should not be a valid address since these prefixes would not be advertised into the management network IGP domain. This could only be possible if the managed network Elements: had an IGP adjacency with the managed network, which should not be the case.

Step 3: Verify that the egress ACL blocks any traffic not originated by the managed element 

access-list 101 deny ip any any log

Cisco router-generated packets are not inspected by outgoing access-lists. Hence, the above configuration would simply drop any packets not generated by the router itself and allow all local traffic. To filter local traffic, IOS provides a feature called local policy routing, which enables the administrator to apply a route-map to any local router-generated traffic. To prohibit outgoing traffic from the local router to any destination other than the NOC, the a configuration such as the following could be used:

! Do not drop traffic destined to 10.2.2.0/24. Hence, do not include it in 
! the local policy route map, but include all other destinations.
!
ip access-list extended BLOCK_INVALID_DEST
 deny ip any 10.2.2.0 0.0.0.255
 permit ip any any
!
route-map LOCAL_POLICY 10
 match ip address BLOCK_INVALID_DEST
 set interface Null 0
!
ip local policy route-map LOCAL_POLICY


Alternative Solution: The IOS Management Plane Protection Feature

Cisco introduced the Management Plane Protection (MPP) feature with IOS 12.4(6)T which allows any physical in-band interface to be dedicated for OOB management. The MPP feature allows a network operator to designate one or more router interfaces as management interfaces. Management traffic is permitted to enter a device only through these management interfaces. All of the other in-band interfaces not enabled for MPP will automatically drop all ingress packets associated with any of the supported MPP protocols (FTP, HTTP, HTTPS, SCP, SSH, SNMP, Telnet, and TFTP). Hence, after MPP is enabled, no interfaces except management interfaces will accept network management traffic destined to the device. This feature also provides the capability to restrict which management protocols are allowed. This feature does not change the behavior of the console, auxiliary, and management Ethernet interfaces. The following configuration example depicts FastEthernet1/1 as being the designated management interface that will only allow ssh and snmp traffic.


control-plane host
 management-interface FastEthernet1/1 allow ssh snmp
!
interface FastEthernet1/1
 description Enclave_Management_LAN
 ip address 10.1.1.22 255.255.255.0 
</check-content></check></Rule></Group><Group id="V-17823"><title>The management interface is not IGP passive.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-19334r2_rule" severity="low" weight="10.0"><version>NET0993</version><title>The network element’s management interface is not configured as passive for the IGP instance deployed in the managed network.</title><description>&lt;VulnDiscussion&gt;The OOBM access switch will connect to the management interface of the managed network elements. The management interface can be a true OOBM interface or a standard interface functioning as the management interface. In either case, the management interface of the managed network element will be directly connected to the OOBM network.

An OOBM interface does not forward transit traffic; thereby, providing complete separation of production and management traffic. Since all management traffic is immediately forwarded into the management network, it is not exposed to possible tampering. The separation also ensures congestion or failures in the managed network do not affect the management of the device. If the device does not have an OOBM port, the interface functioning as the management interface must be configured so management traffic, both data plane and control plane, does not leak into the managed network and production traffic does not leak into the management network.
&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;System Administrator&lt;/Responsibility&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-17738r2_fix">Configure the management interface as passive for the IGP instance configured for the managed network. Depending on the platform and routing protocol, this may simply require that the interface or its IP address is not included in the IGP configuration.</fixtext><fix id="F-17738r2_fix" /><check system="C-20313r4_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>If the managed network element is a layer 3 device, review the configuration to verify the management interface is configured as passive for the IGP instance for the managed network. Depending on the platform and routing protocol, this may simply require that the interface or its IP address is not included in the IGP configuration.  The following configuration would be an example where  OSPF is only enabled on all interfaces except the management interface:

interface Fastethernet 0/0
 description Enclave_Management_LAN
 ip address 10.1.1.22 255.255.255.0 
 ip access-group 100 in 
 ip access-group 101 out 
interface Fastethernet 0/1
 description to_our_PrivateNet
 ip address 172.20.4.2 255.255.255.0 
interface Fastethernet 0/2
 description to_our_ServiceNet
 ip address 172.20.5.2 255.255.255.0 
interface Fastethernet 1/1
 description to_our_DMZ
 ip address 172.20.3.1 255.255.255.0 
!
router ospf 1
 network 172.20.0.0 255.255.255.0 area 1

Note: The MPP feature has no effect on control plane traffic. Hence, the routing protocol must still be configured so that it is not enabled on the management interface.

</check-content></check></Rule></Group><Group id="V-17824"><title>Management interface is assigned to a user VLAN. </title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-19337r1_rule" severity="medium" weight="10.0"><version>NET0994</version><title>The management interface is an access switchport and has not been assigned to a separate management VLAN. </title><description>&lt;VulnDiscussion&gt;The OOBM access switch will connect to the management interface of the managed network elements. The management interface can be a true OOBM interface or a standard interface functioning as the management interface. In either case, the management interface of the managed network element will be directly connected to the OOBM network. If the device does not have an OOBM port, the interface functioning as the management interface must be configured so that management traffic does not leak into the managed network and that production traffic does not leak into the management network.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;System Administrator&lt;/Responsibility&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-17739r1_fix">If the management interface is an access switchport, assign it to a separate management VLAN while the remainder of the access switchports can be assigned to user VLANs belonging to the managed network. This provides some level of separation between the management network and the managed network. </fixtext><fix id="F-17739r1_fix" /><check system="C-20316r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Review the managed switch configuration and verify that the access port connected to the OOBM access switch has been assigned to the management VLAN. By default, the management VLAN is VLAN 1; however, the management VLAN must be configured to a different VLAN. As shown in the following configuration example, FastEthernet0/1 is the port connected to the OOBM access switch and VLAN 101 is the management VLAN. 

interface FastEthernet0/1
 switchport access vlan 10
 switchport mode access
!
interface FastEthernet0/2
 switchport access vlan 2
 switchport mode access
!
interface FastEthernet0/3
 switchport access vlan 2
 switchport mode access
!
interface FastEthernet0/4
 switchport access vlan 2
 switchport mode access

This can also be verified by entering a Privileged EXEC show vlan command on the switch CLI as illustrated in the following example output of a Cisco 2950:

2950#show vlan 
VLAN Name                     Status    Ports 
---- ------------------------ --------- ------------------------------- 
2     Production              active    Fa0/2, Fa0/3, Fa0/4, Fa0/5, 
                                        ...
                                        Fa0/21, Fa0/22, Fa0/23, Fa0/24
10    Management              active    Fa0/1 
</check-content></check></Rule></Group><Group id="V-17825"><title>Management VLAN has invalid addresses</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-19338r1_rule" severity="low" weight="10.0"><version>NET0995</version><title>An address has not been configured for the management VLAN from space belonging to the OOBM network assigned to that site.</title><description>&lt;VulnDiscussion&gt;The OOBM access switch will connect to the management interface of the managed network elements. The management interface can be a true OOBM interface or a standard interface functioning as the management interface. In either case, the management interface of the managed network element will be directly connected to the OOBM network.

An OOBM interface does not forward transit traffic; thereby, providing complete separation of production and management traffic. Since all management traffic is immediately forwarded into the management network, it is not exposed to possible tampering.  The separation also ensures that congestion or failures in the managed network do not affect the management of the device. &lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;System Administrator&lt;/Responsibility&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-17740r1_fix">Assign an IP address to the management VLAN from the address space belonging to the OOBM network.</fixtext><fix id="F-17740r1_fix" /><check system="C-20317r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Review the managed switch configuration and verify that an address has been configured for management VLAN from space belonging to the OOBM network that has been assigned to that site. 

interface VLAN10
 ip address 10.1.1.10 255.255.255.0
 description Management VLAN

Note: The IP address of the switch can be accessed only by nodes connected to ports that belong to the management VLAN. 

A default gateway address as shown below must be configured using the address of the OOBM gateway router interface connecting to the OOBM access switch. This will ensure that all management traffic is forwarded toward the NOC using the switchport attached to the OOBM access switch.

ip default-gateway 10.1.1.1
 
</check-content></check></Rule></Group><Group id="V-17826"><title>Invalid ports with membership to the mgmt VLAN</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-19339r1_rule" severity="medium" weight="10.0"><version>NET0996</version><title>The access switchport connecting to the OOBM access switch is not the only port with membership to the management VLAN.</title><description>&lt;VulnDiscussion&gt;The OOBM access switch will connect to the management interface of the managed network elements. The management interface can be a true OOBM interface or a standard interface functioning as the management interface. In either case, the management interface of the managed network element will be directly connected to the OOBM network.

An OOBM interface does not forward transit traffic; thereby, providing complete separation of production and management traffic. Since all management traffic is immediately forwarded into the management network, it is not exposed to possible tampering.  The separation also ensures that congestion or failures in the managed network do not affect the management of the device. &lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;System Administrator&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-17741r1_fix">Ensure that the access switchport connecting to the OOBM access switch  is the only port with membership to the management VLAN</fixtext><fix id="F-17741r1_fix" /><check system="C-20318r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>The management VLAN must be pruned from any VLAN trunk links belonging to the managed network’s infrastructure. By default all the VLANs that exist on a switch are active on a trunk link. Since the switch is being managed via OOBM connection, management traffic should not traverse any trunk links. The following Catalyst IOS configuration is an example of a trunk link with the management VLAN (i.e. 10) pruned from a trunk.


interface fastEthernet0/1
 switchport trunk encapsulation dot1q
 switchport mode dynamic desirable
 switchport trunk native vlan 3
 switchport trunk allowed vlan 2-9

This can also be verified with the show interface trunk command as shown below:

Switch-A# show interface trunk
Port      Mode         Encapsulation  Status        Native vlan
Fa0/1     desirable    802.1q         trunking      3
Port      Vlans allowed on trunk
Fa0/1     2-9
Port      Vlans in spanning tree forwarding state and not pruned
Fa0/1     2-5

Note: VTP pruning allows the switch to not forward user traffic for VLANs that are not active on a remote switch. This feature dynamically prunes unneeded traffic across trunk links.  VTP pruning needs to be enabled on the server for the VTP domains—after which all VTP clients in the VTP domain will automatically enable VTP pruning. To enable VTP pruning on a Cisco IOS switch, you use the vtp pruning VLAN configuration or global configuration command. Since, the management VLAN will be active on all managed switchs, VTP will never prune this VLAN. Hence, it will have to be manually removed as shown above. 
</check-content></check></Rule></Group><Group id="V-17827"><title>The management VLAN is not pruned from trunk links</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-19340r1_rule" severity="low" weight="10.0"><version>NET0997</version><title>The management VLAN is not pruned from any VLAN trunk links belonging to the managed network’s infrastructure. 

</title><description>&lt;VulnDiscussion&gt;The OOBM access switch will connect to the management interface of the managed network elements. The management interface can be a true OOBM interface or a standard interface functioning as the management interface. In either case, the management interface of the managed network element will be directly connected to the OOBM network.

An OOBM interface does not forward transit traffic; thereby, providing complete separation of production and management traffic. Since all management traffic is immediately forwarded into the management network, it is not exposed to possible tampering.  The separation also ensures that congestion or failures in the managed network do not affect the management of the device. If the device does not have an OOBM port, the interface functioning as the management interface must be configured so that management traffic does not leak into the managed network and that production traffic does not leak into the management network. ISL and 802.1q trunking enables multiple VLANs to traverse the same physical links between layer 2 switches or between a layer 2 switch and a router. If the management VLAN is not pruned from any VLAN trunk links belonging to the managed network’s infrastructure, management traffic has the potential to leak into the production network.
&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;System Administrator&lt;/Responsibility&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-17744r1_fix">Prune the management VLAN from any VLAN trunk links belonging to the managed network’s infrastructure. </fixtext><fix id="F-17744r1_fix" /><check system="C-20319r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>The management VLAN must be pruned from any VLAN trunk links belonging to the managed network’s infrastructure.  By default all the VLANs that exist on a switch are active on a trunk link. Since the switch is being managed via OOBM connection, management traffic should not traverse any trunk links. The following Catalyst IOS configuration is an example of a trunk link with the management VLAN (i.e. 10) pruned from a trunk.


interface fastEthernet0/1
 switchport trunk encapsulation dot1q
 switchport mode dynamic desirable
 switchport trunk native vlan 3
 switchport trunk allowed vlan 2-9

This can also be verified with the show interface trunk command as shown below:

Switch-A# show interface trunk
Port      Mode         Encapsulation  Status        Native vlan
Fa0/1     desirable    802.1q         trunking      3
Port      Vlans allowed on trunk
Fa0/1     2-9
Port      Vlans in spanning tree forwarding state and not pruned
Fa0/1     2-5

Note: VTP pruning allows the switch to not forward user traffic for VLANs that are not active on a remote switch. This feature dynamically prunes unneeded traffic across trunk links.  VTP pruning needs to be enabled on the server for the VTP domains—after which all VTP clients in the VTP domain will automatically enable VTP pruning. To enable VTP pruning on a Cisco IOS switch, you use the vtp pruning VLAN configuration or global configuration command. Since, the management VLAN will be active on all managed switchs, VTP will never prune this VLAN. Hence, it will have to be manually removed as shown above. 
</check-content></check></Rule></Group><Group id="V-17832"><title>Mgmt VLAN does not have correct IP address</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-19702r1_rule" severity="medium" weight="10.0"><version>NET1003</version><title>The management VLAN is not configured with an IP address from the management network address block.</title><description>&lt;VulnDiscussion&gt;If the management systems reside within the same layer 2 switching domain as the managed network elements, then separate VLANs will be deployed to provide separation at that level. In this case, the management network still has its own subnet while at the same time it is defined as a unique VLAN.  &lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;System Administrator&lt;/Responsibility&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-17749r1_fix">Configure the management VLAN with an IP address from the management network address block.</fixtext><fix id="F-17749r1_fix" /><check system="C-20816r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Review the switch configuration and verify that the  management VLAN has been assigned an IP address from the management network address block. Following is an example for a Cisco Catalyst switch:


interface VLAN 10
 description Management VLAN
 ip address 10.1.1.10 255.255.255.0

Note: The IP address of the switch can be accessed only by nodes connected to ports that belong to the management VLAN. 
</check-content></check></Rule></Group><Group id="V-17833"><title>No ingress ACL on management VLAN interface</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-19703r1_rule" severity="medium" weight="10.0"><version>NET1004</version><title>The IAO will ensure that only authorized management traffic is forwarded by the multi-layer switch from the production or managed VLANs to the management VLAN.</title><description>&lt;VulnDiscussion&gt;If the management systems reside within the same layer 2 switching domain as the managed network elements, then separate VLANs will be deployed to provide separation at that level. In this case, the management network still has its own subnet while at the same time it is defined as a unique VLAN.  Inter-VLAN routing or the routing of traffic between nodes residing in different subnets requires a router or multi-layer switch (MLS). Access control lists must be used to enforce the boundaries between the management network and the network being managed. &lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;System Administrator&lt;/Responsibility&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-17750r1_fix">If an MLS is used to provide inter-VLAN routing, configure an inbound ACL for the management network VLAN interface.</fixtext><fix id="F-17750r1_fix" /><check system="C-19250r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Review the MLS configuration and verify that an inbound ACL has been configured for the management VLAN interface to block non-management traffic. </check-content></check><check system="C-20817r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>The following example for a Cisco Catalyst  multi-layer switch: 

   interface VLAN 10
    description Management VLAN
    ip address 10.1.1.1 255.255.255.0
    ip access-group 108 out
   !
   access-list 108 permit …
</check-content></check></Rule></Group><Group id="V-17834"><title>No inbound ACL for mgmt network sub-interface</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-19308r1_rule" severity="medium" weight="10.0"><version>NET1005</version><title>An inbound ACL is not configured for the management network sub-interface of the trunk link to block non-management traffic.

</title><description>&lt;VulnDiscussion&gt;If the management systems reside within the same layer 2 switching domain as the managed network elements, then separate VLANs will be deployed to provide separation at that level. In this case, the management network still has its own subnet while at the same time it is defined as a unique VLAN. Inter-VLAN routing or the routing of traffic between nodes residing in different subnets requires a router or multi-layer switch (MLS). Access control lists must be used to enforce the boundaries between the management network and the network being managed. All physical and virtual (i.e. MLS SVI) routed interfaces must be configured with ACLs to prevent the leaking of unauthorized traffic from one network to the other. &lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;System Administrator&lt;/Responsibility&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-17751r1_fix"> If a router is used to provide inter-VLAN routing, configure an inbound ACL for the management network sub-interface for the trunk link to block non-management traffic.
</fixtext><fix id="F-17751r1_fix" /><check system="C-20257r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Review the router configuration and verify that an inbound ACL has been configured for the management network sub-interface as illustrated in the following example configuration:

IOS

 interface GigabitEthernet3
  no ip redirects
  no ip directed-broadcast
 interface GigabitEthernet3.10        
  encapsulation dot1q 10
  description Management VLAN
  ip address 10.1.1.1 255.255.255.0
  ip access-group 108 in
 !
 access-list 108 permit …

</check-content></check></Rule></Group><Group id="V-17835"><title>IPSec traffic is not restricted</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-19310r1_rule" severity="medium" weight="10.0"><version>NET1006</version><title>Traffic entering the tunnels is not restricted to only the authorized management packets based on destination address. </title><description>&lt;VulnDiscussion&gt;Similar to the OOBM model, when the production network is managed in-band, the management network could also be housed at a NOC that is located locally or remotely at a single or multiple interconnected sites. NOC interconnectivity as well as connectivity between the NOC and the managed networks’ premise routers would be enabled using either provisioned circuits or VPN technologies such as IPSec tunnels or MPLS VPN services. &lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;System Administrator&lt;/Responsibility&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-17752r1_fix">Where IPSec technology is deployed to connect the managed network to the NOC, it is imperative that the traffic entering the tunnels is restricted to only the authorized management packets based on destination address. </fixtext><fix id="F-17752r1_fix" /><check system="C-20259r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Verify that all traffic from the managed network to the management network and vice-versa is secured via IPSec encapsulation. In the configuration examples, 10.2.2.0/24 is the management network at the NOC and 192.168.1.0/24 is  address space used at the network being managed (i.e., the enclave).  For Cisco router, the access-list referenced by the crypto map must have the source and destination addresses belonging to the management network address space at the enclave and NOC respectively.

hostname Premrouter
!
interface Serial1/0
 ip address 19.16.1.1 255.255.255.0
 description NIPRNet_Link
 crypto map myvpn
interface Fastethernet 0/0
 description Enclave_Management_LAN
 ip address 192.168.1.1 255.255.255.0 
!
crypto isakmp policy 1
 authentication pre-share
 lifetime 84600
 crypto isakmp key ******* address 19.16.2.1
!
crypto ipsec transform-set toNOC esp-des esp-md5-hmac 
!
crypto map myvpn 10 ipsec-isakmp 
 set peer 19.16.2.1
 set transform-set toNOC
 match address 101
!
access-list 101 permit ip any 10.2.2.0 0.0.0.255

</check-content></check></Rule></Group><Group id="V-17836"><title>Management traffic is not classified and marked</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-19313r1_rule" severity="low" weight="10.0"><version>NET1007</version><title>Management traffic is not classified and marked at the nearest upstream MLS or router when management traffic must traverse several nodes to reach the management network.</title><description>&lt;VulnDiscussion&gt;When network congestion occurs, all traffic has an equal chance of being dropped. 
Prioritization of network management traffic must be implemented to ensure that even during periods of severe network congestion, the network can be managed and monitored. Quality of Service (QoS) provisioning categorizes network traffic, prioritizes it according to its relative importance, and provides priority treatment through congestion avoidance techniques. Implementing QoS within the network makes network performance more predictable and bandwidth utilization more effective. Most important, since the same bandwidth is being used to manage the network, it provides some assurance that there will be bandwidth available to troubleshoot outages and restore availability when needed. 

When management traffic must traverse several nodes to reach the management network, management traffic should be classified and marked at the nearest upstream MLS or router. In addition, all core routers within the managed network must be configured to provide preferred treatment based on the QoS markings. This will ensure that management traffic receives preferred treatment (per-hop behavior) at each forwarding device along the path to the management network. traffic.
&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;System Administrator&lt;/Responsibility&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-17756r1_fix">When management traffic must traverse several nodes to reach the management network, classify and mark management traffic at the nearest upstream MLS or router.</fixtext><fix id="F-17756r1_fix" /><check system="C-20262r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>class-map match-all MANAGEMENT-TRAFFIC
  match access-group name CLASSIFY-MANAGEMENT-TRAFFIC
!
policy-map DIST-LAYER-POLICY
 class MANAGEMENT-TRAFFIC
 set ip dscp 48
!
interface FastEthernet0/0
 description link to LAN1
 ip address 192.168.1.1 255.255.255.0
 service-policy input DIST-LAYER-POLICY
interface FastEthernet0/1
 description link to LAN2
 ip address 192.168.2.1 255.255.255.0
 service-policy input DIST-LAYER-POLICY
interface FastEthernet0/2
 description link to core
 ip address 192.168.13.1 255.255.255.0
!
ip access-list extended CLASSIFY-MANAGEMENT-TRAFFIC
 permit ip any 10.2.2.0 0.0.0.255

Note: Traffic is marked using the set command in a policy map. For DSCP rewrite, if a packet encounters both input and output classification policy, the output policy has precedence. If  there is no output policy, then the input policy has precedence.

</check-content></check></Rule></Group><Group id="V-17837"><title>Management traffic doesn't get preferred treatment</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-19315r1_rule" severity="low" weight="10.0"><version>NET1008</version><title>The core router within the managed network has not been configured to provide preferred treatment for management traffic that must traverse several nodes to reach the management network.</title><description>&lt;VulnDiscussion&gt;When network congestion occurs, all traffic has an equal chance of being dropped. 
Prioritization of network management traffic must be implemented to ensure that even during periods of severe network congestion, the network can be managed and monitored. Quality of Service (QoS) provisioning categorizes network traffic, prioritizes it according to its relative importance, and provides priority treatment through congestion avoidance techniques. Implementing QoS within the network makes network performance more predictable and bandwidth utilization more effective. Most important, since the same bandwidth is being used to manage the network, it provides some assurance that there will be bandwidth available to troubleshoot outages and restore availability when needed. 

When management traffic must traverse several nodes to reach the management network, management traffic should be classified and marked at the nearest upstream MLS or router. In addition, all core routers within the managed network must be configured to provide preferred treatment based on the QoS markings. This will ensure that management traffic receives preferred treatment (per-hop behavior) at each forwarding device along the path to the management network. traffic.
&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;System Administrator&lt;/Responsibility&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-17757r1_fix">When management traffic must traverse several nodes to reach the management network, ensure that all core routers within the managed network have been configured to provide preferred treatment for management traffic. </fixtext><fix id="F-17757r1_fix" /><check system="C-20264r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>When management traffic must traverse several nodes to reach the management network, ensure that all core routers within the managed network have been configured to provide preferred treatment for management traffic. This will ensure that management traffic receives guaranteed  bandwidth at each forwarding device along the path to the management network. 

Step 1: Verify that a service policy is bound to all core or internal router interfaces as shown in the configuration below:

interface FastEthernet0/1
 ip address 192.168.2.1 255.255.255.0 
 service-policy output QoS-Policy
interface FastEthernet0/2 
  ip address 192.168.1.1 255.255.255.0
 service-policy output QoS-Policy

Step 2: Verify that the class-maps place management traffic in the appropriate forwarding class as shown in the example below:

class-map match-all best-effort
 match ip dscp 0
class-map match-any data-AF13-AF23
 match ip dscp 14
 match ip dscp 22
class-map match-any video-AF33-AF43
 match ip dscp 30
 match ip dscp 38
class-map match-all voice-EF
 match ip dscp 46
class-map match-all network-control
 match ip dscp 48

               
Step 3: Verify that the classes are receiving the required service. 

policy-map QoS-Policy
 class best-effort
  bandwidth percent 10
  random-detect dscp-based 
 class data-AF13-AF23
  bandwidth percent 30
  random-detect dscp-based 
 class video-AF33
  bandwidth percent 15
  random-detect dscp-based 
class video-AF43
  bandwidth percent 20
  random-detect dscp-based 
 class voice-EF
   priority percent 20
 class network-control
  bandwidth percent 5
  random-detect dscp-based

Note 1: The dscp-based argument enables WRED to use the DSCP value of a packet when it calculates the drop probability for the packet; whereas if the prec-based argument is specified, WRED will use the IP Precedence value to calculate drop probability. If neither is specified, the default is prec-based.

Note 2: LLQ is enabled with the priority command using either a kbps value or a bandwidth percentage using the percent keyword followed by a percentage value.

Note 3: Traffic that does not meet the match criteria specified in the forwarding classes is treated as belonging to the default forwarding class. If a default class is not configured, the default class has no QoS functionality. These packets are then placed into a FIFO queue and forwarded at a rate determined by the available underlying bandwidth. This FIFO queue is managed by tail drop—a means of avoiding congestion that treats all traffic equally and does not differentiate between classes of service. When the output queue is full and tail drop is in effect, packets are dropped until the congestion is eliminated and the queue is no longer full. The following example configures a default class called policy1. 

policy-map policy1
 class class-default
  fair-queue 10
  queue-limit 20

The default class shown above has these characteristics: 10 queues for traffic that does not meet the match criteria of other classes whose policy is defined by policy1, and a maximum of 20 packets per queue before tail drop is enacted to handle additional queued packets.

 
</check-content></check></Rule></Group><Group id="V-18522"><title>ACLs must restrict access to server VLANs.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-20061r2_rule" severity="medium" weight="10.0"><version>NET-SRVFRM-003</version><title>Server VLAN interfaces must be protected by restrictive ACLs using a deny-by-default security posture.</title><description>&lt;VulnDiscussion&gt;Protecting data sitting in a server VLAN is necessary and can be accomplished using access control lists on VLANs provisioned for servers.  Without proper access control of traffic entering or leaving the server VLAN, potential threats such as a denial of service, data corruption, or theft could occur, resulting in the inability to complete mission requirements by authorized users.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECND-1, ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-19125r4_fix">Configure an ACL to protect the server VLAN interface.  The ACL must be in a deny-by-default security posture.</fixtext><fix id="F-19125r4_fix" /><check system="C-21297r5_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Review the device configuration to validate an ACL with a deny-by-default security posture has been implemented on the server VLAN interface.</check-content></check></Rule></Group><Group id="V-18523"><title>ACLs do not protect against compromised servers</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-20062r1_rule" severity="medium" weight="10.0"><version>NET-SRVFRM-004</version><title>The IAO will ensure the Server Farm infrastructure is secured by ACLs on VLAN interfaces that restrict data originating from one server farm segment destined to another server farm segment.</title><description>&lt;VulnDiscussion&gt;ACLs on VLAN interfaces do not protect against compromised servers. The Server farm vlans need to protect the servers located on one subnet from servers located on another subnet. Protecting a client’s data from other clients is necessary and can be accomplished using VLAN provisioning, layer 3 filtering and content filtering at the Server Farm entry point. Restricting protocol, source and destination traffic via filters is an option; however additional security practices such as content filtering are required.

The Server farm private vlans need to protect the servers located on one subnet from servers located on another subnet.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECND-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-19126r1_fix">Review the filter and ensure access from other server segments is denied unless necessary for application operation. The intent of the policy should be to protect servers from a server that has been compromised by an intruder.</fixtext><fix id="F-19126r1_fix" /><check system="C-21298r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Review the firewall protecting the server farm. Vlan configurations should have a filter that secures the servers located on the vlan segment. Identify the source ip addresses that have access to the servers and verify the privilege intended with the SA. The filter should be in a deny by default posture.

If the filter is not defined on the firewall and the architecture contains a layer 3 switch between the firewall and the server, than review the VLAN definition on the L3 switch.
</check-content></check></Rule></Group><Group id="V-18544"><title>Restricted VLAN not assigned to non-802.1x device.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-20088r2_rule" severity="low" weight="10.0"><version>NET-VLAN-023</version><title>Printers must be assigned to a VLAN that is not shared by unlike devices.</title><description>&lt;VulnDiscussion&gt;Aspects of hardening the network wall plate may include traffic filtering or restrictions on connectivity to enforce a device-, community of interest-, or user-specific security policy. For example, if a printer were plugged into a switch port, it would be prudent to ensure that only printer traffic is allowed on that switch port. If the printer is unplugged and a substitute device other than a printer is plugged into that switch port, the substitute device should not be able to communicate arbitrarily with other devices because only printer traffic is allowed on that switch port.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;DCSP-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-19148r3_fix">Create a VLAN on the device for print type devices and assign printers to the VLAN ID.</fixtext><fix id="F-19148r3_fix" /><check system="C-21399r3_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Review the device configuration to determine if a VLAN has been established for printers.</check-content></check></Rule></Group><Group id="V-18545"><title>Upstream access not restricted for non-802.1x VLAN</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-20089r1_rule" severity="medium" weight="10.0"><version>NET-VLAN-024</version><title>The SA will ensure a packet filter is implemented to filter the enclave traffic to and from printer VLANs to allow only print traffic.</title><description>&lt;VulnDiscussion&gt;A firewall rule set can filter network traffic within the printer VLAN to only expected printer protocols. The SA managing the local enclave should identify the printer port traffic within the enclave. Ports commonly used by printers are typically tcp port 515, 631, 1782 and tcp ports 9100, 9101, 9102 but others are used throughout the industry. The SA can review RFC 1700 Port Assignments and review printer vendor documents for the filter rule-set.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECND-2&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-19149r1_fix">Define the filter on the VLAN ACL or build a firewall ruleset to accomplish the requirment.</fixtext><fix id="F-19149r1_fix" /><check system="C-21406r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>An ACL or firewall rule set can filter network traffic within the printer VLAN to only expected printer protocols. The SA managing the local enclave should identify the printer port traffic within the enclave. Ports commonly used by printers are typically tcp port 515, 631, 1782 and tcp ports 9100, 9101, 9102 but others are used throughout the industry. The SA can review RFC 1700 Port Assignments and review printer vendor documents for the filter rule-set. Verify the filter applied to the printer VLAN subnet.</check-content></check></Rule></Group><Group id="V-18565"><title>Switchport does not shutdown on a violation</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-20109r1_rule" severity="low" weight="10.0"><version>NET-NAC-032</version><title>The IAO will ensure that all switchports configured using MAC port security will shutdown upon receiving a frame with a different layer 2 source address than what has been configured or learned for port security.</title><description>&lt;VulnDiscussion&gt;The Port Security feature remembers the Ethernet MAC address connected to the switch port and allows only that MAC address to communicate on that port. If any other MAC address tries to communicate through the port, port security will disable the port. &lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;DCSP-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-19192r1_fix">Configure the port to shutdown when insecure hosts are connected to the wall jack.</fixtext><fix id="F-19192r1_fix" /><check system="C-21652r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>A shutdown action puts the interface into the error-disabled state immediately and sends an SNMP trap notification if it receives a frame with a different layer 2 source address that what has been configured or learned for port security. The following Catalyst IOS interface command will shutdown the interface when such an event occurs:

switchport port-security violation shutdown
</check-content></check></Rule></Group><Group id="V-18566"><title>NET-NAC-031</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-49133r1_rule" severity="medium" weight="10.0"><version>NET-NAC-031</version><title>The switch must only allow a maximum of one registered MAC address per access port.</title><description>&lt;VulnDiscussion&gt;Limiting the number of registered MAC addresses on a switch access port can help prevent a CAM table overflow attack.  This type of attack lets an attacker exploit the hardware and memory limitations of a switch.  If there are enough entries stored in a CAM table before the expiration of other entries, no new entries can be accepted into the CAM table. An attacker will able to flood the switch with mostly invalid MAC addresses until the CAM table’s resources have been depleted.  When there are no more resources, the switch has no choice but to flood all ports within the VLAN with all incoming traffic.  This happens because the switch cannot find the switch port number for a corresponding MAC address within the CAM table, allowing the switch to become a hub and traffic to be monitored.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;DCSP-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-19193r3_fix">Configure the switch to limit the maximum number of registered MAC addresses on each access switch port to one.</fixtext><fix id="F-19193r3_fix" /><check system="C-45619r8_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Review the switch configuration to verify each access port is configured for a single registered MAC address.

Configuring port-security on the Cisco switch access port interface will automatically set the maximum number of registered MAC addresses to one.  The value will not show up in the configuration of the switch itself.  To validate the access port has a maximum value of one for allowable MAC addresses, you must run the following command: 

Switch# show port-security interface 

Show Command Example:
Switch# port int fa0/1
Port Security                :Enabled
Port Status                  :Secure-down
Violation Mode               :Shutdown
Aging Time                   :0 mins
Aging Type                   :Absolute
SecureStatic Address Aging   :Disabled
Maximum MAC Addresses        :1

Some technologies are exempt from requiring a single MAC address per access port; however, restrictions still apply.  VoIP or VTC endpoints may provide a PC port so a PC can be connected.  Each of the devices will need to be statically assigned to each access port.

Another green initiative where a single LAN drop is shared among several devices is called "hot-desking", which is related to conservation of office space and teleworking. Hot-desking is where several people are assigned to work at the same desk at different times, each user with their own PC.  In this case, a different MAC address needs to be permitted for each PC that is connecting to the LAN drop in the workspace. Additionally, this workspace could contain a single phone (and possibly desktop VTC endpoint) used by all assignees and the PC port on it might be the connection for their laptop.  In this case, it is best not to use sticky port security, but to use a static mapping of authorized devices or implement 802.1x. If this is not a teleworking remote location, this exemption does not apply.</check-content></check></Rule></Group><Group id="V-18790"><title>NET-TUNL-012</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-20504r2_rule" severity="medium" weight="10.0"><version>NET-TUNL-012</version><title>Default routes must not be directed to the tunnel entry point.</title><description>&lt;VulnDiscussion&gt;Routing in the network containing the tunnel entry point must be configured to direct the intended traffic into the tunnel.  Depending on the router products used this may be done by creating routes to a tunnel by name, by address, or by interface.  

If multiple tunnels are defined or IPv6 interfaces, you must be selective with static routes, policy based routing, or even let the interior gateway protocol (IGP) make the decision since a ipv4 or ipv6 address has been configured on the tunnel. The key is the administrator should carefully plan and configure or let the IGP determine what goes into each tunnel.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-19446r1_fix">The SA must carefully plan and configure or let IGP determine what goes into each tunnel.
</fixtext><fix id="F-19446r1_fix" /><check system="C-22501r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Identify the tunnel endpoints, then review all routing devices to ensure the tunnel entry point is not used as a default route.

Traffic destined to the tunnel should be directed to the tunnel endpoint by static routes, policy based routing, or by the mechanics of the interior routing protocol, but not by default route statements.</check-content></check></Rule></Group><Group id="V-19188"><title>Control plane protection is not enabled.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-21167r2_rule" severity="medium" weight="10.0"><version>NET0966</version><title>The router must have control plane protection enabled. </title><description>&lt;VulnDiscussion&gt;The Route Processor (RP) is critical to all network operations as it is the component used to build all forwarding paths for the data plane via control plane processes. It is also instrumental with ongoing network management functions that keep the routers and links available for providing network services. Hence, any disruption to the RP or the control and management planes can result in mission critical network outages. 

In addition to control plane and management plane traffic that is in the router’s receive path, the RP must also handle other traffic that must be punted to the RP—that is, the traffic must be fast or process switched. This is the result of packets that must be fragmented, require an ICMP response (TTL expiration, unreachable, etc.) have IP options, etc. A DoS attack targeting the RP can be perpetrated either inadvertently or maliciously involving high rates of punted traffic resulting in excessive RP CPU and memory utilization. To maintain network stability, the router must be able to securely handle specific control plane and management plane traffic that is destined to it, as well as other punted traffic. 

Using the ingress filter on forwarding interfaces is a method that has been used in the past to filter both forwarding path and receiving path traffic. However, this method does not scale well as the number of interfaces grows and the size of the ingress filters grow. Control plane policing can be used to increase security of routers and multilayer switches by protecting the RP from unnecessary or malicious traffic. Filtering and rate limiting the traffic flow of control plane packets can be implemented to protect routers against reconnaissance and DoS attacks allowing the control plane to maintain packet forwarding and protocol states despite an attack or heavy load on the router or multilayer switch.

&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;System Administrator&lt;/Responsibility&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-19812r1_fix">Implement control plane protection by classifying traffic types based on importance levels and configure filters to restrict and rate limit the traffic punted to the route processor as according to each class.</fixtext><fix id="F-19812r1_fix" /><check system="C-23285r3_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Control Plane Policing (CoPP)

If supported by the router, CoPP should be used to increase security on Cisco routers by protecting the RP from unnecessary and malicious traffic. CoPP allows network operators to classify traffic based on importance that then enables the router to filter and rate limit the traffic according to the defined policy for each class.

Step 1: Verify traffic types have been classified based on importance levels. The following is an example configuration:

class-map match-all CoPP_CRITICAL
 match access-group name CoPP_CRITICAL
class-map match-any CoPP_IMPORTANT
 match access-group name CoPP_IMPORTANT
 match protocol arp
class-map match-all CoPP_NORMAL
 match access-group name CoPP_NORMAL
class-map match-any CoPP_UNDESIRABLE
 match access-group name CoPP_UNDESIRABLE
class-map match-all CoPP_DEFAULT
 match access-group name CoPP_DEFAULT

Step 2: Review the ACLs referenced by the match access-group commands to determine if the traffic is being classified appropriately. The following is an example configuration:

ip access-list extended CoPP_CRITICAL
 remark our control plane adjacencies are critical
 permit ospf host [OSPF neighbor A] any
 permit ospf host [OSPF neighbor B] any
 permit pim host [PIM neighbor A] any
 permit pim host [PIM neighbor B] any
 permit pim host [RP addr] any
 permit igmp any 224.0.0.0 15.255.255.255
 permit tcp host [BGP neighbor] eq bgp host [local BGP addr]
 permit tcp host [BGP neighbor] host [local BGP addr] eq bgp
 deny ip any any

ip access-list extended CoPP_IMPORTANT
 permit tcp host [TACACS server] eq tacacs any
 permit tcp [management subnet] 0.0.0.255 any eq 22
 permit udp host [SNMP manager] any eq snmp
 permit udp host [NTP server] eq ntp any
 deny ip any any

ip access-list extended CoPP_NORMAL
 remark we will want to rate limit ICMP traffic
 permit icmp any any echo
 permit icmp any any echo-reply
 permit icmp any any time-exceeded
 permit icmp any any unreachable
 deny ip any any

ip access-list extended CoPP_UNDESIRABLE
 remark other management plane traffic that should not be received
 permit udp any any eq ntp
 permit udp any any eq snmptrap
 permit tcp any any eq 22
 permit tcp any any eq 23
 remark other control plane traffic not configured on router
 permit eigrp any any
 permit udp any any eq rip
 deny ip any any

ip access-list extended CoPP_DEFAULT
 permit ip any any


Note: Explicitly defining undesirable traffic with ACL entries enables the network operator to collect statistics. Excessive ARP packets can potentially monopolize Route Processor resources, starving other important processes. Currently, ARP is the only Layer 2 protocol that can be specifically classified using the match protocol command. 

Step 3: Review the policy-map to determine if the traffic is being policed appropriately for each classification. The following is an example configuration:


policy-map CONTROL_PLANE_POLICY
 class CoPP_CRITICAL
police 512000 8000 conform-action transmit exceed-action transmit
class CoPP_IMPORTANT
 police 256000 4000 conform-action transmit exceed-action drop
class CoPP_NORMAL
 police 128000 2000 conform-action transmit exceed-action drop
class CoPP_UNDESIRABLE
 police 8000 1000 conform-action drop exceed-action drop
class cp-default-in
 police 64000 1000 conform-action transmit exceed-action drop


Step 4: Verify that the CoPP policy is enabled. The following is an example configuration:

control-plane
 service-policy input CONTROL_PLANE_POLICY


Note: Starting with IOS release 12.4(4)T, Control Plane Protection (CPPr) can be used to filter as well as police control plane traffic destined to the RP. CPPr is very similar to CoPP and has the ability to filter and police traffic using finer granularity by dividing the aggregate control plane into three separate categories: (1) host, (2) transit, and (3) CEF-exception. Hence, a separate policy-map could be configured for each traffic category.


If CoPP is not supported, then the alternative would be the implementation of a receive path filter.

Step 1: A receive path ACL or an inbound ACL on each interface must be configured to restrict traffic destined to the router. The IOS IP Receive ACL feature provides filtering capability explicitly for traffic that is destined for the router. Verify that the global ip receive acl statement has been configured as shown in the following example:

ip receive acl 199

Note: If the platform does not support the ip receive path acl feature, an inbound ACL on each interface must be configured.

Step 2: Verify that the ACL referenced by the ip receive acl statement restricts all control plane and management plane traffic. The ACL configuration should look similar to the following: 

access-list 199 deny ip any any fragments
access-list 199 remark allow specific management plane traffic
access-list 199 permit tcp [management subnet] 0.0.0.255 any eq 22
access-list 199 permit udp host [SNMP manager] any eq snmp
access-list 199 permit tcp host [TACACS server] eq tacacs any
access-list 199 permit udp host [NTP server] eq ntp any
access-list 199 permit icmp [management subnet] 0.0.0.255 any 
access-list 199 remark allow specific control plane traffic
access-list 199 permit ospf host [OSPF neighbor A] any
access-list 199 permit ospf host [OSPF neighbor B] any
access-list 199 permit pim host [PIM neighbor A] any
access-list 199 permit pim host [PIM neighbor B] any
access-list 199 permit pim host [RP addr] any
access-list 199 permit igmp any 224.0.0.0 15.255.255.255
access-list 199 permit tcp host [BGP neighbor] eq bgp host [local BGP addr]
access-list 199 permit tcp host [BGP neighbor] host [local BGP addr] eq bgp
access-list 199 remark all other traffic destined to the device is dropped
access-list 199 deny ip any any


Note: If the Management Plane Protection (MPP) feature is enabled for an OOBM interface, there would be no purpose in filtering this traffic on the receive path. With MPP enabled, no interfaces except the management interface will accept network management traffic destined to the device. This feature also provides the capability to restrict which management protocols are allowed. See NET0992 for additional configuration information.
</check-content></check></Rule></Group><Group id="V-19189"><title>No Admin-local or Site-local boundary</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-21169r1_rule" severity="low" weight="10.0"><version>NET-MCAST-010</version><title>The administrator must ensure that multicast routers are configured to establish
boundaries for Admin-local or Site-local scope multicast traffic.</title><description>&lt;VulnDiscussion&gt;A scope zone is an instance of a connected region of a given scope. Zones of the same scope cannot overlap while zones of a smaller scope will fit completely within a zone of a larger scope. For example, Admin-local scope is smaller than Site-local scope, so the administratively configured boundary fits within the bounds of a site. According to RFC 4007 IPv6 Scoped Address Architecture (section 5), scope zones are also required to be "convex from a routing perspective"-that is, packets routed within a zone must not pass through any links that are outside of the zone. This requirement forces each zone to be one contiguous island rather than a series of separate islands. As stated in the DoD IPv6 IA Guidance for MO3, "One should be able to identify all interfaces of a zone by drawing a closed loop on their network diagram, engulfing some routers and passing through some routers to include only some of their interfaces."

Administrative scoped multicast addresses are locally assigned and are to be used exclusively by the enterprise network or enclave. Hence, administrative scoped multicast traffic must not cross the perimeter of the enclave in either direction. Admin-local scope could be used to contain multicast traffic to a portion of an enclave or within a site. This can make it more difficult for a malicious user to access sensitive traffic if the traffic is restricted to links that the user does not have access to. Admin-local scope is encouraged for any multicast traffic within a network that is intended for network management as well as control plane traffic that must reach beyond link-local destinations.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;System Administrator&lt;/Responsibility&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-19813r1_fix">Local Scope range is 239.255.0.0/16 and can expand into the reserved ranges 239.254.0.0/16 and 239.253.0.0/16 if 239.255.0.0/16 is exhausted. The scope of IPv6 multicast packets are determined by the scope value where 4 is Admin-local and 5 is Site-local. Configure the necessary boundary to ensure packets addressed to these administratively scoped multicast addresses do not cross the applicable administrative boundaries.</fixtext><fix id="F-19813r1_fix" /><check system="C-23287r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>An administratively scoped IP multicast region is defined to be a topological region in which there are one or more boundary routers with common boundary definitions. Such a router is said to be a boundary for multicast scoped addresses in the range defined in its configuration. In order to support administratively scoped multicast, a multicast boundary router will drop multicast traffic matching an interface's boundary definition in either direction. 

The IPv4 administrative scoped multicast address space is 239/8 which is divided into two scope levels: the Local Scope and Organization Local Scope.  The Local Scope range is 239.255.0.0/16 and can expand into the reserved ranges 239.254.0.0/16 and 239.253.0.0/16 if 239.255.0.0/16 is exhausted. The IPv4 Organization Local Scope is 239.192.0.0/14 is the space from which an organization should allocate sub-ranges when defining scopes for private use. This scope can be expanded to 239.128.0.0/10, 239.64.0.0/10, and 239.0.0.0/10 if necessary. The scope of IPv6 multicast packets are determined by the scope value where 4 (ffx4::/16) is Admin-local, 5 (ffx5::/16) is Site-local, and 8 (ffx8::/16) is Organization-local. 

Review the multicast topology to determine any documented Admin-local (scope = 4) or Site-local (scope = 5) multicast boundaries for IPv6 traffic or any Local-scope (address block 239.255.0.0/16) boundary for IPv4 traffic. Verify that appropriate boundaries are configured on the applicable multicast-enabled interfaces.

IPv4:
The following example will establish a multicast boundary on the interface to ensure that Local-scope traffic is not allowed into or out of the administratively scoped IPv4 multicast region:

ip multicast-routing 
!
interface FastEthernet0/1
description Boundary for multicast region A 
 ip address 198.18.0.1 255.255.255.0
ip pim sparse-mode
ip multicast boundary MCAST_ADMIN_SCOPED_BOUNDARY
!
ip access-list standard MCAST_ADMIN_SCOPED_BOUNDARY
deny   239.255.0.0 0.255.255.255
permit 224.0.0.0 15.255.255.255
!

Note: The filter used by multicast boundary command will effect multicast traffic outside of the administratively scoped IPv4 multicast space. If Organization Local Scope traffic must cross this site boundary, include the necessary permit statement from this address range (239.192.0.0 255.252.0.0). To allow global multicast traffic to pass by this boundary, ensure that the filter will permit the global address space (224.0.1.0-238.255.255.255) if the enclave has deployed inter-domain multicast routing. 


IPv6:
The following example will establish a multicast boundary on the interface to ensure that Site-local scope traffic is not allowed into or out of the administratively scoped IPv6 multicast region:

ipv6 multicast-routing
!
interface FastEthernet0/1
description link to Site A 
 ipv6 address 2001:1:0:146::/64 eui-64
 ipv6 multicast boundary scope 5

Note: Filtering the scope value of 5 will ensure that any multicast traffic received by the interface in either direction with a scope equal to or less than 5 (Site-local) will be dropped.  Hence, all Site-local and Admin-local traffic will be dropped while allowing Organization-local (scope = 8) and global multicast traffic (scope =14) to be forwarded for an inter-site as well as inter-domain multicast routing deployment.
</check-content></check></Rule></Group><Group id="V-23747"><title>Two NTP servers are not used to synchronize time.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-41497r1_rule" severity="low" weight="10.0"><version>NET0812</version><title>The network element must use two or more NTP servers to synchronize time.</title><description>&lt;VulnDiscussion&gt;Without synchronized time, accurately correlating information between devices becomes difficult, if not impossible. If you cannot successfully compare logs between each of your routers, switches, and firewalls, it will be very difficult to determine the exact events that resulted in a network breach incident. NTP provides an efficient and scalable method for network elements to synchronize to an accurate time source.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;System Administrator&lt;/Responsibility&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-3044r1_fix">Specify two NTP server IP addresses on the device to be used to request time from.</fixtext><fix id="F-3044r1_fix" /><check system="C-12791r2_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Review the router or switch configuration and verify that two NTP servers have been defined to synchronize time similar to the following example:

ntp update-calendar
ntp server 129.237.32.6 
ntp server 129.237.32.7

Some platforms have a battery-powered hardware clock, referred to in the command-line interface (CLI) as the "calendar," in addition to the software based system clock. The hardware clock runs continuously, even if the router is powered off or rebooted. If the software clock is synchronized to an outside time source via NTP, it is a good practice to periodically update the hardware clock with the time learned from NTP. Otherwise, the hardware clock will tend to gradually lose or gain time (drift) and the software clock and hardware clock may become out of synchronization with each other. The ntp update-calendar command will enable the hardware clock to be periodically updated with the time specified by the NTP source. The hardware clock will be updated only if NTP has synchronized to an authoritative time server. To force a single update of the hardware clock from the software clock, use the clock update-calendar command in user EXEC mode. 

Note: Lower end router models (i.e., 2500 series) and access switches (i.e. 2950, 2970, etc) do not have hardware clocks, so this command is not available on those platforms.
Any NTP-enabled device that receives and accepts time from a stratum-n server can become a stratum-n+1 server. However, an NTP-enabled device will not accept time updates from an NTP server at a higher stratum; thereby enforcing a tree-level hierarchy of client-server relationships and preventing time synchronization loops. To increase availability, NTP peering can be used between NTP servers. Hence the following example configuration could be used to provide the necessary redundancy:

ntp update-calendar
ntp server 129.237.32.6 
ntp peer 129.237.32.7

Alternative to querying an NTP server for time is to receive NTP updates via server that is broadcasting or multicasting the time update messages. The following interface command would be configured to receive an NTP broadcast message:

ntp broadcast client 

The above command must be configured on two interfaces or there must be two NTP servers on the same LAN segment broadcasting NTP messages. 

The following interface command would be configured to receive an NTP multicast message:

ntp multicast client 239.x.x.x 

For multicast, two different administratively scoped multicast groups can be used—one for each NTP server. In addition, the router or MLS must also have ip pim dense-mode configured on the interface as well as global ip multicast-routing.
</check-content></check></Rule></Group><Group id="V-28784"><title>Call home service is disabled.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-38003r2_rule" severity="medium" weight="10.0"><version>NET0405</version><title>A service or feature that calls home to the vendor must be disabled.  
</title><description>&lt;VulnDiscussion&gt;Call home services or features will routinely send data such as configuration and diagnostic information to the vendor for routine or emergency analysis and troubleshooting.  The risk that transmission of sensitive data sent to unauthorized persons could result in data loss or downtime due to an attack.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;Responsibility&gt;Network Security Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-32568r1_fix">Configure the network device to disable the call home service or feature. 

The command below will disable the call-home service on a Cisco device.  
Example:
hostname(config)# no service call-home</fixtext><fix id="F-32568r1_fix" /><check system="C-37332r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Verify the call home service or feature is disabled on the device.  

On a Cisco product, you will not see the call-home service in the running config unless it's enabled. </check-content></check></Rule></Group><Group id="V-30577"><title>PIM enabled on wrong interfaces</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-40312r1_rule" severity="medium" weight="10.0"><version>NET-MCAST-001</version><title>The administrator must ensure that Protocol Independent Multicast (PIM) is disabled on all interfaces that are not required to support multicast routing.</title><description>&lt;VulnDiscussion&gt;A scope zone is an instance of a connected region of a given scope. Zones of the same scope cannot overlap while zones of a smaller scope will fit completely within a zone of a larger scope. For example, Admin-local scope is smaller than Site-local scope, so the administratively configured boundary fits within the bounds of a site. According to RFC 4007 IPv6 Scoped Address Architecture (section 5), scope zones are also required to be “convex from a routing perspective”—that is, packets routed within a zone must not pass through any links that are outside of the zone. This requirement forces each zone to be one contiguous island rather than a series of separate islands. As stated in the DoD IPv6 IA Guidance for MO3, “One should be able to identify all interfaces of a zone by drawing a closed loop on their network diagram, engulfing some routers and passing through some routers to include only some of their interfaces.” Hence, it is imperative that the network has documented their multicast topology and thereby knows which interfaces are enabled for multicast.  Once, this is done, the zones can be scoped as required.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;System Administrator&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-34295r1_fix">If IPv4 or IPv6 multicast routing is enabled, ensure that all interfaces enabled for PIM is documented in the network’s multicast topology diagram. Enable PIM only on the applicable interfaces according to the multicast topology diagram.</fixtext><fix id="F-34295r1_fix" /><check system="C-39164r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>If IPv4 or IPv6 multicast routing is enabled, ensure that all interfaces enabled for PIM is documented in the network’s multicast topology diagram. Review the router or multi-layer switch configuration to determine if multicast routing is enabled and what interfaces are enabled for PIM.

Step 1: Determine if multicast routing is enabled. By default, multicast is disabled globally. The following global configuration commands will enable IPv4 and IPv6 multicast routing:

ip multicast-routing

ipv6 multicast-routing

Step 2:  PIM is enabled on an interface with either of the following commands: ip pim sparse-mode, ip pim dense-mode, ip pim sparse-dense-mode. Review all interface configurations and verify that only the required interfaces are enabled for PIM as documented in the network topology diagram. 

With IPv4, PIM is disabled by default on all interfaces. Following is an example of an interface with PIM enabled.

interface FastEthernet0/0
 ip address 192.168.1.1 255.255.255.0
 ip pim sparse-mode

You can also verify what IPv4 interfaces are enabled for PIM with the show ip pim interface command.

With IPv6, PIM is enabled by default on all IPv6-enabled interfaces if IPv6 multicast routing is enabled on the router via the global ipv6 multicast-routing command. An interface can be disabled for PIM using the no ipv6 pim interface command.

interface FastEthernet0/1
 ipv6 address 2001:1:0:146::/64 eui-64
 no ipv6 pim

You can also verify what ipv6 interfaces are enabled for PIM with the show ipv6 pim interface command.
</check-content></check></Rule></Group><Group id="V-30578"><title>PIM neighbor filter is not configured</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-40315r1_rule" severity="medium" weight="10.0"><version>NET-MCAST-002</version><title>The administrator must ensure that a PIM neighbor filter is bound to all interfaces that have PIM enabled.</title><description>&lt;VulnDiscussion&gt;Protocol Independent Multicast (PIM) is a routing protocol used to build multicast distribution tress for forwarding multicast traffic across the network infrastructure. PIM traffic must be limited to only known PIM neighbors by configuring and binding a PIM neighbor filter to those interfaces that have PIM enabled.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-34301r1_fix">If IPv4 or IPv6 multicast routing is enabled, ensure that all interfaces enabled for PIM has a neighbor filter to only accept PIM control plane traffic from the documented routers according to the multicast topology diagram.</fixtext><fix id="F-34301r1_fix" /><check system="C-39168r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Review the router or multi-layer switch to determine if either IPv4 or IPv6 multicast routing is enabled. If either is enabled, verify that all interfaces enabled for PIM has a neighbor filter to only accept PIM control plane traffic from the documented routers according to the multicast topology diagram.

IPv4

Step 1: Verify that an ACL is configured that will specify the allowable PIM neighbors similar to the
following example:

ip access-list standard PIM_NEIGHBORS
 permit 192.0.2.1
 permit 192.0.2.3
 deny any log


Step 2: Verify that a pim neighbor-filter command is configured on all PIM-enabled interfaces that is
referencing the PIM neighbor ACL similar to the following example:

interface FastEthernet0/3
 ip address 192.0.2.2 255.255.255.0
 ip pim sparse-mode
 ip pim neighbor-filter PIM_NEIGHBORS


IPv6

Step 1: Verify that an ACL is configured that will specify the allowable PIM neighbors similar to the
following example:

ipv6 access-list PIM_NEIGHBORS
 permit host FE80::1 any
 permit host FE80::3 any
deny any any log

Note: IPv6 PIM adjacenencies are created using the router unicast link-local addresses 

Step 2: Verify that a pim neighbor-filter global command is configured

ipv6 pim neighbor-filter list PIM_NEIGHBORS
</check-content></check></Rule></Group><Group id="V-30585"><title>Invalid group used for source specific multicast  </title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-40326r1_rule" severity="low" weight="10.0"><version>NET-MCAST-020 </version><title>The administrator must ensure that multicast groups used for source specific multicast (SSM) routing are from the specific multicast address space reserved for this purpose.</title><description>&lt;VulnDiscussion&gt;Packet origin is a concern because unauthorized sources could potentially send multicast data to a group, using any source address that is permitted. The unauthorized data could impact the integrity of the nodes receiving the data or could create a DoS condition. A receiver that subscribes to an SSM channel only receives data from the requested source. Since a channel is specific to a source, only that source can transmit on that channel. Hence, the SSM model provides more packet origin protection than ASM. To ensure that the subscriber is joining an authorized or known multicast group and source address pair, it is imperative that the group is from the reserved multicast address space as a first step measure.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-34303r1_fix">If IGMP version 3 or MLD version 2 is enabled for IPv4 and IPv6 multicast respectively, then PIM-SSM is also enabled. Hence, you must configure the router so that only the IANA reserved SSM range of addresses can be used for this implementation. The SSM address range is  232.0.0.0/8 and FF3x::/32 for IPv4 and IPv6 respectively.</fixtext><fix id="F-34303r1_fix" /><check system="C-39204r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>IANA has reserved the address range 232.0.0.0 through 232.255.255.255 for SSM applications and protocols. However, Cisco IOS allows SSM configuration for an arbitrary subset of the IP multicast address range 224.0.0.0 through 239.255.255.255.

If IPv4 or IPv6 multicast routing is enabled, determine if gimp version 3 or MLD version 2 is enabled for IPv4 and IPv6 respectively.  If enabled, then PIM-SSM is also enabled. Hence, you must verify that only the IANA reserved SSM range of addresses is used for this implementation. The SSM address range is 232.0.0.0/8 and FF3x::/32 for IPv4 and IPv6 respectively.

Step 1: Determine if multicast routing is enabled. By default, multicast is disabled globally. The following global configuration commands will enable IPv4 and IPv6 multicast routing:

ip multicast-routing

ipv6 multicast-routing

If multicast routing is not enabled, this vulnerability is not applicable.

Step 2: 

IPv4

Check interface connected to multicast subscribers to determine if IGMPv3 is enabled. This is required for subscribers to join a specific source. The following ipv4 interface configuration would look as follows:

ip igmp version 3  
or 
ip igmp v3lite 

If IGMPv3 is not enabled for IPv4 multicast, this vulnerability is not applicable.

IPv6

MLD is automatically enabled on an interface when IPv6 PIM is enabled on an interface. With IPv6, PIM is enabled by default on all IPv6-enabled interfaces if IPv6 multicast routing is enabled on the router via the global ipv6 multicast-routing command. An interface can be disabled for PIM using the no ipv6 pim interface command. MLD can also be disabled on IPv6 PIM-enabled interfaces with the no ipv6 mld router interface command.

Following is an example of two IPv6-enabled interfaces.

interface FastEthernet0/1
ipv6 address 2001:1:0:146::/64 eui-64

interface FastEthernet0/2
 ipv6 enable

MLDv2 is the default with current releases of IOS. In some releases of IOS, the ipv6 mld version command is not available. You can verify the version of MLD interfaces via show ipv6 mld interface command.  If MLDv2 is not enabled for IPv6 multicast, this vulnerability is not applicable.

Step 3:

Verify that the appropriate multicast groups are used for SSM.

IPv4 

The following configuration will allow all of the multicast groups 232/8 reserved for SSM:

ip pim ssm default

or

The following configuration will only allow multicast groups 232.4.0.0/24

access-list 4 permit 232.4.0.0 0.0.0.255
ip pim ssm range 4 

Note: If a range is configured as in the example shown above, ensure that the range is within the IANA reserved range for SSM groups.


IPv6

The following configuration will allow all of the multicast groups FF3x::/32 reserved for SSM where x is any valid scope value:

ipv6 pim ssm default

or

The following configuration will only allow multicast groups with the ff3e::1:0:0/96 range:

ipv6 access-list SSM_RANGE permit  any ff3e::1:0:0/96
ipv6 pim ssm range SSM_RANGE
</check-content></check></Rule></Group><Group id="V-30617"><title>Maximum hop limit is less than 32</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-40389r1_rule" severity="low" weight="10.0"><version>NET-IPV6-059</version><title>The administrator must ensure that the maximum hop limit is at least 32.</title><description>&lt;VulnDiscussion&gt;The Neighbor Discovery protocol allows a hop limit value to be advertised by routers in a Router Advertisement message to be used by hosts instead of the standardized default value. If a very small value was configured and advertised to hosts on the LAN segment, communications would fail due to hop limit reaching zero before the packets sent by a host reached its destination.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-34363r1_fix">If the maximum hop limit is configured, it must be set to at least 32.</fixtext><fix id="F-34363r1_fix" /><check system="C-39253r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>The maximum number of hops used in router advertisements and all IPv6 packets that are originated by the router can be set using the ipv6 hop-limit command in global configuration mode.  Review the router or multi-layer switch configuration to determine if the maximum hop limit has been configured. If it has been configured, then it must be set to at least 32. 

The following global command sets the max hop limit to 128: ipv6 hop-limit 128 

Note: The IOS default is 64. Hence, if the hop limit is not configured, the router will be in compliance with the requirement.
</check-content></check></Rule></Group><Group id="V-30660"><title>The 6-to-4 router is not filtering protocol 41</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-40454r1_rule" severity="medium" weight="10.0"><version>NET-IPV6-065</version><title>The administrator must ensure the 6-to-4 router is configured to drop any IPv4 packets with protocol 41 received from the internal network. </title><description>&lt;VulnDiscussion&gt;The 6to4 specific filters accomplish the role of endpoint verification and provide assurance that the tunnels are being used properly. This primary guidance assumes that only the designated 6to4 router is allowed to form tunnel packets. If they are being formed inside an enclave and passed to the 6to4 router, they are suspicious and must be dropped. In accordance with DoD IPv6 IA Guidance for MO3 (S5-C7-8), packets as such must be dropped and logged as a security event.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-34388r1_fix">If the router is functioning as a 6to4 router, configure an egress filter (inbound on the internal-facing interface) to drop any outbound IPv4 packets that are tunneling IPv6 packets.</fixtext><fix id="F-34388r1_fix" /><check system="C-39284r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>If the router is functioning as a 6to4 router, verify that there is an egress filter (inbound on the internal-facing interface) to drop any outbound IPv4 packets that are tunneling IPv6 packets.

Step 1: Determine if the router is functioning as a 6to4 router. You should find a tunnel configuration similar to the following example:

interface Tunnel0
 no ip address
 no ip redirects
 ipv6 address 2000:C0A8:6301::1/64
 tunnel source FastEthernet0/1
 tunnel mode ipv6ip 6to4
!
…
ipv6 route 2002::/16 Tunnel0

Step 2: Verify that there is an egress filter (inbound on the internal-facing interface) to drop any outbound IPv4 packets that are tunneling IPv6 packets. You should find a configuration similar to the following example:

interface FastEthernet0/1
 description internal link
 ip address 192.168.1.1 255.255.255.0
 ipv6 address 6TO4PREFIX ::1:0:0:0:1/64
 ip access-group IPV4_EGRESS_FILTER in
!
ip access-list extended IPV4_EGRESS_FILTER
remark only this 6to4 router can tunnel IPv6 traffic
deny  41 any any log
…
…

Note: normally you would want to configure the internal interface for a 6to4 router as dual stack. However IPv6 only is possible and if configured as such, having an IPv4 ACL is irrelevant since the interface will not accept any IPv4 packets.

</check-content></check></Rule></Group><Group id="V-30736"><title>6-to-4 router not filtering invalid source address</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-40539r1_rule" severity="low" weight="10.0"><version>NET-IPV6-066</version><title>The administrator must ensure the 6-to-4 router is configured to drop any outbound IPv6 packets from the internal network with a source address that is not within the 6to4 prefix 2002:V4ADDR::/48 where V4ADDR is the designated IPv4 6to4 address for the enclave.</title><description>&lt;VulnDiscussion&gt;An automatic 6to4 tunnel allows isolated IPv6 domains to be connected over an IPv4 network and allows connections to remote IPv6 networks. The key difference between this deployment and manually configured tunnels is that the routers are not configured in pairs and thus do not require manual configuration because they treat the IPv4 infrastructure as a virtual non-broadcast link, using an IPv4 address embedded in the IPv6 address to find the remote end of the tunnel. In other words, the tunnel destination is determined by the IPv4 address of the external interface of the 6to4 router that is concatenated to the 2002::/16 prefix in the format 2002: V4ADDR::/48.  Hence, the imbedded V4ADDR of the 6to4 prefix must belong to the same ipv4 prefix as configured on the external-facing interface of the 6to4 router. &lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-34421r1_fix">If the router is functioning as a 6to4 router, configure an egress filter (inbound on the internal-facing interface) to drop any outbound IPv6 packets from the internal network with a source address that is not within the 6to4 prefix 2002:V4ADDR::/48 where V4ADDR is the designated IPv4 6to4 address for the enclave.</fixtext><fix id="F-34421r1_fix" /><check system="C-39311r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>If the router is functioning as a 6to4 router, verify that an egress filter (inbound on the internal-facing interface) has been configured to drop any outbound IPv6 packets from the internal network with a source address that is not within the 6to4 prefix 2002:V4ADDR::/48 where V4ADDR is the designated IPv4 6to4 address for the enclave.

The examples below are using 2002:c612:1::/48 where c612:1 maps to 198.18.0.1 which is the imbedded V4ADDR. The subnet in this example is 2002:c612:1:1::/64. The IPV6 ACL will filter the source address of the IPv6 packets before they are forwarded to the 6to4 tunnel.


ipv6 general-prefix 6TO4_PREFIX 6to4 FastEthernet0/1
!
interface Tunnel0
 ipv6 address 2000:c0a8:6301::1/64 
 tunnel source FastEthernet0/0
 tunnel mode ipv6ip 6to4
!
interface FastEthernet0/0
 ip address 10.1.12.1 255.255.255.0
 ipv6 address 6TO4_PREFIX ::1:0:0:0:1/64
 ipv6 traffic-filter IPV6_EGRESS_FILTER in
!
interface FastEthernet0/1
 description DISN CORE facing 
 ip address 198.18.0.1 255.255.255.0
!
 ipv6 route 2002::/16 Tunnel0
!
ipv6 access-list IPV6_EGRESS_FILTER
permit ipv6 2002:C612:1::/48 any
deny ipv6 any any log

Note: normally  you would want to configure the internal interface dual stack, allthough IPv6 only is possible.
</check-content></check></Rule></Group><Group id="V-30744"><title>L2TPv3 sessions are not authenticated</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-40556r1_rule" severity="medium" weight="10.0"><version>NET-TUNL-034</version><title>The administrator must ensure the that all L2TPv3 sessions are authenticated prior to transporting traffic.</title><description>&lt;VulnDiscussion&gt;L2TPv3 sessions can be used to transport layer-2 protocols across an IP backbone. These protocols were intended for link-local scope only and are therefore less defended and not as well-known. As stated in DoD IPv6 IA Guidance for MO3 (S4-C7-1), the L2TP tunnels can also carry IP packets that are very difficult to filter because of the additional encapsulation. Hence, it is imperative that L2TP sessions are authenticated prior to transporting traffic.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-34428r1_fix">Configure L2TPv3 to use authentication for any peering sessions.</fixtext><fix id="F-34428r1_fix" /><check system="C-39321r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Review the router or multi-layer switch configuration and determine if L2TPv3 has been configured to provide transport across an IP network. If it has been configured, verify that the L2TPv3 session requires authentication.

Step 1: Determine if an L2TPv3 pseudowire is configured on an interface which will look similar to the following configuration:

pseudowire-class L2TPV3
encapsulation l2tpv3
ip local interface Loopback0
!
interface Loopback0
ip address 1.1.1.1 255.255.255.255
!
interface FastEthernet0/0
xconnect 5.5.5.5  1 encapsulation l2tpv3 pw-class L2TPV3

If you do not see a configuration similar to the one above, then this vulnerability is not applicable. Otherwise, proceed to step 2.

Step2: Verify that the l2tp-class global command has been configured with authentication as shown in the following example.

l2tp-class L2TP_CLASS
 authentication
 password 7 011E1F145A1815182E5E4A

Note: If a password is not configured in the l2tp-class command the password associated with the remote peer router is taken from the value entered with the global username hostname password value.

Note: Layer 2 Forwarding or L2F (RFC2341), which is the "version 1",  and L2TPv2 (RFC 2661) are used for remote access services based on the Virtual Private Dial-up Network (VPDN) model—not for tunneling IP packets across a backbone as with L2TPv3. With the VPDN model, a user obtains a layer-2 connection to a RAS using dialup PSTN or ISDN service and then establishes a PPP session over that connection. The L2 termination and PPP session endpoints reside on the RAS. L2TP extends the PPP model by allowing the L2 and PPP endpoints to reside on different devices that are interconnected by a backbone network. A remote access client has an L2 connection to an L2TP Access Concentrator (LAC) that tunnels PPP frames across the IP backbone to the L2TP Network Server (LNS) residing in the private network.

</check-content></check></Rule></Group><Group id="V-31285"><title>BGP must authenticate all peers.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-41555r2_rule" severity="medium" weight="10.0"><version>NET0408</version><title>The network element must authenticate all BGP peers within the same or between autonomous systems (AS).</title><description>&lt;VulnDiscussion&gt;As specified in RFC 793, TCP utilizes sequence checking to ensure proper ordering of received packets. RFC 793 also specifies that RST (reset) control flags should be processed immediately, without waiting for out of sequence packets to arrive. RFC 793 also requires that sequence numbers are checked against the window size before accepting data or control flags as valid. A router receiving an RST segment will close the TCP session with the BGP peer that is being spoofed; thereby, purging all routes learned from that BGP neighbor. A RST segment is valid as long as the sequence number is within the window. The TCP reset attack is made possible due to the requirements that Reset flags should be processed immediately and that a TCP endpoint must accept out of order packets that are within the range of a window size. This reduces the number of sequence number guesses the attack must make by a factor equivalent to the active window size. Each sequence number guess made by the attacker can be simply incremented by the receiving connections window size. The BGP peering session can protect itself against such an attack by authenticating each TCP segment. The TCP header options include an MD5 signature in every packet and are checked prior to the acceptance and processing of any TCP packet—including RST flags.

One way to create havoc in a network is to advertise bogus routes to a network. A rogue router could send a fictitious routing update to convince a BGP router to send traffic to an incorrect or rogue destination. This diverted traffic could be analyzed to learn confidential information of the site’s network, or merely used to disrupt the network’s ability to effectively communicate with other networks. An autonomous system can advertise incorrect information by sending BGP updates messages to routers in a neighboring AS. A malicious AS can advertise a prefix originated from another AS and claim that it is the originator (prefix hijacking). Neighboring autonomous systems receiving this announcement will believe that the malicious AS is the prefix owner and route packets to it.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>VMS Target Layer 3 Switch</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>VMS Target</dc:type><dc:subject>Layer 3 Switch</dc:subject><dc:identifier>513</dc:identifier></reference><fixtext fixref="F-14123r1_fix">The administrator must configure the router to authenticate all BGP peers.</fixtext><fix id="F-14123r1_fix" /><check system="C-40049r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_Network - Infrastructure Layer 3 Switch - Cisco.xml" /><check-content>Review the router configuration to determine if authentication is being used for all peers. A password should be defined for each BGP neighbor regardless of the autonomous system the peer belongs as shown in the following example:

outer bgp 100
neighbor external-peers peer-group
neighbor 171.69.232.90 remote-as 200
neighbor 171.69.232.90 peer-group external-peers
neighbor 171.69.232.100 remote-as 300
neighbor 171.69.232.100 peer-group external-peers
neighbor 171.69.232.90 password xxxxxxxxxx
neighbor 171.69.232.100 password xxxxxxxxxx</check-content></check></Rule></Group></Benchmark>