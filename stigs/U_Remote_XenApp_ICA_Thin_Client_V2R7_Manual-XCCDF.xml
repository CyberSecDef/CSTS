<?xml version="1.0" encoding="utf-8"?><?xml-stylesheet type='text/xsl' href='STIG_unclass.xsl'?><Benchmark xmlns:dsig="http://www.w3.org/2000/09/xmldsig#" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" id="SRC_-_Remote_XenApp_ICA_Thin_Client" xml:lang="en" xsi:schemaLocation="http://checklists.nist.gov/xccdf/1.1 http://nvd.nist.gov/schema/xccdf-1.1.4.xsd http://cpe.mitre.org/dictionary/2.0 http://cpe.mitre.org/files/cpe-dictionary_2.1.xsd" xmlns="http://checklists.nist.gov/xccdf/1.1"><status date="2012-01-10">accepted</status><title>Remote XenApp, ICA, and Thin Client STIG</title><notice id="terms-of-use" xml:lang="en"></notice><reference href="http://iase.disa.mil"><dc:publisher>DISA, Field Security Operations</dc:publisher><dc:source>STIG.DOD.MIL</dc:source></reference><plain-text id="release-info">Release: 7 Benchmark Date: 27 Jul 2012</plain-text><version>2</version><Profile id="MAC-1_Public"><title>I - Mission Critical Public</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-21745" selected="true" /><select idref="V-21746" selected="true" /><select idref="V-21751" selected="true" /><select idref="V-21753" selected="true" /><select idref="V-21757" selected="true" /><select idref="V-21758" selected="true" /><select idref="V-21761" selected="true" /><select idref="V-21762" selected="true" /><select idref="V-21763" selected="true" /><select idref="V-21764" selected="true" /><select idref="V-21765" selected="true" /></Profile><Profile id="MAC-1_Sensitive"><title>I - Mission Critical Sensitive</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-21745" selected="true" /><select idref="V-21746" selected="true" /><select idref="V-21751" selected="true" /><select idref="V-21753" selected="true" /><select idref="V-21757" selected="true" /><select idref="V-21758" selected="true" /><select idref="V-21761" selected="true" /><select idref="V-21762" selected="true" /><select idref="V-21763" selected="true" /><select idref="V-21764" selected="true" /><select idref="V-21765" selected="true" /></Profile><Profile id="MAC-1_Classified"><title>I - Mission Critical Classified</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-21745" selected="true" /><select idref="V-21746" selected="true" /><select idref="V-21751" selected="true" /><select idref="V-21753" selected="true" /><select idref="V-21757" selected="true" /><select idref="V-21758" selected="true" /><select idref="V-21761" selected="true" /><select idref="V-21762" selected="true" /><select idref="V-21763" selected="true" /><select idref="V-21764" selected="true" /><select idref="V-21765" selected="true" /></Profile><Profile id="MAC-2_Public"><title>II - Mission Support Public</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-21745" selected="true" /><select idref="V-21746" selected="true" /><select idref="V-21751" selected="true" /><select idref="V-21753" selected="true" /><select idref="V-21757" selected="true" /><select idref="V-21758" selected="true" /><select idref="V-21761" selected="true" /><select idref="V-21762" selected="true" /><select idref="V-21763" selected="true" /><select idref="V-21764" selected="true" /><select idref="V-21765" selected="true" /></Profile><Profile id="MAC-2_Sensitive"><title>II - Mission Support Sensitive</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-21745" selected="true" /><select idref="V-21746" selected="true" /><select idref="V-21751" selected="true" /><select idref="V-21753" selected="true" /><select idref="V-21757" selected="true" /><select idref="V-21758" selected="true" /><select idref="V-21761" selected="true" /><select idref="V-21762" selected="true" /><select idref="V-21763" selected="true" /><select idref="V-21764" selected="true" /><select idref="V-21765" selected="true" /></Profile><Profile id="MAC-2_Classified"><title>II - Mission Support Classified</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-21745" selected="true" /><select idref="V-21746" selected="true" /><select idref="V-21751" selected="true" /><select idref="V-21753" selected="true" /><select idref="V-21757" selected="true" /><select idref="V-21758" selected="true" /><select idref="V-21761" selected="true" /><select idref="V-21762" selected="true" /><select idref="V-21763" selected="true" /><select idref="V-21764" selected="true" /><select idref="V-21765" selected="true" /></Profile><Profile id="MAC-3_Public"><title>III - Administrative Public</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-21745" selected="true" /><select idref="V-21746" selected="true" /><select idref="V-21751" selected="true" /><select idref="V-21753" selected="true" /><select idref="V-21757" selected="true" /><select idref="V-21758" selected="true" /><select idref="V-21761" selected="true" /><select idref="V-21762" selected="true" /><select idref="V-21763" selected="true" /><select idref="V-21764" selected="true" /><select idref="V-21765" selected="true" /></Profile><Profile id="MAC-3_Sensitive"><title>III - Administrative Sensitive</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-21745" selected="true" /><select idref="V-21746" selected="true" /><select idref="V-21751" selected="true" /><select idref="V-21753" selected="true" /><select idref="V-21757" selected="true" /><select idref="V-21758" selected="true" /><select idref="V-21761" selected="true" /><select idref="V-21762" selected="true" /><select idref="V-21763" selected="true" /><select idref="V-21764" selected="true" /><select idref="V-21765" selected="true" /></Profile><Profile id="MAC-3_Classified"><title>III - Administrative Classified</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-21745" selected="true" /><select idref="V-21746" selected="true" /><select idref="V-21751" selected="true" /><select idref="V-21753" selected="true" /><select idref="V-21757" selected="true" /><select idref="V-21758" selected="true" /><select idref="V-21761" selected="true" /><select idref="V-21762" selected="true" /><select idref="V-21763" selected="true" /><select idref="V-21764" selected="true" /><select idref="V-21765" selected="true" /></Profile><Group id="V-21745"><title>SRC-CTX-080 FQDN of the XenApp Servers</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-24276r3_rule" severity="medium" weight="10.0"><version>SRC-CTX-080</version><title>Configure all Program Neighborhood clients with specific FQDN of the XenApp servers in the
Address List.</title><description>&lt;VulnDiscussion&gt;By default no servers or IP addresses are specified in the Address List box of the client. A primary
requirement for the use of TLS/SSL from the Citrix Program Neighborhood client is that users must
connect using the Fully Qualified Domain Name (FQDN) of the XenApp server. This FQDN must
exactly match the name on the XenApp server’s TLS/SSL certificate. Restricting clients to using
only the FQDN ensures that the server farm is not vulnerable to a man-in-the-middle attack,
whereby a malicious attacker could attempt to route users to a duplicate XenApp server and steal
their passwords.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><fixtext fixref="F-22537r2_fix">Configure all Program Neighborhood clients with specific FQDN of the XenApp servers in the
Address List.</fixtext><fix id="F-22537r2_fix" /><check system="C-26006r2_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_SRC - Remote XenApp_ICA_Thin_Client.xml" /><check-content>Access the Full Program Neighborhood client on the workstation and perform the following:
1. Select Start &gt; Citrix &gt; Citrix Access Clients &gt; Program Neighborhood
2. Right Click on the selected application (s).
3. Under the Address List, verify that Fully Qualified Domain Names listed match the certificates of
the XenApp servers within the enclave. If they are not listed, this is a finding.</check-content></check></Rule></Group><Group id="V-21746"><title>SRC-CTX-090 Client drive mappings</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-24279r2_rule" severity="high" weight="10.0"><version>SRC-CTX-090</version><title>Disable Client drive mappings on all Program Neighborhood clients.</title><description>&lt;VulnDiscussion&gt;Client drive mappings are built into the standard device redirection facilities of the Citrix XenApp
Server. The client drives appear as client network objects in Windows. The client’s disk drives are
displayed as shared folders with mapped drive letters. These drives can be used by Windows
Explorer and other applications like any other network drive. Client drive mappings pose a security
risk because they allow the client to read and write from their local drives files to the XenApp server.
This allows users to transfer rogue files onto the server that could contain malware or malicious
code. Transferring files from client devices to the XenApp server may use up disk space or infect
the server with a virus that could affect the availability and integrity of the XenApp server.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><fixtext fixref="F-22539r2_fix">Disable Client drive mappings on all Program Neighborhood clients.</fixtext><fix id="F-22539r2_fix" /><check system="C-26007r2_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_SRC - Remote XenApp_ICA_Thin_Client.xml" /><check-content>There are two ways to verify that client drive mappings are disabled. Each is listed below. Access
the XenApp server and perform the following:

Method 1
1. Select Start &gt; Administrative Tools &gt; Terminal Services Configuration &gt; ICA-tcp
2. Select the Client Settings tab and verify that “Connect client drives at logon” is not checked. If it is, this is a finding.
Method 2
1. Access the Local Computer Policy and Import the Citrix Presentation Server Client template (icaclient.adm).
2. Navigate to the Computer Configuration &gt; Administrative Templates &gt; Citrix Components &gt; Presentation Server Client &gt; Remoting client devices
3. Verify that “Client drive mapping” is set to Disabled. If not, this is a finding.</check-content></check></Rule></Group><Group id="V-21751"><title>SRC-CTX-100 Clipboard mapping</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-24286r1_rule" severity="high" weight="10.0"><version>SRC-CTX-100</version><title>Disable Clipboard mapping on all Program Neighborhood clients.</title><description>&lt;VulnDiscussion&gt;The clipboard mapping allows the XenApp server to copy or paste from its clipboard to the
client machine. The clipboard mapping allows any type of data to be written to the client drive. If
the XenApp server has malicious code on the server, a client workstation could be infected with
this malicious code. Text objects may be transferred, such as passwords, which could
compromise the XenApp server. This may cause information leakage and potentially infect
other operating systems if the text is a string that can be run as a command or URL. As a result
of these potential scenarios, the clipboard mapping will be disabled to prevent file transfers that
may be malicious to client machines via the clipboard.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><fixtext fixref="F-22543r1_fix">Disable Clipboard mapping on all Program Neighborhood clients.</fixtext><fix id="F-22543r1_fix" /><check system="C-26009r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_SRC - Remote XenApp_ICA_Thin_Client.xml" /><check-content>There are two ways to verify that the clipboard mapping is disabled. Each is listed below.
Method 1
Access the XenApp server and perform the following:
1. Select Start &gt; Administrative Tools &gt; Terminal Services Configuration &gt; ICA-tcp
2. Select the Client Settings tab and verify that “Clipboard mapping” is checked. If it is not
checked, this is a finding.
Method 2
1. Access the Local Computer Policy and Import the Citrix Presentation Server Client template
(icaclient.adm).
2. Navigate to the Computer Configuration &gt; Administrative Templates &gt; Citrix Components &gt;
Presentation Server Client &gt; Clipboard
3. Verify that “Clipboard” is set to Disabled. If not, this is a finding.</check-content></check></Rule></Group><Group id="V-21753"><title>SRC-CTX-110 Bitmap Disk Caching</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-24290r1_rule" severity="low" weight="10.0"><version>SRC-CTX-110</version><title>Disable Bitmap Disk Caching.</title><description>&lt;VulnDiscussion&gt;Bitmap disk cache stores graphic representations consisting of rows and columns of dots in
computer memory. The value of each dot is stored in one or more bits of data. Bitmap disk caching
is used as a performance measure for clients connecting over slow links. Clients connecting over
high speed links do not need this and it should be disabled to improve performance and security.
The bitmap cache is protected by an access control list, but the cache is stored to disk. To protect
the bitmap cache data on the disk from unauthorized users, bitmap disk caching will be disabled.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><fixtext fixref="F-18618r1_fix">Disable Bitmap Disk Caching.</fixtext><fix id="F-18618r1_fix" /><check system="C-20699r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_SRC - Remote XenApp_ICA_Thin_Client.xml" /><check-content>To verify the bitmap disk caching is disabled, perform the following:
1. Using a text editor, open the Appsrv.ini file located in the C:\Documents and Settings\Application Data\ICA Client directory. 
2. Under the [WFClient] section, verify the value is set to ‘PersistentCacheEnabled=Off’. If it is not set to off, this is a finding.
</check-content></check></Rule></Group><Group id="V-21757"><title>SRC-CTX-120 SSL/TLS+HTTPS</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-24296r2_rule" severity="medium" weight="10.0"><version>SRC-CTX-120</version><title>Configure SSL/TLS+HTTPS for the ICA client.</title><description>&lt;VulnDiscussion&gt;Unencrypted XenApp client to server sessions do not protect the information transmitted from being
read or viewed by anyone. Unencrypted sessions are vulnerable to a number of attacks to include
man-in-the-middle attacks, TCP Hijacking, and replay. SSL/TLS+HTTPS on the ICA client will
ensure that all traffic is encrypted between the server and client. The server must be configured to
accept SSL/TLS communication.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECCT-1, ECCT-2&lt;/IAControls&gt;</description><fixtext fixref="F-18621r1_fix">Configure SSL/TLS+HTTPS for the ICA client.</fixtext><fix id="F-18621r1_fix" /><check system="C-26011r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_SRC - Remote XenApp_ICA_Thin_Client.xml" /><check-content>To configure the Program Neighborhood Client to utilize SSL/TLS perform the following steps:
1. Select Start &gt; All Programs &gt; Citrix &gt; Citrix Access Clients &gt; Program Neighborhood.
2. Right click the application set and select Application Set Settings.
3. In the Settings dialog box, verify SSL/TLS+HTTPS is selected from the Network Protocol
menu. If not, this is a finding.
OR
1. Exit the Program Neighborhood client if it is running. Make sure all client components, including
the Connection Center, are closed.
2. Open the individual’s user-level Appsrv.ini file (default directory: %User Profile%\Application
Data\ICAClient) in a text editor.
3. Locate the section named [WFClient].
4. Verify the values of these three parameters below:
SSLCIPHERS= GOV
SECURECHANNELPROTOCOL= TLS
SSLEnable=On
5. If any of these three values are incorrect or missing, this is a finding.</check-content></check></Rule></Group><Group id="V-21758"><title>SRC-CTX-130 ICA software version</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-24299r1_rule" severity="medium" weight="10.0"><version>SRC-CTX-130</version><title>Upgrade Program Neighborhood clients to the required minimum version.</title><description>&lt;VulnDiscussion&gt;Minor Citrix client software versions could potentially be used to an attacker’s advantage.
Citrix Security Bulletin CTX116227 states that “under some circumstances, the Citrix
Presentation Server Client for Windows may leave residual information in the client process
memory. This issue is present in all versions of the Citrix Presentation Server Client prior to
version 10.200.” Therefore, the minimum software version for Citrix clients will be 10.200 or
higher.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><fixtext fixref="F-18633r1_fix">Upgrade Program Neighborhood clients to the required minimum version.</fixtext><fix id="F-18633r1_fix" /><check system="C-26012r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_SRC - Remote XenApp_ICA_Thin_Client.xml" /><check-content>1. Select Start &gt; All Programs &gt; Citrix &gt; Citrix Access Clients &gt; Program Neighborhood.
2. Navigate to Help &gt; About Program Neighborhood
3. If the Program Neighborhood version is not at 10.200 or higher, this is a finding.</check-content></check></Rule></Group><Group id="V-21761"><title>SRC-CTX-140 Smart card authentication</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-24311r1_rule" severity="medium" weight="10.0"><version>SRC-CTX-140</version><title>Enable Smart Card for ICA Program Neighborhood clients.</title><description>&lt;VulnDiscussion&gt;Two-factor authentication identifies users using two distinctive factors--something they have and
something they know or something they are. Requiring two different forms of electronic
identification reduces the risk of fraud. A physical device or token can be something a user has.
Token options include smart-tokens, smart cards, and password generation tokens. Smart cards
may be enabled within the Citrix XenApp Server environment. Smart cards are small plastic cards
with embedded computer chips. Within the DoD environment, this would be the Common Access
Card (CAC). Smart cards authenticate users to networks and computers, secure channel
communications over a network, and use digital signatures for signing content. With smart cards,
a user’s private key is securely stored within the smart card and never leaves the card. Using the
onboard processor, all cryptographic functions, including digital signatures and decryption of
session keys, occur inside the card. Smart cards will be used for authentication when users
access applications and content published on servers. In addition, Citrix supports two-factor
authentication for increased security. Instead of merely presenting the smart card (one factor) to
conduct a transaction, a user-defined PIN (a second factor), known only to the user, is employed
to prove that the cardholder is the rightful owner of the smart card.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;IAIA-1, IAIA-2&lt;/IAControls&gt;</description><fixtext fixref="F-22553r1_fix">Enable Smart Card for ICA Program Neighborhood clients.</fixtext><fix id="F-22553r1_fix" /><check system="C-26013r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_SRC - Remote XenApp_ICA_Thin_Client.xml" /><check-content>On the ICA workstation perform the following:
1. Select Start &gt; All Programs &gt; Citrix &gt; Citrix Access Clients &gt; Program Neighborhood.
2. Select the Logon Information tab and verify that Smart Card is selected. If not, this is a finding.</check-content></check></Rule></Group><Group id="V-21762"><title>SRC-CTX-150 Smart card is set to pass-thru</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-24315r1_rule" severity="medium" weight="10.0"><version>SRC-CTX-150</version><title>Disable smart-card pass thru authentication.</title><description>&lt;VulnDiscussion&gt;When a user selects an application on a Web Interface server, a file is sent to the browser. This
file can contain a setting that instructs the client to send the user’s workstation credentials to the
server. By default, the client does not honor this setting; however, there is a risk that if the passthru
feature is enabled on the Presentation Server Client for Win32, an attacker could send the
user a file causing the user’s credentials to be sent to an unauthorized or counterfeit server.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;IAIA-1, IAIA-2&lt;/IAControls&gt;</description><fixtext fixref="F-18638r2_fix">Disable smart-card pass thru authentication.</fixtext><fix id="F-18638r2_fix" /><check system="C-26014r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_SRC - Remote XenApp_ICA_Thin_Client.xml" /><check-content>On the ICA workstation, perform the following:
1. Select Start &gt; All Programs &gt; Citrix &gt; Citrix Access Clients &gt; Program Neighborhood.
2. Select the Logon Information tab and verify that Pass thru authentication is not checked under
Smart Card. If it is, this is a finding.
OR
1. Access the Appsrv.ini file located in users’ profiles to check whether pass-thru is configured.
For instance, if a user’s profile is stored locally, this file is located in C:\Documents and
Settings\user\Application Data\ICAClient.
2. In the [WFClient] section, verify the following entries do not exist:
EnableSSOnThruICAFile=On
SSOnUserSetting=On
If these two entries exist, this is a finding.</check-content></check></Rule></Group><Group id="V-21763"><title>SRC-CTX-160 Smart card PNAgent</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-24316r1_rule" severity="medium" weight="10.0"><version>SRC-CTX-160</version><title>Enable Smart Card for ICA Program Neighborhood Agents.</title><description>&lt;VulnDiscussion&gt;Two-factor authentication identifies users using two distinctive factors--something they have and
something they know or something they are. Requiring two different forms of electronic
identification reduces the risk of fraud. Something a user has can be a physical device sometimes
referred to as a token. Token options include smart-tokens, smart cards, and password generation tokens. Smart cards may be enabled within the Citrix XenApp Server environment. Smart cards are
small plastic cards with embedded computer chips. Within the DoD environment, this would be the
Common Access Card (CAC). Smart cards authenticate users to networks and computers, secure
channel communications over a network, and use digital signatures for signing content. With smart
cards, a user’s private key is securely stored within the smart card and never leaves the card. Using
the onboard processor, all cryptographic functions, including digital signatures and decryption of
session keys, occur inside the card. Smart cards will be used for authentication when users access
applications and content published on servers. In addition, Citrix supports two-factor authentication
for increased security. Instead of merely presenting the smart card (one factor) to conduct a
transaction, a user-defined PIN (a second factor), known only to the user, is employed to prove that
the cardholder is the rightful owner of the smart card.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;IAIA-1, IAIA-2&lt;/IAControls&gt;</description><fixtext fixref="F-18688r1_fix">Enable Smart Card for ICA Program Neighborhood Agents.</fixtext><fix id="F-18688r1_fix" /><check system="C-26015r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_SRC - Remote XenApp_ICA_Thin_Client.xml" /><check-content>Enabling smart card support for Program Neighborhood Agent is done through the Web Interface.
On the XenApp Server perform the following:
1. Select Start &gt; All Programs &gt; Citrix &gt; Management Consoles &gt; Access Management Console
2. Navigate to Citrix Resources &gt; Configuration Tools &gt; Web Interface &gt; (PNAgent Website Name)
3. Right Click on the config.xml and select Change Authentication Methods.
4. Verify that “Smart Card” is checked. If it is not, this is a finding.</check-content></check></Rule></Group><Group id="V-21764"><title>SRC-CTX-170 Program Neighborhood Agent TLS</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-24317r1_rule" severity="medium" weight="10.0"><version>SRC-CTX-170</version><title>Use TLS for all communications between the Program Neighborhood Agent and the Web server.</title><description>&lt;VulnDiscussion&gt;Unencrypted XenApp client to server sessions do not protect the information transmitted from being
read or viewed by anyone. Unencrypted sessions are vulnerable to a number of attacks to include
man-in-the-middle attacks, TCP Hijacking, and replay. Smart card logon and TLS-secured
communications between the client and the server running the Web Interface are not enabled by
default. TLS may be enabled by forcing URLs to apply the HTTPS protocol automatically. The
XenApp server must have TLS configured as well for it to work.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECCT-1, ECCT-2&lt;/IAControls&gt;</description><fixtext fixref="F-22554r1_fix">Use TLS for all communications between the Program Neighborhood Agent and the Web server.</fixtext><fix id="F-22554r1_fix" /><check system="C-26016r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_SRC - Remote XenApp_ICA_Thin_Client.xml" /><check-content>To verify that TLS protocol is configured, perform the following on the XenApp server:
1. Select Start &gt; All Programs &gt; Citrix &gt; Management Consoles &gt; Access Management Console
2. Navigate to Citrix Resources &gt; Configuration Tools &gt; Web Interface &gt; (PNAgent Website Name)
3. Right Click on the config.xml and select Manage Server Settings.
4. Verify that “Use SSL/TLS for communications between clients and the Web server” is checked.
If it is, this is a finding.</check-content></check></Rule></Group><Group id="V-21765"><title>SRC-CTX-180 Program Neighborhood Agent URL</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-24318r1_rule" severity="low" weight="10.0"><version>SRC-CTX-180</version><title>Disable the option to change server URLs.</title><description>&lt;VulnDiscussion&gt;Users may inadvertently change the URL to the XenApp server and not be able to access
published applications. To prevent users from changing the server URL, disable the option or hide
the server tab entirely.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><fixtext fixref="F-18690r1_fix">Disable the option to change server URLs.</fixtext><fix id="F-18690r1_fix" /><check system="C-26017r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_SRC - Remote XenApp_ICA_Thin_Client.xml" /><check-content>On the XenApp Server perform the following:
1. Select Start &gt; All Programs &gt; Citrix &gt; Management Consoles &gt; Access Management Console
2. Navigate to Citrix Resources &gt; Configuration Tools &gt; Web Interface &gt; (PNAgent Website Name)
3. Right Click on the config.xml and select Manage Server Settings.
4. Verify that “Allow users to customize the server URL” is unchecked. If it is, this is a finding.</check-content></check></Rule></Group></Benchmark>