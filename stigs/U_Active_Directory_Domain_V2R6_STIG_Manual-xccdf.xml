<?xml version="1.0" encoding="utf-8"?><?xml-stylesheet type='text/xsl' href='STIG_unclass.xsl'?><Benchmark xmlns:dsig="http://www.w3.org/2000/09/xmldsig#" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" id="Active_Directory_Domain" xml:lang="en" xsi:schemaLocation="http://checklists.nist.gov/xccdf/1.1 http://nvd.nist.gov/schema/xccdf-1.1.4.xsd http://cpe.mitre.org/dictionary/2.0 http://cpe.mitre.org/files/cpe-dictionary_2.1.xsd" xmlns="http://checklists.nist.gov/xccdf/1.1"><status date="2014-12-18">accepted</status><title>Active Directory Domain Security Technical Implementation Guide (STIG)</title><description>This STIG provides focused security requirements for the AD or Active Directory Domain Services (AD DS) element for Windows Servers operating systems.  These requirements apply to the domain and can typically be reviewed once per AD domain.  The separate Active Directory Forest STIG contains forest level requirements.  Systems must also be reviewed using the applicable Windows STIG.   Comments or proposed revisions to this document should be sent via e-mail to the following address:  disa.letterkenny.FSO.mbx.stig-customer-support-mailbox@mail.mil. </description><notice id="terms-of-use" xml:lang="en"></notice><reference href="http://iase.disa.mil"><dc:publisher>DISA, Field Security Operations</dc:publisher><dc:source>STIG.DOD.MIL</dc:source></reference><plain-text id="release-info">Release: 6 Benchmark Date: 23 Jan 2015</plain-text><version>2</version><Profile id="MAC-1_Classified"><title>I - Mission Critical Classified</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-8521" selected="true" /><select idref="V-8522" selected="true" /><select idref="V-8523" selected="true" /><select idref="V-8524" selected="true" /><select idref="V-8525" selected="true" /><select idref="V-8526" selected="true" /><select idref="V-8530" selected="true" /><select idref="V-8533" selected="true" /><select idref="V-8534" selected="true" /><select idref="V-8536" selected="true" /><select idref="V-8538" selected="true" /><select idref="V-8540" selected="true" /><select idref="V-8547" selected="true" /><select idref="V-8548" selected="true" /><select idref="V-8549" selected="true" /><select idref="V-8551" selected="true" /><select idref="V-8553" selected="true" /><select idref="V-25385" selected="true" /><select idref="V-25840" selected="true" /><select idref="V-25841" selected="true" /><select idref="V-25997" selected="true" /><select idref="V-36431" selected="true" /><select idref="V-36432" selected="true" /><select idref="V-36433" selected="true" /><select idref="V-36434" selected="true" /><select idref="V-36435" selected="true" /><select idref="V-36436" selected="true" /><select idref="V-36437" selected="true" /><select idref="V-36438" selected="true" /><select idref="V-43648" selected="true" /><select idref="V-43649" selected="true" /><select idref="V-43650" selected="true" /><select idref="V-43651" selected="true" /><select idref="V-43652" selected="true" /><select idref="V-43710" selected="true" /><select idref="V-43711" selected="true" /><select idref="V-43712" selected="true" /><select idref="V-43713" selected="true" /><select idref="V-43714" selected="true" /><select idref="V-44058" selected="true" /><select idref="V-44059" selected="true" /><select idref="V-53727" selected="true" /></Profile><Profile id="MAC-1_Public"><title>I - Mission Critical Public</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-8521" selected="true" /><select idref="V-8522" selected="true" /><select idref="V-8523" selected="true" /><select idref="V-8524" selected="true" /><select idref="V-8525" selected="true" /><select idref="V-8526" selected="true" /><select idref="V-8530" selected="true" /><select idref="V-8534" selected="true" /><select idref="V-8536" selected="true" /><select idref="V-8538" selected="true" /><select idref="V-8547" selected="true" /><select idref="V-8548" selected="true" /><select idref="V-8549" selected="true" /><select idref="V-8551" selected="true" /><select idref="V-8553" selected="true" /><select idref="V-25385" selected="true" /><select idref="V-25840" selected="true" /><select idref="V-25841" selected="true" /><select idref="V-25997" selected="true" /><select idref="V-36431" selected="true" /><select idref="V-36432" selected="true" /><select idref="V-36433" selected="true" /><select idref="V-36434" selected="true" /><select idref="V-36435" selected="true" /><select idref="V-36436" selected="true" /><select idref="V-36437" selected="true" /><select idref="V-36438" selected="true" /><select idref="V-43648" selected="true" /><select idref="V-43649" selected="true" /><select idref="V-43650" selected="true" /><select idref="V-43651" selected="true" /><select idref="V-43652" selected="true" /><select idref="V-43710" selected="true" /><select idref="V-43711" selected="true" /><select idref="V-43712" selected="true" /><select idref="V-43713" selected="true" /><select idref="V-43714" selected="true" /><select idref="V-44058" selected="true" /><select idref="V-44059" selected="true" /><select idref="V-53727" selected="true" /></Profile><Profile id="MAC-1_Sensitive"><title>I - Mission Critical Sensitive</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-8521" selected="true" /><select idref="V-8522" selected="true" /><select idref="V-8523" selected="true" /><select idref="V-8524" selected="true" /><select idref="V-8525" selected="true" /><select idref="V-8526" selected="true" /><select idref="V-8530" selected="true" /><select idref="V-8533" selected="true" /><select idref="V-8534" selected="true" /><select idref="V-8536" selected="true" /><select idref="V-8538" selected="true" /><select idref="V-8540" selected="true" /><select idref="V-8547" selected="true" /><select idref="V-8548" selected="true" /><select idref="V-8549" selected="true" /><select idref="V-8551" selected="true" /><select idref="V-8553" selected="true" /><select idref="V-25385" selected="true" /><select idref="V-25840" selected="true" /><select idref="V-25841" selected="true" /><select idref="V-25997" selected="true" /><select idref="V-36431" selected="true" /><select idref="V-36432" selected="true" /><select idref="V-36433" selected="true" /><select idref="V-36434" selected="true" /><select idref="V-36435" selected="true" /><select idref="V-36436" selected="true" /><select idref="V-36437" selected="true" /><select idref="V-36438" selected="true" /><select idref="V-43648" selected="true" /><select idref="V-43649" selected="true" /><select idref="V-43650" selected="true" /><select idref="V-43651" selected="true" /><select idref="V-43652" selected="true" /><select idref="V-43710" selected="true" /><select idref="V-43711" selected="true" /><select idref="V-43712" selected="true" /><select idref="V-43713" selected="true" /><select idref="V-43714" selected="true" /><select idref="V-44058" selected="true" /><select idref="V-44059" selected="true" /><select idref="V-53727" selected="true" /></Profile><Profile id="MAC-2_Classified"><title>II - Mission Support Classified</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-8521" selected="true" /><select idref="V-8522" selected="true" /><select idref="V-8523" selected="true" /><select idref="V-8524" selected="true" /><select idref="V-8525" selected="true" /><select idref="V-8526" selected="true" /><select idref="V-8530" selected="true" /><select idref="V-8533" selected="true" /><select idref="V-8534" selected="true" /><select idref="V-8536" selected="true" /><select idref="V-8538" selected="true" /><select idref="V-8540" selected="true" /><select idref="V-8547" selected="true" /><select idref="V-8548" selected="true" /><select idref="V-8549" selected="true" /><select idref="V-8551" selected="true" /><select idref="V-8553" selected="true" /><select idref="V-25385" selected="true" /><select idref="V-25840" selected="true" /><select idref="V-25841" selected="true" /><select idref="V-25997" selected="true" /><select idref="V-36431" selected="true" /><select idref="V-36432" selected="true" /><select idref="V-36433" selected="true" /><select idref="V-36434" selected="true" /><select idref="V-36435" selected="true" /><select idref="V-36436" selected="true" /><select idref="V-36437" selected="true" /><select idref="V-36438" selected="true" /><select idref="V-43648" selected="true" /><select idref="V-43649" selected="true" /><select idref="V-43650" selected="true" /><select idref="V-43651" selected="true" /><select idref="V-43652" selected="true" /><select idref="V-43710" selected="true" /><select idref="V-43711" selected="true" /><select idref="V-43712" selected="true" /><select idref="V-43713" selected="true" /><select idref="V-43714" selected="true" /><select idref="V-44058" selected="true" /><select idref="V-44059" selected="true" /><select idref="V-53727" selected="true" /></Profile><Profile id="MAC-2_Public"><title>II - Mission Support Public</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-8521" selected="true" /><select idref="V-8522" selected="true" /><select idref="V-8523" selected="true" /><select idref="V-8524" selected="true" /><select idref="V-8525" selected="true" /><select idref="V-8526" selected="true" /><select idref="V-8530" selected="true" /><select idref="V-8534" selected="true" /><select idref="V-8536" selected="true" /><select idref="V-8538" selected="true" /><select idref="V-8547" selected="true" /><select idref="V-8548" selected="true" /><select idref="V-8549" selected="true" /><select idref="V-8551" selected="true" /><select idref="V-8553" selected="true" /><select idref="V-25385" selected="true" /><select idref="V-25840" selected="true" /><select idref="V-25841" selected="true" /><select idref="V-25997" selected="true" /><select idref="V-36431" selected="true" /><select idref="V-36432" selected="true" /><select idref="V-36433" selected="true" /><select idref="V-36434" selected="true" /><select idref="V-36435" selected="true" /><select idref="V-36436" selected="true" /><select idref="V-36437" selected="true" /><select idref="V-36438" selected="true" /><select idref="V-43648" selected="true" /><select idref="V-43649" selected="true" /><select idref="V-43650" selected="true" /><select idref="V-43651" selected="true" /><select idref="V-43652" selected="true" /><select idref="V-43710" selected="true" /><select idref="V-43711" selected="true" /><select idref="V-43712" selected="true" /><select idref="V-43713" selected="true" /><select idref="V-43714" selected="true" /><select idref="V-44058" selected="true" /><select idref="V-44059" selected="true" /><select idref="V-53727" selected="true" /></Profile><Profile id="MAC-2_Sensitive"><title>II - Mission Support Sensitive</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-8521" selected="true" /><select idref="V-8522" selected="true" /><select idref="V-8523" selected="true" /><select idref="V-8524" selected="true" /><select idref="V-8525" selected="true" /><select idref="V-8526" selected="true" /><select idref="V-8530" selected="true" /><select idref="V-8533" selected="true" /><select idref="V-8534" selected="true" /><select idref="V-8536" selected="true" /><select idref="V-8538" selected="true" /><select idref="V-8540" selected="true" /><select idref="V-8547" selected="true" /><select idref="V-8548" selected="true" /><select idref="V-8549" selected="true" /><select idref="V-8551" selected="true" /><select idref="V-8553" selected="true" /><select idref="V-25385" selected="true" /><select idref="V-25840" selected="true" /><select idref="V-25841" selected="true" /><select idref="V-25997" selected="true" /><select idref="V-36431" selected="true" /><select idref="V-36432" selected="true" /><select idref="V-36433" selected="true" /><select idref="V-36434" selected="true" /><select idref="V-36435" selected="true" /><select idref="V-36436" selected="true" /><select idref="V-36437" selected="true" /><select idref="V-36438" selected="true" /><select idref="V-43648" selected="true" /><select idref="V-43649" selected="true" /><select idref="V-43650" selected="true" /><select idref="V-43651" selected="true" /><select idref="V-43652" selected="true" /><select idref="V-43710" selected="true" /><select idref="V-43711" selected="true" /><select idref="V-43712" selected="true" /><select idref="V-43713" selected="true" /><select idref="V-43714" selected="true" /><select idref="V-44058" selected="true" /><select idref="V-44059" selected="true" /><select idref="V-53727" selected="true" /></Profile><Profile id="MAC-3_Classified"><title>III - Administrative Classified</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-8521" selected="true" /><select idref="V-8522" selected="true" /><select idref="V-8523" selected="true" /><select idref="V-8524" selected="true" /><select idref="V-8525" selected="true" /><select idref="V-8526" selected="true" /><select idref="V-8530" selected="true" /><select idref="V-8533" selected="true" /><select idref="V-8534" selected="true" /><select idref="V-8536" selected="true" /><select idref="V-8538" selected="true" /><select idref="V-8540" selected="true" /><select idref="V-8547" selected="true" /><select idref="V-8548" selected="true" /><select idref="V-8549" selected="true" /><select idref="V-8551" selected="true" /><select idref="V-8553" selected="true" /><select idref="V-25385" selected="true" /><select idref="V-25840" selected="true" /><select idref="V-25841" selected="true" /><select idref="V-25997" selected="true" /><select idref="V-36431" selected="true" /><select idref="V-36432" selected="true" /><select idref="V-36433" selected="true" /><select idref="V-36434" selected="true" /><select idref="V-36435" selected="true" /><select idref="V-36436" selected="true" /><select idref="V-36437" selected="true" /><select idref="V-36438" selected="true" /><select idref="V-43648" selected="true" /><select idref="V-43649" selected="true" /><select idref="V-43650" selected="true" /><select idref="V-43651" selected="true" /><select idref="V-43652" selected="true" /><select idref="V-43710" selected="true" /><select idref="V-43711" selected="true" /><select idref="V-43712" selected="true" /><select idref="V-43713" selected="true" /><select idref="V-43714" selected="true" /><select idref="V-44058" selected="true" /><select idref="V-44059" selected="true" /><select idref="V-53727" selected="true" /></Profile><Profile id="MAC-3_Public"><title>III - Administrative Public</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-8521" selected="true" /><select idref="V-8522" selected="true" /><select idref="V-8523" selected="true" /><select idref="V-8524" selected="true" /><select idref="V-8525" selected="true" /><select idref="V-8526" selected="true" /><select idref="V-8530" selected="true" /><select idref="V-8534" selected="true" /><select idref="V-8536" selected="true" /><select idref="V-8538" selected="true" /><select idref="V-8540" selected="true" /><select idref="V-8547" selected="true" /><select idref="V-8548" selected="true" /><select idref="V-8549" selected="true" /><select idref="V-8551" selected="true" /><select idref="V-8553" selected="true" /><select idref="V-25385" selected="true" /><select idref="V-25840" selected="true" /><select idref="V-25841" selected="true" /><select idref="V-25997" selected="true" /><select idref="V-36431" selected="true" /><select idref="V-36432" selected="true" /><select idref="V-36433" selected="true" /><select idref="V-36434" selected="true" /><select idref="V-36435" selected="true" /><select idref="V-36436" selected="true" /><select idref="V-36437" selected="true" /><select idref="V-36438" selected="true" /><select idref="V-43648" selected="true" /><select idref="V-43649" selected="true" /><select idref="V-43650" selected="true" /><select idref="V-43651" selected="true" /><select idref="V-43652" selected="true" /><select idref="V-43710" selected="true" /><select idref="V-43711" selected="true" /><select idref="V-43712" selected="true" /><select idref="V-43713" selected="true" /><select idref="V-43714" selected="true" /><select idref="V-44058" selected="true" /><select idref="V-44059" selected="true" /><select idref="V-53727" selected="true" /></Profile><Profile id="MAC-3_Sensitive"><title>III - Administrative Sensitive</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-8521" selected="true" /><select idref="V-8522" selected="true" /><select idref="V-8523" selected="true" /><select idref="V-8524" selected="true" /><select idref="V-8525" selected="true" /><select idref="V-8526" selected="true" /><select idref="V-8530" selected="true" /><select idref="V-8533" selected="true" /><select idref="V-8534" selected="true" /><select idref="V-8536" selected="true" /><select idref="V-8538" selected="true" /><select idref="V-8540" selected="true" /><select idref="V-8547" selected="true" /><select idref="V-8548" selected="true" /><select idref="V-8549" selected="true" /><select idref="V-8551" selected="true" /><select idref="V-8553" selected="true" /><select idref="V-25385" selected="true" /><select idref="V-25840" selected="true" /><select idref="V-25841" selected="true" /><select idref="V-25997" selected="true" /><select idref="V-36431" selected="true" /><select idref="V-36432" selected="true" /><select idref="V-36433" selected="true" /><select idref="V-36434" selected="true" /><select idref="V-36435" selected="true" /><select idref="V-36436" selected="true" /><select idref="V-36437" selected="true" /><select idref="V-36438" selected="true" /><select idref="V-43648" selected="true" /><select idref="V-43649" selected="true" /><select idref="V-43650" selected="true" /><select idref="V-43651" selected="true" /><select idref="V-43652" selected="true" /><select idref="V-43710" selected="true" /><select idref="V-43711" selected="true" /><select idref="V-43712" selected="true" /><select idref="V-43713" selected="true" /><select idref="V-43714" selected="true" /><select idref="V-44058" selected="true" /><select idref="V-44059" selected="true" /><select idref="V-53727" selected="true" /></Profile><Group id="V-8521"><title>Object Ownership Delegation</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-9018r3_rule" severity="low" weight="10.0"><version>AD.0260</version><title>User accounts with delegated authority must be removed from Windows built-in administrative groups or remove the delegated authority from the accounts.</title><description>&lt;VulnDiscussion&gt;In AD it is possible to delegate account and other AD object ownership and administration tasks. (This is commonly done for help desk or other user support staff.) This is done to avoid the need to assign users to Windows groups with more widely ranging privileges. If a user with delegated authority to user accounts in a specific OU is also a member of the Administrators group, that user has the ability to reconfigure a wide range of domain security settings and change user accounts outside of the OU to which s/he is a delegated authority. A lack of specific baseline documentation of accounts with delegated privileges makes it impossible to determine if the configured privileges are consistent with the intended security policy.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Manager&lt;/Responsibility&gt;&lt;IAControls&gt;ECLP-1, ECPA-1&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Active Directory Domain</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Active Directory Domain</dc:subject><dc:identifier>870</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000366</ident><fixtext fixref="F-8049r1_fix">1. Remove user accounts with delegated authority from Windows built-in administrative groups or remove the delegated authority from the accounts. 

2. Document all user accounts with delegated AD object ownership or update authority. 

3. Annotate the account list with a statement such as, “The high number of privileged accounts is required to address site operational requirements.”

4. Reduce the number of user accounts with delegated AD object ownership or update authority. 
</fixtext><fix id="F-8049r1_fix" /><check system="C-7674r2_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Active_Directory_Domain.xml" /><check-content>1. Interview the IAM or site representative and obtain the list of accounts that have been delegated AD object ownership or update permissions and that are not members of Windows built-in administrative groups.
(This includes accounts for help desk or support personnel who are not Administrators, but have authority in AD to maintain user accounts or printers.)

2. If accounts with delegated authority are defined and there is no list, then this is a finding.

3. Count the number of accounts on the list.

4. If the number of accounts with delegated authority is greater than 10, review the site documentation that justifies this number.  Validate that the IAM explicitly acknowledges the need to have a high number of privileged users.

5. If the number of accounts with delegated authority is greater than 10 and there is no statement in the documentation that justifies the number, then this is a finding.</check-content></check></Rule></Group><Group id="V-8522"><title>Directory Service Inter-Enclave VPN Usage</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-30991r3_rule" severity="medium" weight="10.0"><version>DS00.1140_AD</version><title>A VPN must be used to protect directory network traffic for directory service implementation spanning enclave boundaries.</title><description>&lt;VulnDiscussion&gt;The normal operation of AD requires the use of IP network ports and protocols to support queries, replication, user authentication, and resource authorization services. At a minimum, LDAP or LDAPS is usually required for communication with every domain controller. DoD Ports, Protocols, and Services Management (PPSM) policy restricts the use of LDAP, LDAPS, and many of the AD-related protocols across enclave boundaries because vulnerabilities exist in the protocols or service implementations. To comply with the restrictions and address the vulnerabilities, a VPN implementation may be used. If AD data traverses enclave network boundaries using a vulnerable protocol or service without the protection provided by a VPN, that data might be subject to tampering or interception.

Further Policy Details: Implement a VPN or other network protection solution in accordance with the Network Infrastructure STIG that protects AD data in transit across DoD enclave boundaries. VPN requirements will include registering the VPN and connection points with the PPSM. Current guidance is available in the Network Infrastructure STIG and from the PPSM.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;Responsibility&gt;Information Assurance Manager&lt;/Responsibility&gt;&lt;IAControls&gt;DCPP-1&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Active Directory Domain</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Active Directory Domain</dc:subject><dc:identifier>870</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-002418</ident><fixtext fixref="F-15010r2_fix">Implement a VPN or other network protection solution in accordance with the Network Infrastructure STIG that protects AD data in transit across DoD enclave boundaries.</fixtext><fix id="F-15010r2_fix" /><check system="C-14102r3_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Active_Directory_Domain.xml" /><check-content>1. Review the site's network diagram(s) to determine if domain controllers for the domain are located in multiple enclaves. The object is to determine if network traffic is traversing enclave network boundaries.

2. Request information about RODC or ADAM instances are installed. In particular, request details of Active Diretory functionality installed or extended into the DMZ or configured/allowed to cross the sites outbound firewall boundary. Ensure communications and replication traffic is encrypted.

3. If domain controllers are not located in multiple enclaves, then this check is not applicable.

4. If domain controllers are located in multiple enclaves, verify that a VPN is used to transport the network traffic (replication, user logon, queries, etc.).

5. If a VPN solution is not used to transport directory network traffic across enclave boundaries, then this is a finding.

6. If the ADAM mode is in use and a migration plan for converting to RODC is not in place, then this is a finding.</check-content></check></Rule></Group><Group id="V-8523"><title>IDS Visibility of Directory VPN Data Transport</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-30994r3_rule" severity="medium" weight="10.0"><version>DS00.4140_AD</version><title>If a VPN is used in the AD implementation, the traffic must be inspected by the network Intrusion detection system (IDS).</title><description>&lt;VulnDiscussion&gt;To provide data confidentiality, a VPN is configured to encrypt the data being transported. While this protects the data, some implementations do not allow that data to be processed through an intrusion detection system (IDS) that could detect data from a compromised system or malicious client.

Further policy details:Replace the VPN solution or reconfigure it so that directory data is processed by a network or host-based intrusion detection system (IDS). 
&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;EBVC-1&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Active Directory Domain</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Active Directory Domain</dc:subject><dc:identifier>870</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000067</ident><fixtext fixref="F-27873r1_fix">Replace the VPN solution or reconfigure it so that directory data is inspected by a network or host-based IDS.</fixtext><fix id="F-27873r1_fix" /><check system="C-14101r2_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Active_Directory_Domain.xml" /><check-content>1. Interview the site representative. Ask about the location of the domain controllers. 

2. If domain controllers are not located in multiple enclaves, then this check is not applicable.

3. If domain controllers are located in multiple enclaves and a VPN is not used, then this check is not applicable.

4. If domain controllers are located in multiple enclaves and a VPN is used, review the site network diagram(s) with the SA, NSO, or network reviewer as required to determine if the AD network traffic is visible to a network or host IDS.

5. If the AD network traffic is not visible to a network or host IDS, then this is a finding.</check-content></check></Rule></Group><Group id="V-8524"><title>Directory Service Availability</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-30996r2_rule" severity="medium" weight="10.0"><version>DS00.6140_AD</version><title>When the domain supports a MAC I or II domain, the directory service must be supported by multiple directory servers.</title><description>&lt;VulnDiscussion&gt;In AD architecture, multiple domain controllers provide availability through redundancy. If an AD domain or servers within it are designated as MAC I or II and the domain is supported by only a single domain controller, an outage of that machine can prevent users from accessing resources on servers in that domain and in other AD domains.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;COTR-1&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Active Directory Domain</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Active Directory Domain</dc:subject><dc:identifier>870</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000366</ident><fixtext fixref="F-15019r1_fix">When the domain supports a MAC I or II domain, the directory service will be supported by multiple directory servers.</fixtext><fix id="F-15019r1_fix" /><check system="C-14112r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Active_Directory_Domain.xml" /><check-content>1.  Determine the MAC level information for the directory server.  If the asset is registered in VMS, this is available by using Asset Finding Maint. and navigating to the asset or by running an Asset Information (AS01) report for the location.

2. If the MAC level of the directory server is III, this check is not applicable.

3. Start the Active Directory Users and Computers console (Start, Run, “dsa.msc”).

4. Select and expand the left pane item that matches the name of the domain being reviewed.

5. Select the Domain Controllers [OU] item in the left pane.

6. Count the number of computers (objects) in the Domain Controllers OU.

7. If there is only one domain controller for a MAC I or II level domain, then this is a finding.</check-content></check></Rule></Group><Group id="V-8525"><title>Directory Service Architecture DR Documentation</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-30995r3_rule" severity="low" weight="10.0"><version>DS00.6120_AD</version><title>AD implementation information must be added to the sites disaster recovery plans, including AD forest, tree, and domain structure. 
</title><description>&lt;VulnDiscussion&gt;When an incident occurs that requires multiple AD domain controllers to be rebuilt, it is critical to understand the AD hierarchy and replication flow so that the correct recovery sequence and configuration values can be selected. Without appropriate AD forest, tree and domain structural documentation, it may be impossible or very time consuming to reconstruct the original configuration.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;CODP-1, CODP-2, CODP-3, COEF-1, COEF-2&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Active Directory Domain</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Active Directory Domain</dc:subject><dc:identifier>870</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000366</ident><fixtext fixref="F-15011r1_fix">Update the disaster recovery plans to include directory service architecture details such as hierarchy and replication structure.</fixtext><fix id="F-15011r1_fix" /><check system="C-14103r2_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Active_Directory_Domain.xml" /><check-content>1. Interview the IAO. Ask about the MAC levels of the system.

2. Determine the MAC level information for the AD Domain asset. If the asset is registered in VMS, this is available by using Asset Finding Maint. and navigating to the asset or by running an Asset Information (AS01) report for the location.

3. If the MAC level of the AD Domain is III, this check is not applicable.

4. Obtain a copy of the site’s disaster recovery planning documents.

5. Check the disaster recovery plans for documentation on the AD hierarchy (forest, tree, and domain structure).
(A chart showing forest hierarchy and domain names is the minimum suggested.)

6. If the disaster recovery plans that cover a MAC I or II level AD Domain do not include directory hierarchy information, then this is a finding.</check-content></check></Rule></Group><Group id="V-8526"><title>Cross-Directory Authentication INFOCON Procedures</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-31214r2_rule" severity="low" weight="10.0"><version>DS00.7100_AD</version><title>The impact of INFOCON changes on the cross-directory authentication configuration must be considered and procedures documented.</title><description>&lt;VulnDiscussion&gt;When incidents occur that require a change in the INFOCON status, it may be necessary to take action to restrict or disable certain types of access that is based on a directory outside the Component’s control. Cross-directory configurations (such as trusts and pass-through authentication) are specifically designed to enable resource access across directories. If conditions indicate that an outside directory is at increased risk of compromise in the immediate or near future, actions to avoid a spread of the effects of the compromise should be taken. A trusted outside directory that is compromised could allow an unauthorized user to access resources in the trusting directory.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;VIIR-1, VIIR-2&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Active Directory Domain</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Active Directory Domain</dc:subject><dc:identifier>870</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000366</ident><fixtext fixref="F-15012r1_fix">Evaluate cross-directory configurations (such as trusts and pass-through authentication) and provide documentation that indicates: 
1. That an evaluation was performed. 
2. The specific AD trust configurations, if any, that should be disabled during changes in INFOCON status because they could represent increased risk. </fixtext><fix id="F-15012r1_fix" /><check system="C-14104r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Active_Directory_Domain.xml" /><check-content>1. Refer to the list of actual manual AD trusts (cross-directory configurations) collected from the site representative.

2. If there are no manual AD trusts (cross-directory configurations) defined, this check is not applicable.
For AD, this includes external, forest, or realm trust relationship types.

3. Obtain a copy of the site’s supplemental INFOCON procedures as required by Strategic Command Directive (SD) 527-1.

4. Verify that it has been determined by the IAM whether INFOCON response actions need to include procedures to disable manual AD trusts (cross-directory configurations). The objective is to determine if the need has been explicitly evaluated.

5. If it has been determined that actions to disable manual AD trusts (cross-directory configurations) are not necessary, then this check is not applicable.

6. If it has been determined that actions to disable manual AD trusts (cross-directory configurations) *are* necessary, verify that the policy to implement these actions has been documented.

7. If actions to disable manual AD trusts (cross-directory configurations) *are* needed and no policy has been documented, then this is a finding.</check-content></check></Rule></Group><Group id="V-8530"><title>Cross-Directory Authentication Documentation</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-30989r2_rule" severity="low" weight="10.0"><version>DS00.1120_AD</version><title>Each cross-directory authentication configuration must be documented.</title><description>&lt;VulnDiscussion&gt;AD external, forest, and realm trust configurations are designed to extend resource access to a wider range of users (those in other directories). If specific baseline documentation of authorized AD external, forest, and realm trust configurations is not maintained, it is impossible to determine if the configurations are consistent with the intended security policy.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;DCID-1&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Active Directory Domain</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Active Directory Domain</dc:subject><dc:identifier>870</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000366</ident><fixtext fixref="F-15017r1_fix">Develop documentation for each AD external, forest, and realm trust configuration. At a minimum this must include: 
a. Type (external, forest, or realm). 
b. Name of the other party.
c. MAC, confidentiality, and classification level of the other party. 
d. Trust direction (inbound and\or outbound). 
e. Transitivity. 
f. Status of the Selective Authentication option. 
g. Status of the SID filtering option. </fixtext><fix id="F-15017r1_fix" /><check system="C-14110r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Active_Directory_Domain.xml" /><check-content>1. Start the Active Directory Domains and Trusts console (Start, Run, “domain.msc”).

2. Select the left pane item that matches the name of the domain being reviewed.

3. Right-click the domain name and select the Properties item.

4. On the domain object Properties window, select the Trusts tab.

5. For each outbound and inbound external, forest, and realm trust, record the name of the other party (domain name), the trust type, transitivity, and the trust direction. (Keep this trust information for use in subsequent checks.)

6. Compare the list of actual trusts identified with the list in local documentation maintained by the IAO. For each trust, the documentation must contain type (external, forest, or realm), name of the other party, MAC and classification level of the other party, trust direction (inbound and\or outbound), transitivity, status of the Selective Authentication option, and status of the SID filtering option.

7. If an identified trust is not listed in the documentation or if any of the required items are not documented, then this is a finding.</check-content></check></Rule></Group><Group id="V-8533"><title>Trusts - document need </title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-9030r2_rule" severity="medium" weight="10.0"><version>AD.0170</version><title>Access to need-to-know information must be restricted to an authorized community of interest.</title><description>&lt;VulnDiscussion&gt;Because trust relationships effectively eliminate a level of authentication in the trusting domain or forest, they represent less stringent access control at the domain or forest level in which the resource resides. To mitigate this risk, trust relationships must be documented so that they can be readily verified during periodic inspections designed to validate only approved trusts are configured in AD.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECAN-1&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Active Directory Domain</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Active Directory Domain</dc:subject><dc:identifier>870</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000366</ident><fixtext fixref="F-8062r1_fix">Delete the unneeded trust relationship or document the access requirement or mission need for the trust.
</fixtext><fix id="F-8062r1_fix" /><check system="C-7696r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Active_Directory_Domain.xml" /><check-content>1. Before performing this check, perform V-8530  which validates the trusts within the documentation are current within AD.

2. Obtain documentation of the site's approved trusts from the site representative.  

3. For each of the identified trusts, verify that the documentation includes a justification or explanation of the need-to-know basis of the trust. 

4. If the need for the trust is not documented, then this is a finding.</check-content></check></Rule></Group><Group id="V-8534"><title>Trust - Classification Levels</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-9031r2_rule" severity="high" weight="10.0"><version>AD.0180</version><title>Interconnections between DoD directory services of different classification levels must use a cross-domain solution that is approved for use with inter-classification trusts.</title><description>&lt;VulnDiscussion&gt;If a robust cross-domain solution is not used, then it could permit unauthorized access to classified data. To support secure access between resources of different classification levels, the solution must meet discretionary access control requirements. There are currently, no DOD- approved solutions. 

Further Policy Details: Do not define trust relationships between domains, forests, or realms with resources at different classification levels. The configuration of a trust relationship is one of the steps used to allow users in one AD domain to access resources in another domain, forest, or Kerberos realm. (This check does not apply to trusts with non-DoD organizations since these trusts are examined in a previous check.)&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECIC-1&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Active Directory Domain</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Active Directory Domain</dc:subject><dc:identifier>870</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000366</ident><fixtext fixref="F-8063r1_fix">Delete the trust relationship that is defined between entities with resources at different DoD classification levels.</fixtext><fix id="F-8063r1_fix" /><check system="C-7698r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Active_Directory_Domain.xml" /><check-content>1. Refer to the list of identified trusts and the trust documentation provided by the site representative. (Obtained in V-8530)

2. For each of the identified trusts between DoD organizations, compare the classification level (unclassified, confidential, secret, and top secret) of the domain being reviewed with the classification level of the other trust party as noted in the documentation.

3. If the classification level of the domain being reviewed is different than the classification level of any of the entities for which a trust relationship is defined, then this is a finding.
</check-content></check></Rule></Group><Group id="V-8536"><title>Trust - Non-DoD</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-9033r2_rule" severity="high" weight="10.0"><version>AD.0181</version><title>A controlled interface must have interconnections among DoD information systems operating between DoD and non-DoD systems or networks.</title><description>&lt;VulnDiscussion&gt;The configuration of an AD trust relationship is one of the steps used to allow users in one domain to access resources in another domain, forest, or Kerberos realm. When a trust is defined between a DoD organization and a non-DoD organization, the security posture of the two organizations might be significantly different. If the non-DoD organization maintained a less secure environment and that environment were compromised, the presence of the AD trust might allow the DoD environment to be compromised also.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECIC-1&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Active Directory Domain</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Active Directory Domain</dc:subject><dc:identifier>870</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000366</ident><fixtext fixref="F-28136r1_fix">Obtain DAA approval and document external, forest, or realm trust relationship. Or obtain documentation of the network connection approval and explicit trust approval by the DAA.</fixtext><fix id="F-28136r1_fix" /><check system="C-7699r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Active_Directory_Domain.xml" /><check-content>1. Refer to the list of identified trusts obtained in a previous check (V8530).

2. For each of the identified trusts, determine if the other trust party is a non-DoD entity. For example, if the fully qualified domain name of the other party does not end in “.mil”, the other party is probably not a DoD entity.

3. Review the local documentation approving the external network connection and documentation indicating explicit approval of the trust by the DAA.

4. The external network connection documentation is maintained by the IAO\NSO for compliance with the Network Infrastructure STIG.

5. If any trust is defined with a non-DoD system and there is no documentation indicating approval of the external network connection and explicit DAA approval of the trust, then this is a finding.</check-content></check></Rule></Group><Group id="V-8538"><title>Trust - SID Filter Quarantining </title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-9035r3_rule" severity="medium" weight="10.0"><version>AD.0190</version><title>Security identifiers (SIDs) must be configured to use only authentication data of directly trusted external or forest trust. </title><description>&lt;VulnDiscussion&gt;Under some circumstances it is possible for attackers or rogue administrators that have compromised a domain controller in a trusted domain to use the SID history attribute (sIDHistory) to associate SIDs with new user accounts, granting themselves unauthorized rights.  To help prevent this type of attack, SID filter quarantining is enabled by default on all external trusts.   However, it is possible for an administrator to change this setting or the trust may have been created in an older version of AD. 

 SID filtering causes SID references that do not refer to the directly trusted domain or forest to be removed from inbound access requests in the trusting domain.  Without SID filtering, access requests could contain spoofed SIDs, permitting unauthorized access.  

In cases where access depends on SID history or Universal Groups, failure to enable SID filtering could result in operational problems, including denial of access to authorized users.

When the quarantine switch is applied to external or forest trusts, only those SIDs from the single, directly trusted domain are valid.  In effect, enabling /quarantine on a trust relationship will break the transitivity of that trust so that only the specific domains on either side of the trust are considered participants in the trust.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECAN-1, ECCD-1, ECCD-2&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Active Directory Domain</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Active Directory Domain</dc:subject><dc:identifier>870</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000764</ident><fixtext fixref="F-62885r2_fix">Ensure SID filtering is enabled on all external trusts.  You can enable SID filtering only from the trusting side of the trust.  Enter the following line from a command line:

netdom trust &lt;TrustingDomainName&gt; /d:&lt;TrustedDomainName&gt; /quarantine:Yes
/usero:&lt;DomainAdministratorAcct&gt; /passwordo:&lt;DomainAdminPwd&gt;

Ensure SID history is disabled for all forest trusts.  You can disable SID history only from the trusting side of the trust.  Enter the following line from a command line:

netdom trust &lt;TrustingDomainName&gt; /d:&lt;TrustedDomainName&gt; /enablesidhistory:No
/usero:&lt;DomainAdministratorAcct&gt; /passwordo:&lt;DomainAdminPwd&gt;</fixtext><fix id="F-62885r2_fix" /><check system="C-58507r2_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Active_Directory_Domain.xml" /><check-content>Open "Active Directory Domains and Trusts". (Available from various menus or run "domain.msc".)
Right click the domain in the left pane and select Properties.
Select the Trusts tab.
Note any existing trusts and the type.
If no trusts exist, this is NA.

If the trust type is External, run the following command on the trusting domain:
"netdom trust &lt;trusting domain&gt; /d:&lt;trusted domain&gt; /quarantine"
If the result does not specify "SID filtering is enabled for this trust.  Only SIDs from the trusted domain will be accepted for authorization data returned during authentication.  SIDs from other domains will be removed.", this is a finding. 

If the trust type is Forest, run the following command on the trusting domain:
"netdom trust &lt;trusting domain&gt; /d:&lt;trusted domain&gt; /enablesidhistory"
If the result does not specify "SID history is disabled for this trust", this is a finding.</check-content></check></Rule></Group><Group id="V-8540"><title>Trust - Selective Authentication</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-9037r2_rule" severity="medium" weight="10.0"><version>AD.0200</version><title>Selective Authentication must be enabled on the outgoing forest trust.</title><description>&lt;VulnDiscussion&gt;Outbound AD forest trusts can be configured with the Selective Authentication option. Enabling this option significantly strengthens access control by requiring explicit authorization (through the Allowed to Authenticate permission) on resources in the trusting forest. When Selective Authentication is not enabled, less secure resource access permissions (such as those that specify Authenticated Users) might permit unauthorized access.

Further Policy Details: Selective Authentication can be configured with the Domains and Trusts console (domain.msc). It may be necessary to configure the Allowed to Authenticate permission on resources in the trusting domain. &lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;Implementation requires configuration of the Allowed to Authenticate permission on resources in the trusting domain for which access is desired. Failure to configure this permission could result in operational problems including denied resource access to authorized users.&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECAN-1, ECCD-1, ECCD-2&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Active Directory Domain</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Active Directory Domain</dc:subject><dc:identifier>870</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000213</ident><fixtext fixref="F-8066r1_fix">Enable Selective Authentication on the outgoing forest trust.</fixtext><fix id="F-8066r1_fix" /><check system="C-7702r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Active_Directory_Domain.xml" /><check-content>1. Start the Active Directory Domains and Trusts console (Start, Run, “domain.msc”).

2. Select the left pane item that matches the name of the domain being reviewed and perform the following:
a. Right-click the domain name and select the Properties item.
b. On the domain object Properties window, select the Trusts tab.
c. For each outgoing forest trust, right-click the trust item and select the Properties item. 
d. On the trust Properties window, select the Authentication tab. Determine if the Selective Authentication option is selected.

3. If the Selective Authentication option is not selected on every outgoing forest trust, then this is a finding.</check-content></check></Rule></Group><Group id="V-8547"><title>Pre-Windows 2000 Compatible Access Group</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-9044r2_rule" severity="medium" weight="10.0"><version>AD.0220</version><title>The Everyone and Anonymous Logon groups must be removed from the Pre-Windows 2000 Compatible Access group.
</title><description>&lt;VulnDiscussion&gt;The Pre-Windows 2000 Compatible Access group was created to allow Windows NT domains to interoperate with AD domains by allowing unauthenticated access to certain AD data. The default permissions on many AD objects are set to allow access to the Pre-Windows 2000 Compatible Access group.

Implementation in a Windows forest in which Windows NT domain controllers are still deployed could result in operational problems including denied access to authorized users.

When the Everyone or Anonymous Logon groups are members of the Pre-Windows 2000 Compatible Access group, anonymous access to many AD objects is enabled.

Anonymous access to AD data could provide valuable account or configuration information to an intruder trying to determine the most effective attack strategies.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;System Administrator&lt;/Responsibility&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECAN-1, ECCD-1, ECCD-2&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Active Directory Domain</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Active Directory Domain</dc:subject><dc:identifier>870</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000804</ident><fixtext fixref="F-8067r1_fix">Remove the Everyone and Anonymous Logon groups from the Pre-Windows 2000 Compatible Access group.</fixtext><fix id="F-8067r1_fix" /><check system="C-7706r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Active_Directory_Domain.xml" /><check-content>1. Start the Active Directory Users and Computers console (Start, Run, “dsa.msc”).

2. Select and expand the left pane item that matches the name of the domain being reviewed and perform the following:
a. Select the Builtin item. 
b. Double-click the Pre-Windows 2000 Compatible Access group and select the Members tab.

3. If the Anonymous Logon group or Everyone group is a member of the Pre-Windows 2000 Compatible Access group, then this is a finding.</check-content></check></Rule></Group><Group id="V-8548"><title>Privileged Group Membership - Intra-Forest</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-9045r2_rule" severity="medium" weight="10.0"><version>AD.0240</version><title>The number of member accounts in privileged groups must not be excessive. </title><description>&lt;VulnDiscussion&gt;Membership in the following Windows security groups assigns a high privilege level for AD functions: Domain Admins, Enterprise Admins, Schema Admins, Group Policy Creator Owners, and Incoming Forest Trust Builders.

When a large number of users are members of highly privileged groups, the risk from unintended updates or compromised accounts is significantly increased.

A lack of specific baseline documentation on privileged group membership makes it impossible to determine if the assigned accounts are consistent with the intended security policy.

Further Policy Details: It is possible to move the highly privileged AD security groups out of the AD Users container. If the Domain Admins, Enterprise Admins, Schema Admins, or Group Policy Creator Owners groups are not in the AD Users container, ask the SA for the new location and use that location for this check.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Manager&lt;/Responsibility&gt;&lt;IAControls&gt;ECLP-1, ECPA-1&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Active Directory Domain</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Active Directory Domain</dc:subject><dc:identifier>870</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000366</ident><fixtext fixref="F-8068r1_fix">Update the site documentation to include all the accounts that are members of highly privileged groups. Annotate the account list(s) with a statement such as, “The high number of privileged accounts is required to address site operational requirements.” Reduce the number of accounts in highly privileged groups to the minimum level necessary. </fixtext><fix id="F-8068r1_fix" /><check system="C-7707r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Active_Directory_Domain.xml" /><check-content>1. Start the Active Directory Users and Computers console (Start, Run, “dsa.msc”).

2. Select and expand the left pane item that matches the name of the domain being reviewed.

3. Select the Built-in container. If the Incoming Forest Trust Builders group is defined perform the following:
a. Double-click on the group and select the Members tab
b. Count the number of accounts in the group
c. Compare the accounts in the group with the local documentation.

4. Select the Users container. For each of the Domain Admins, Enterprise Admins, Schema Admins, and Group Policy Creator Owners groups perform the following:
a. Double-click on the group and select the Members tab
b. Count the number of accounts in the group
c. Compare the accounts in the group with the local documentation.

5. If an account in a highly privileged AD security group is not listed in the local documentation, then this is a finding.

6. If the number of accounts defined in a highly privileged AD security group is greater than the number below, review the site documentation that justifies this number.
a. For the Enterprise Admins, Schema Admins, Group Policy Creator Owners, and Incoming Forest Trust Builders groups, the number of accounts should be between zero (0) and five (5).
b. The number of Domain Admins should be between one (1) and ten (10).

7. If the number of accounts defined in a highly privileged AD security group is greater than the guidance above and there is no documentation that justifies the number, then this is a finding.</check-content></check></Rule></Group><Group id="V-8549"><title>Privileged Group Membership - Cross-Directory</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-31557r2_rule" severity="medium" weight="10.0"><version>DS00.3200_AD</version><title>Accounts from outside directories that are not part of the same organization or are not subject to the same security policies must be removed from all highly privileged groups. 
</title><description>&lt;VulnDiscussion&gt;Membership in certain default directory groups assigns a high privilege level for access to the directory. In AD, membership in the following groups enables high privileges relative to AD and the Windows OS: Domain Admins, Enterprise Admins, Schema Admins, Group Policy Creator Owners, and Incoming Forest Trust Builders. 

When accounts from an outside directory are members of highly privileged groups in the directory being reviewed, less rigorous security policies or compromises of accounts in the outside directory could increase the risk to the directory where the privileged groups are defined. A compromise to the outside directory would allow unauthorized, privileged access.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;System Administrator&lt;/Responsibility&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECLP-1, ECPA-1&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Active Directory Domain</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Active Directory Domain</dc:subject><dc:identifier>870</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000366</ident><fixtext fixref="F-28135r1_fix">Remove accounts from outside directories that are not part of the same organization or are not subject to the same security policies from the highly privileged groups. 
</fixtext><fix id="F-28135r1_fix" /><check system="C-14111r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Active_Directory_Domain.xml" /><check-content>1. Start the Active Directory Users and Computers console (Start, Run, “dsa.msc”).

2. Select and expand the left pane item that matches the name of the domain being reviewed.

3. Select the Built-in container. 
a. If the Incoming Forest Trust Builders group is defined, double-click on the group, and select the Members tab
b. Examine the defined accounts to see if they are from a domain that is not in the forest being reviewed.

4. Select the Users container
a. For each group (Domain Admins, Enterprise Admins, Schema Admins, and Group Policy Creator Owners), double-click on the group, and select the Members tab.
b. Examine the defined accounts to see if they are from a domain that is not in the forest being reviewed.

5. If any account in a privileged group is from a domain outside the forest being reviewed and that outside forest is not maintained by the same organization (e.g., enclave) or subject to the same security policies, then this is a finding.

Supplementary Notes:
Note: An account that is from an outside domain appears in the format “outside-domain-NetBIOSname\account” or “account@outside-domain-fully-qualified-name”. Examples are “AOFN21\jsmith” or “jsmith@AOFN21.OST.COM”. It may be necessary to use the AD Domains and Trusts (domain.msc) console to determine if the domain is from another AD forest.

Note:  It is possible to move the highly privileged AD security groups out of the AD Users container. If the Domain Admins, Enterprise Admins, Schema Admins, or Group Policy Creator Owners groups are not in the AD Users container, ask the SA for the new location and use that location for this check.</check-content></check></Rule></Group><Group id="V-8551"><title>Domain Functional Level</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-9048r3_rule" severity="medium" weight="10.0"><version>AD.0160</version><title>The domain functional level must be at a Windows Server version still supported by Microsoft.</title><description>&lt;VulnDiscussion&gt;Domains operating at functional levels below Windows Server versions no longer supported by Microsoft reduce the level of security in the domain and forest as advanced features of the directory are not available.  This also prevents the addition of domain controllers to the domain using Windows Server versions prior to the current domain functional level.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;System Administrator&lt;/Responsibility&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Active Directory Domain</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Active Directory Domain</dc:subject><dc:identifier>870</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000366</ident><fixtext fixref="F-62383r1_fix">Raise the domain functional level to a Windows Server version still supported by Microsoft. 

Microsoft will no longer support Windows Server 2003 after 14 July 2015.

Raising the domain functional level needs to be carefully planned and implemented.  This prevents the addition of domain controllers to the domain using Windows versions prior to the current domain functional level. 

See Microsoft documentation for the process and requirements of raising the domain functional level. </fixtext><fix id="F-62383r1_fix" /><check system="C-58021r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Active_Directory_Domain.xml" /><check-content>Open "Active Directory Domains and Trusts" (run "domain.msc") or "Active Directory Users and Computers" (run "dsa.msc").
Right click in the left pane on the name of the Domain being reviewed.
Select "Raise domain functional level…"
The current domain functional level will be displayed (as well as the option to raise the domain functional level).
Select "Cancel" to exit.

Alternately, using PowerShell (Windows 2008 R2 or later).
Select "Active Directory Module for Windows PowerShell", available in Administrative Tools or the Start Screen.
Run "Get-ADDomain".
View the value for "DomainMode:"

If the current domain functional level is a Windows Server version no longer supported by Microsoft, this is a finding.

Microsoft will no longer support Windows Server 2003 after 14 July 2015.</check-content></check></Rule></Group><Group id="V-8553"><title>Replication Schedule</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-30992r2_rule" severity="medium" weight="10.0"><version>DS00.3230_AD</version><title>Replication must be enabled and configured to occur at least daily.</title><description>&lt;VulnDiscussion&gt;Timely replication makes certain that directory service data is consistent across all servers that support the same scope of data for their clients. In AD implementation using AD Sites, domain controllers defined to be in different AD Sites require Site links to specify properties for replication scheduling.

If AD Site link schedule and replication interval properties are configured improperly, AD data replication may not occur frequently enough and updates to identification, authentication, or authorization data may not be current on all domain controllers. If this data is not current, access to resources may be incorrectly granted or denied.

Further policy details:
An AD instance may have no AD site links defined. The following are ways in which site link properties would prevent daily AD replication: 
1. Setting the “Replicate every” value to a number greater than 1440 (the number of minutes in one day). 

2. Setting the Schedule value for all hours in a day to “Replication Not Available”.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;System Administrator&lt;/Responsibility&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECAN-1, ECCD-1, ECCD-2&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Active Directory Domain</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Active Directory Domain</dc:subject><dc:identifier>870</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000366</ident><fixtext fixref="F-15020r1_fix">Enable daily replication (at a minimum) for the directory service.
</fixtext><fix id="F-15020r1_fix" /><check system="C-14113r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Active_Directory_Domain.xml" /><check-content>1. Start the Active Directory Sites and Services console (Start, Run, “dssite.msc”).

2. Select and expand the Sites item in the left pane.

3. Select and expand the Inter-Site Transports item and the IP item in the left pane. 

4. For each site link that is defined perform the following: 
a.  Right-click the site link item and select the Properties item. 
b.  Note the interval indicated in the “Replicate every” field. 
c.  Click the Change Schedule button.
d.  Using the values indicated for “Replication Available”, determine if the replication interval would allow daily replication to occur. 
e. Click the Cancel button for the Schedule window.
f.  Click the Cancel button for the Properties window.
g. If the replication interval and replication available properties do not allow daily replication, then this is a finding.</check-content></check></Rule></Group><Group id="V-25385"><title>Directory Data Backup</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-31547r2_rule" severity="medium" weight="10.0"><version>DS00.0160_AD</version><title>Directory data must be backed up at the required frequency.</title><description>&lt;VulnDiscussion&gt;Failure to maintain a current backup of directory data could make it difficult or impossible to recover from incidents including hardware failure or malicious corruption.  A failure to recover from the loss of directory data used in identification and authentication services (i.e.,, Active Directory) could result in an extended loss of availability.
&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;CODB-1, CODB-2, CODB-3&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Active Directory Domain</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Active Directory Domain</dc:subject><dc:identifier>870</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000366</ident><fixtext fixref="F-28483r1_fix">1. Change local site procedures to include a complete backup of directory data in compliance with the following frequency: 
a. MAC I or II system - back up the directory data at least daily. 
b. MAC III systems - back up the directory data at least weekly. 

2. Change local site procedures to use a backup tool that is appropriate for the directory technology. 

3. Ensure that the type of backup is appropriate to capturing the directory data. For AD domain controllers, this must include a System State data backup </fixtext><fix id="F-28483r1_fix" /><check system="C-31812r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Active_Directory_Domain.xml" /><check-content>1. Interview the IAO.

2. Obtain a copy of the site’s SOP for backups.

3. Check the SOP for the frequency at which directory data is backed up. Alternatively, physically verify that backups are being performed. 

4. If the directory data for a MAC III system is not backed up at least weekly, then this is a finding.

5. If the directory data for a MAC I or II system is not backed up at least daily, then this is a finding.</check-content></check></Rule></Group><Group id="V-25840"><title>DSRM Password Change Policy</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-32179r2_rule" severity="medium" weight="10.0"><version>AD.0151</version><title>The Directory Service Restore Mode (DSRM) password must be changed at least annually. </title><description>&lt;VulnDiscussion&gt;This is a tremendously powerful password which should be changed periodically. This password is unique to each DC and is used to logon to a DC when rebooting into the server recovery mode.   With a weak or known password, anyone with local access to the DC can reboot this machine, copy or modify the Active Directory database, and reboot the server without leaving any trace of the activity.

Failure to change the DSRM password periodically could allow a compromised resource (maliciously or through personnel turnover) to go undetected for an extended period. Failure to change the DSRM password could allow an unknown (lost) password to go undetected. If not corrected during a periodic review, the problem might surface during an actual recovery operation and delay or prevent the recovery.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Manager&lt;/Responsibility&gt;&lt;IAControls&gt;IAIA-1, IAIA-2&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Active Directory Domain</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Active Directory Domain</dc:subject><dc:identifier>870</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000366</ident><fixtext fixref="F-28702r1_fix">Create or implement a local site policy to change the DSRM password at least yearly.   </fixtext><fix id="F-28702r1_fix" /><check system="C-32375r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Active_Directory_Domain.xml" /><check-content>1. Interview the IAM.

2. Obtain a copy of the site’s policy that addresses password change frequency.

3. Check that the policy addresses the requirement for the DSRM password to be changed at least yearly. Alternatively review logs or other evidence that indicates that the password has been changed within the last year.
Note that there is no known method to check password age online while the server is active as a domain controller.

4. If there is no policy for changing the DSRM password at least yearly or no indication that it has been changed within the last year, then this is a finding.</check-content></check></Rule></Group><Group id="V-25841"><title>Review of Hosting Domain and Forest</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-32180r2_rule" severity="low" weight="10.0"><version>AD.9100</version><title>Security vulnerability reviews of the domain and/or forest in which the domain controller resides must be conducted at least annually.
</title><description>&lt;VulnDiscussion&gt;An AD domain controller is impacted by the AD environment created by the security configuration of the domain and forest in which the domain controller resides. A proper review of the AD environment requires checks at the domain controller, domain, and forest level. If the domain or forest-level checks are not performed at the same time or within a reasonable time frame, the domain controller may be at risk from non-secure settings at those levels.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Active Directory Domain</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Active Directory Domain</dc:subject><dc:identifier>870</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000366</ident><fixtext fixref="F-28704r1_fix">Perform reviews of the domain and/or forest in which the domain controller resides at least annually.   </fixtext><fix id="F-28704r1_fix" /><check system="C-32377r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Active_Directory_Domain.xml" /><check-content>1. Verify that the domain and forest in which the domain controller resides have been reviewed using the requirements in the appropriate document in the Active Directory STIG. 

2. The security assessment must be conducted at the same time or no more than 1 year prior to the review of the domain controller. 

3. VMS asset information, dated reports, or other documentation can be used to provide verification. 

4. If it is not possible to verify that the domain and forest have been reviewed, then this is a finding.</check-content></check></Rule></Group><Group id="V-25997"><title>Replication in the DMZ (RODC)</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-32648r2_rule" severity="medium" weight="10.0"><version>AD.0270</version><title>Read-only Domain Controller (RODC) architecture and configuration must comply with directory services requirements.</title><description>&lt;VulnDiscussion&gt;The RODC role provides a unidirectional replication method for selected information from your internal network to the DMZ. If not properly configured so that the risk footprint is minimized, the interal domain controller or forest can be compromised.

RODC is considered part of the site’s Forest or Domain installation since it is not a standalone product, but rather a role of the the Windows AD DS full installation or Server Core installation. It is possible to have Windows 2003 clients authenticated using RODC, however, compatibility packs are needed. 

Note that RODC is not authorized for use across the site's perimeter firewall.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Active Directory Domain</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Active Directory Domain</dc:subject><dc:identifier>870</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000366</ident><fixtext fixref="F-29022r1_fix">1. Ensure compliance with VPN and IPSec requirements in the Network Insfrastucture STIG. 

2. Ensure IPSec and other communications and security configurations for the management and replication of the RODC uses the minimum required Group Policy Objects (GPOs) to provide the required functionality.

3. Replicate only the information needed to provide the functionality required. If full replication of all directory data is not needed, then replicated selective ID and authentication information as needed to the RODC.

4. Include an inspection of the RODC server in the DMZ when inspection for least privilege.</fixtext><fix id="F-29022r1_fix" /><check system="C-32870r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Active_Directory_Domain.xml" /><check-content>1. Verify that the site has applied the Network Infrastucture STIG to configure the VPN and IPSec. 

2. Verify that IPSec and other communications and security configurations for the management and replication of the RODC will be managed by use of the minimum required Group Policy Objects (GPOs).

3. Include an inspection of the RODC server in the DMZ when inspection for least privilege.

4. Verify that required patches and compatibility packs are installed if RODC is used with Windows 2003 (or earlier) clients.

5. If RODC server and configuration does not comply with requirements, then this is a finding.</check-content></check></Rule></Group><Group id="V-36431"><title>Enterprise Admins Group Members</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-47837r2_rule" severity="high" weight="10.0"><version>AD.0001</version><title>Membership to the Enterprise Admins group must be restricted to accounts used only to manage the Active Directory Forest.</title><description>&lt;VulnDiscussion&gt;The Enterprise Admins group is a highly privileged group.  Personnel who are system administrators must log on to Active Directory systems only using accounts with the level of authority necessary. Only system administrator accounts used exclusively to manage the Active Directory Forest may be members of the Enterprise Admins group. A separation of administrator responsibilities helps mitigate the risk of privilege escalation resulting from credential theft attacks.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;ECPA-1&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Active Directory Domain</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Active Directory Domain</dc:subject><dc:identifier>870</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000366</ident><fixtext fixref="F-40963r2_fix">Create the necessary documentation that identifies the members of the Enterprise Admins group.  Ensure that each member has a separate unique account that can only be used to manage the Active Directory Forest.  Remove any Enterprise Admin accounts from other administrator groups.</fixtext><fix id="F-40963r2_fix" /><check system="C-44673r3_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Active_Directory_Domain.xml" /><check-content>Review the Enterprise Admins group in Active Directory Users and Computers.  Any accounts that are members of the Enterprise Admins group must be documented with the IAO.  Each Enterprise Administrator must have a separate unique account specifically for managing the Active Directory forest.  

If any account listed in the Enterprise Admins group is a member of other administrator groups including the Domain Admins group, domain member server administrators groups, or domain workstation administrators groups, this is a finding.</check-content></check></Rule></Group><Group id="V-36432"><title>Domain Admins Group Members</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-47838r2_rule" severity="high" weight="10.0"><version>AD.0002</version><title>Membership to the Domain Admins group must be restricted to accounts used only to manage the Active Directory domain and domain controllers.</title><description>&lt;VulnDiscussion&gt;The Domain Admins group is a highly privileged group.  Personnel who are system administrators must log on to Active Directory systems only using accounts with the level of authority necessary. Only system administrator accounts used exclusively to manage an Active Directory domain and domain controllers may be members of the Domain Admins group. A separation of administrator responsibilities helps mitigate the risk of privilege escalation resulting from credential theft attacks.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;ECPA-1&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Active Directory Domain</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Active Directory Domain</dc:subject><dc:identifier>870</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000366</ident><fixtext fixref="F-40964r2_fix">Create the necessary documentation that identifies the members of the Domain Admins group.  Ensure that each member has a separate unique account that can only be used to manage the Active Directory domain and domain controllers.  Remove any Domain Admin accounts from other administrator groups.</fixtext><fix id="F-40964r2_fix" /><check system="C-44674r2_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Active_Directory_Domain.xml" /><check-content>Review the Domain Admins group in Active Directory Users and Computers.  Any accounts that are members of the Domain Admins group must be documented with the IAO.  Each Domain Administrator must have a separate unique account specifically for managing the Active Directory domain and domain controllers.  

If any account listed in the Domain Admins group is a member of other administrator groups including the Enterprise Admins group, domain member server administrators groups, or domain workstation administrators groups, this is a finding.</check-content></check></Rule></Group><Group id="V-36433"><title>Domain Member Server Administrators Group Members</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-47839r2_rule" severity="medium" weight="10.0"><version>AD.0003</version><title>Administrators must have separate accounts specifically for managing domain member servers.</title><description>&lt;VulnDiscussion&gt;Personnel who are system administrators must log on to domain systems only using accounts with the minimum level of authority necessary. Only system administrator accounts used exclusively to manage domain member servers may be members of an administrator group for domain member servers. A separation of administrator responsibilities helps mitigate the risk of privilege escalation resulting from credential theft attacks.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;ECPA-1&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Active Directory Domain</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Active Directory Domain</dc:subject><dc:identifier>870</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000366</ident><fixtext fixref="F-40965r3_fix">Create the necessary documentation that identifies the members of domain member server administrator groups.  Ensure that each member has a separate unique account that can only be used to manage domain member servers.  Remove any domain member server accounts from other administrator groups.</fixtext><fix id="F-40965r3_fix" /><check system="C-44675r3_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Active_Directory_Domain.xml" /><check-content>Review the membership groups in Active Directory Users and Computers.  Membership groups must be designated at the domain level specifically for domain member server administrators. Domain member server administrator groups and any accounts that are members of the groups must be documented with the IAO.  Each member server administrator must have a separate unique account specifically for managing member servers.  

If any account listed in a domain member server administrator group is a member of other administrator groups including the Enterprise Admins group, the Domain Admins group, or domain workstation administrator groups, this is a finding.</check-content></check></Rule></Group><Group id="V-36434"><title>Domain Workstation Administrators Group Members</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-47840r2_rule" severity="medium" weight="10.0"><version>AD.0004</version><title>Administrators must have separate accounts specifically for managing domain workstations.</title><description>&lt;VulnDiscussion&gt;Personnel who are system administrators must log on to domain systems only using accounts with the minimum level of authority necessary. Only system administrator accounts used exclusively to manage domain workstations may be members of an administrators group for domain workstations. A separation of administrator responsibilities helps mitigate the risk of privilege escalation resulting from credential theft attacks.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;ECPA-1&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Active Directory Domain</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Active Directory Domain</dc:subject><dc:identifier>870</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000366</ident><fixtext fixref="F-40966r3_fix">Create the necessary documentation that identifies the members of domain workstation administrator groups.  Ensure that each member has a separate unique account that can only be used to manage domain workstations.  Remove any domain workstation administrator accounts from other administrator groups.</fixtext><fix id="F-40966r3_fix" /><check system="C-44676r3_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Active_Directory_Domain.xml" /><check-content>Review the membership groups in Active Directory Users and Computers.  Membership groups must be designated at the domain level specifically for domain workstation administrators. Domain workstation administrator groups and any accounts that are members of the groups must be documented with the IAO.  Each domain workstation administrator must have a separate unique account specifically for managing domain workstations.  

If any account listed in a domain workstation administrator group is a member of other administrator groups including the Enterprise Admins group, the Domain Admins group, or domain member server administrator groups, this is a finding.</check-content></check></Rule></Group><Group id="V-36435"><title>Delegation of Privileged Accounts</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-47841r2_rule" severity="high" weight="10.0"><version>AD.0005</version><title>Delegation of privileged accounts must be prohibited.</title><description>&lt;VulnDiscussion&gt;Privileged accounts such as those belonging to any of the administrator groups must not be trusted for delegation. Allowing privileged accounts to be trusted for delegation provides a means for privilege escalation from a compromised system.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;ECLP-1&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Active Directory Domain</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Active Directory Domain</dc:subject><dc:identifier>870</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000366</ident><fixtext fixref="F-40967r1_fix">Open Active Directory Users and Computers. View the properties of all privileged accounts. Under the Account tab, select "Account is sensitive and cannot be delegated" in the Account Options section.</fixtext><fix id="F-40967r1_fix" /><check system="C-44677r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Active_Directory_Domain.xml" /><check-content>Review the properties of all privileged accounts in Active Directory Users and Computers. Under the Account tab, verify "Account is sensitive and cannot be delegated" is selected in the Account Options section. If delegation is not prohibited for any  privileged account, this is a finding.</check-content></check></Rule></Group><Group id="V-36436"><title>Dedicated Systems for Managing Active Directory</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-47842r4_rule" severity="medium" weight="10.0"><version>AD.MP.0001</version><title>Only systems dedicated for the sole purpose of managing Active Directory must be used to manage Active Directory remotely.</title><description>&lt;VulnDiscussion&gt;Only domain systems used exclusively to manage Active Directory (referred to as AD admin platforms) must be used to manage Active Directory remotely.  Dedicating domain systems to be used solely for managing Active Directory will aid in protecting privileged domain accounts from being compromised.

This includes the management of Active Directory itself and the Domain Controllers (DCs) that run Active Directory, including such activities as domain level user and computer management, administering trusts, replication, schema changes, site topology, domain-wide group policy, the addition of new DCs, DC software installation, and DC backups and restore operations.

Some maintenance activities may be delegated and do not require the use of an AD admin platform.  These include non-domain level activities such as user and computer management as well as group policy maintenance in site defined organizational units.  Accounts that have been delegated these activities must not be members of Domain or Enterprise Admin groups.  These activities may still be performed with the use of an AD admin platform for the additional protections they provide.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Active Directory Domain</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Active Directory Domain</dc:subject><dc:identifier>870</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-001082</ident><fixtext fixref="F-49310r1_fix">Set aside domain systems to manage Active Directory remotely.  Ensure they are used only for the purpose of managing Active Directory.  Otherwise, use the local domain controller console to manage Active Directory. </fixtext><fix id="F-49310r1_fix" /><check system="C-58505r2_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Active_Directory_Domain.xml" /><check-content>If Active Directory is only managed with local logons to domain controllers, not remotely, this can be marked NA.

Verify that any domain systems used to manage Active Directory remotely are used exclusively for managing Active Directory.  If domain systems used for managing Active Directory are used for additional functions, this is a finding.

In situations where an additional physical machine dedicated to AD admin tasks is not practicable, virtual machines (VM) may be securely employed in either of the following configurations: 
-Windows 8, Windows Server 2012 or later for the AD admin management role.
-Use local guest VMs running within Hyper-V for all other tasks to include admin roles on other servers as well as any user tasks such as web browsing or email. 

-Use a Type-1 Hypervisor with separate guest VMs for AD admin management roles and any other roles.

In either case, the higher integrity AD admin platform and the lower integrity platforms must be separate.  The AD admin platform must be configured not to forward the AD admin credentials to other guest VMs or to make the AD admin credentials available to other guest VMs.  Additionally, guest VMs for user and less critical admin activities must apply the security requirements from the applicable STIG, especially so that AD admin accounts are denied all logon types.</check-content></check></Rule></Group><Group id="V-36437"><title>Block Internet Access for Dedicated Systems Used for Managing Active Directory </title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-47843r2_rule" severity="medium" weight="10.0"><version>AD.0007</version><title>Dedicated systems used for managing Active Directory remotely must be blocked from Internet Access.</title><description>&lt;VulnDiscussion&gt;A system used to manage Active Directory provides access to highly privileged areas of a domain.  Such a system with Internet access may be exposed to numerous attacks and compromise the domain. Restricting Internet access for dedicated systems used to manage Active Directory will aid in protecting privileged domain accounts from being compromised.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Active Directory Domain</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Active Directory Domain</dc:subject><dc:identifier>870</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-001084</ident><fixtext fixref="F-40969r3_fix">Block Internet access for systems dedicated to managing Active Directory.  This can be accomplished by restrictions at boundary firewalls, proxy services, with the Windows Firewall or other methods.</fixtext><fix id="F-40969r3_fix" /><check system="C-44679r4_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Active_Directory_Domain.xml" /><check-content>Verify access to the internet is prevented for systems dedicated to managing Active Directory.  Various methods may be employed to accomplish this, such as restrictions at boundary firewalls, through proxy services, or with the Windows Firewall.

Review the Internet access restrictions with the administrator.  If Internet access is not prevented, this is a finding.</check-content></check></Rule></Group><Group id="V-36438"><title>Unique Passwords for all Local Administrator Accounts</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-47844r2_rule" severity="medium" weight="10.0"><version>AD.0008</version><title>Local administrator accounts on domain systems must not share the same password.</title><description>&lt;VulnDiscussion&gt;Local administrator accounts on domain systems must use unique passwords. In the event a domain system is compromised, sharing the same password for local administrator accounts on domain systems will allow an attacker to move laterally and compromise multiple domain systems.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Active Directory Domain</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Active Directory Domain</dc:subject><dc:identifier>870</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-001941</ident><fixtext fixref="F-40970r1_fix">Set unique passwords for all local administrator accounts on domain systems.</fixtext><fix id="F-40970r1_fix" /><check system="C-44680r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Active_Directory_Domain.xml" /><check-content>Verify local administrator accounts on domain systems are using unique passwords.  If local administrator accounts on domain systems are sharing a password, this is a finding.</check-content></check></Rule></Group><Group id="V-43648"><title>AD.0009</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-56469r2_rule" severity="medium" weight="10.0"><version>AD.0009</version><title>Separate smart cards must be used for Enterprise Admin (EA) and Domain Admin (DA) accounts from smart cards used for other accounts.</title><description>&lt;VulnDiscussion&gt;A separate smart card for Enterprise Admin and Domain Admin accounts eliminates the automatic exposure of the private keys for the EA/DA accounts to less secure user platforms when the other accounts are used.  Having different certificates on one card does not provide the necessary separation.  The same smart card may be used by an administrator for both EA and DA accounts.  &lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;IAIA-1&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Active Directory Domain</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Active Directory Domain</dc:subject><dc:identifier>870</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000366</ident><fixtext fixref="F-49248r2_fix">Use separate smart cards for EA and DA accounts from smart cards used for other accounts.  EA and DA accounts may be on the same smart card but must be separate from any other accounts.</fixtext><fix id="F-49248r2_fix" /><check system="C-49394r2_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Active_Directory_Domain.xml" /><check-content>Verify separate smart cards are used for EA and DA accounts from smart cards used for other accounts.  EA and DA accounts may be on the same smart card but must be separate from any other accounts.  If separate smart cards for EA and DA accounts from other accounts are not used, this is a finding.</check-content></check></Rule></Group><Group id="V-43649"><title>AD.0010</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-56470r2_rule" severity="medium" weight="10.0"><version>AD.0010</version><title>Enterprise Admin (EA) and Domain Admin (DA) accounts that require smart cards must have the setting Smart card is required for interactive logon disabled and re-enabled at least every 60 days.</title><description>&lt;VulnDiscussion&gt;When a  smart card is required for a domain account, a long password, unknown to the user, is generated.  This password and associated NT hash are not changed as are accounts with passwords controlled by the maximum password age.  Disabling and re-enabling the "Smart card is required for interactive logon" replaces the NT hash of the account with a newly randomized hash.  Otherwise, the existing NT hash could be re-used for Pass-the-Hash in the future.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;IAIA-1&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Active Directory Domain</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Active Directory Domain</dc:subject><dc:identifier>870</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000199</ident><fixtext fixref="F-49249r3_fix">Disable then re-enable "Smart card is required for interactive logon" for all smart card required EA and DA accounts at least every 60 days.</fixtext><fix id="F-49249r3_fix" /><check system="C-49395r3_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Active_Directory_Domain.xml" /><check-content>Verify "Smart card is required for interactive logon" is disabled and re-enabled for all smart card required EA and DA accounts at least every 60 days.  If the setting "Smart card is required for interactive logon" is not disabled then re-enabled for all EA and DA accounts that require smart card logons at least every 60 days, this is a finding.</check-content></check></Rule></Group><Group id="V-43650"><title>AD.0011</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-56471r2_rule" severity="medium" weight="10.0"><version>AD.0011</version><title>Administrative accounts for critical servers, that require smart cards, must have the setting Smart card is required for interactive logon disabled and re-enabled at least every 60 days.</title><description>&lt;VulnDiscussion&gt;When a  smart card is required for a domain account, a long password, unknown to the user, is generated.  This password and associated NT hash are not changed as are accounts with passwords controlled by the maximum password age.  Disabling and re-enabling the "Smart card is required for interactive logon" replaces the NT hash of the account with a newly randomized hash.  Otherwise, the existing NT hash could be re-used for Pass-the-Hash in the future.

Critical servers are any servers that provide functions that would significantly degrade mission effectiveness if disrupted, altered, or leaked.  Examples include email, collaboration (e.g., SharePoint), virtualization, configuration management, file sharing, and backup servers. &lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;IAIA-1&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Active Directory Domain</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Active Directory Domain</dc:subject><dc:identifier>870</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000199</ident><fixtext fixref="F-49250r3_fix">Disable then re-enable "Smart card is required for interactive logon" for all smart card required critical server administrative accounts at least every 60 days.</fixtext><fix id="F-49250r3_fix" /><check system="C-49396r3_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Active_Directory_Domain.xml" /><check-content>Verify "Smart card is required for interactive logon" is disabled and re-enabled for all smart card required administrative accounts associated with critical servers at least every 60 days.  If the setting "Smart card is required for interactive logon" is not disabled then re-enabled for all critical server administrative accounts that require smart card logons at least every 60 days, this is a finding.</check-content></check></Rule></Group><Group id="V-43651"><title>AD.0012</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-56472r2_rule" severity="medium" weight="10.0"><version>AD.0012</version><title>Other important accounts (VIPS and other administrators) that require smart cards must have the setting Smart card is required for interactive logon disabled and re-enabled at least every 60 days.</title><description>&lt;VulnDiscussion&gt;When a  smart card is required for a domain account, a long password, unknown to the user, is generated.  This password and associated NT hash are not changed as are accounts with passwords controlled by the maximum password age.  Disabling and re-enabling the "Smart card is required for interactive logon" replaces the NT hash of the account with a newly randomized hash.  Otherwise, the existing NT hash could be re-used for Pass-the-Hash in the future.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;IAIA-1&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Active Directory Domain</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Active Directory Domain</dc:subject><dc:identifier>870</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000199</ident><fixtext fixref="F-49251r3_fix">Disable then re-enable "Smart card is required for interactive logon" for all smart card required other important accounts (VIPS and other administrators) at least every 60 days.</fixtext><fix id="F-49251r3_fix" /><check system="C-49397r3_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Active_Directory_Domain.xml" /><check-content>Verify "Smart card is required for interactive logon" is disabled and re-enabled for all smart card required other important accounts (VIPS and other administrators) at least every 60 days.  If the setting "Smart card is required for interactive logon" is not disabled then re-enabled for other important accounts (VIPS and other administrators) that require smart card logons at least every 60 days, this is a finding.</check-content></check></Rule></Group><Group id="V-43652"><title>AD.0013</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-56473r2_rule" severity="medium" weight="10.0"><version>AD.0013</version><title>Separate domain accounts must be used to manage public facing servers from any domain accounts used to manage internal servers.</title><description>&lt;VulnDiscussion&gt;Public facing servers should be in DMZs with separate Active Directory forests.  If, because of operational necessity, this is not possible, lateral movement from these servers must be mitigated within the forest.  Having different domain accounts for administering domain joined public facing servers, from domain accounts used on internal servers, protects against an attacker’s lateral movement from a compromised public facing server.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;IAIA-1&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Active Directory Domain</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Active Directory Domain</dc:subject><dc:identifier>870</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000366</ident><fixtext fixref="F-49252r2_fix">If the domain does not have any public facing servers, this is NA.

Configure the system to include only administrator groups or accounts that are responsible for the system in the local Administrators group.

For public facing servers, replace the Domain Admins group with a domain member server administrator group whose members are different from any used to manage internal servers.</fixtext><fix id="F-49252r2_fix" /><check system="C-49398r4_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Active_Directory_Domain.xml" /><check-content>If the domain does not have any public facing servers, this is NA.

Review the local Administrators group on public facing servers.  Only the appropriate administrator groups or accounts responsible for administration of the system may be members of the group.

For public facing servers, the Domain Admins group must be replaced by a domain member server administrator group whose members are different from any used to manage internal servers.

If any domain accounts or groups used to manage internal servers are members of the local administrators group, this is a finding.</check-content></check></Rule></Group><Group id="V-43710"><title>AD.MP.0002</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-56531r2_rule" severity="medium" weight="10.0"><version>AD.MP.0002</version><title>Systems used to manage Active Directory (AD admin platforms) must be Windows 7, Windows Server 2008 R2, or later versions of Windows.</title><description>&lt;VulnDiscussion&gt;AD admin platforms are used for highly privileged activities.  The later versions of Windows offer significant security improvements over earlier versions of Windows.  Windows 8.1 and Windows Server 2012 R2, or later, are preferred as they offer even better credential protections.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Active Directory Domain</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Active Directory Domain</dc:subject><dc:identifier>870</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000366</ident><fixtext fixref="F-49311r2_fix">Use Windows 7, Windows Server 2008 R2, or later as the operating system for all AD admin platforms.</fixtext><fix id="F-49311r2_fix" /><check system="C-49400r3_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Active_Directory_Domain.xml" /><check-content>Verify the operating system version on AD admin platforms is at least Windows 7, Windows Server 2008 R2, or later.  If the operating system is an earlier version, this is a finding.</check-content></check></Rule></Group><Group id="V-43711"><title>AD.MP.0003</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-56532r2_rule" severity="medium" weight="10.0"><version>AD.MP.0003</version><title>Separate domain administrative accounts must be used to manage AD admin platforms from any domain accounts used on, or used to manage, non-AD admin platforms.</title><description>&lt;VulnDiscussion&gt;AD admin platforms are used for highly privileged activities.  The accounts that have administrative privileges on AD admin platforms must not be used on or used to manage any non-AD admin platforms.   Otherwise, there would be a clear path for privilege escalation to EA/DA privileges.  Where practicable, dedicated domain accounts that are used to manage AD admin platforms should be utilized, but otherwise Enterprise Admin (EA)/Domain Admin (DA) accounts may be used to manage AD admin platforms.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;ECPA-1&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Active Directory Domain</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Active Directory Domain</dc:subject><dc:identifier>870</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000366</ident><fixtext fixref="F-49312r1_fix">Use separate domain administrative accounts to manage AD admin platforms from non-AD admin platforms.  These should be dedicated domain accounts where practicable.  Otherwise EA/DA accounts may be used.</fixtext><fix id="F-49312r1_fix" /><check system="C-49401r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Active_Directory_Domain.xml" /><check-content>Review the local Administrators group of AD admin platforms.  Verify separate domain administrative accounts are used to manage AD admin platforms from non-AD admin platforms.  These should be dedicated domain accounts where practicable.  Otherwise EA/DA accounts may be used.  If accounts used to manage AD admin platforms are used for any non-AD admin platforms, this is a finding.</check-content></check></Rule></Group><Group id="V-43712"><title>AD.AU.0001</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-56533r2_rule" severity="medium" weight="10.0"><version>AD.AU.0001</version><title>Usage of administrative accounts must be monitored for suspicious and anomalous activity.</title><description>&lt;VulnDiscussion&gt;Monitoring the usage of administrative accounts can alert on suspicious behavior and anomalous account usage that would be indicative of potential malicious credential reuse.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;ECAT-1&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Active Directory Domain</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Active Directory Domain</dc:subject><dc:identifier>870</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000366</ident><fixtext fixref="F-49313r8_fix">Monitor account usage events for administrative accounts.  This includes events related to approved administrative accounts as well as accounts being added to privileged groups such as Administrators, Domain and Enterprise Admins and other organization defined administrative groups.  Event monitoring may be implemented through various methods including log aggregation and the use of monitoring tools.

Monitor for the events listed below, at minimum.

Windows Vista and later:
Account Lockouts (Subcategory: User Account Management)
4740 - A user account is locked out.
User Added to Privileged Group (Subcategory:  Security Group Management)
4728 - A member was added to a security-enabled global group.
4732 - A member was added to a security-enabled local group.
4756 - A member was added to a security-enabled universal group.
Successful User Account Login (Subcategory: Logon)
4624 - An account was successfully logged on.
Failed User Account Login (Subcategory: Logon)
4625 - An account failed to log on.
Account Login with Explicit Credentials (Subcategory: Logon)
4648 - A logon was attempted using explicit credentials.

Windows 2003:
Account Lockouts (Account Management Events)
644 - A user account was automatically locked.
Failed Login (Logon Events)
529 - Logon failure. A logon attempt was made with an unknown user name or a known user name with a bad password.
Successful Login (Logon Events)
528 - A user successfully logged on to a computer.
User Initiated Logoff (Logon Events)
551 - A user initiated the logoff process.
Account Login with Explicit Credentials (Logon Events)
552 - A user successfully logged on to a computer with explicit credentials while already logged on as a different user.
Successful Network Login (Logon Events)
540 - A user successfully logged on to a network.
User Account Created (Account Management Events)
624 - A user account was created.
Change Password Attempt (Account Management Events)
627 - A user password was changed.
User Added to Privileged Group (Account Management Events)
632 - A member was added to a global group.
636 - A member was added to a local group.
660 - A member was added to a security-enabled universal group.

The "Account Usage" section of NSA's "Spotting the Adversary with Windows Event Log Monitoring" provides additional information.
http://www.nsa.gov/ia/_files/app/Spotting_the_Adversary_with_Windows_Event_Log_Monitoring.pdf.</fixtext><fix id="F-49313r8_fix" /><check system="C-49402r7_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Active_Directory_Domain.xml" /><check-content>Verify account usage events for administrative accounts are being monitored.  This includes events related to approved administrative accounts as well as accounts being added to privileged groups such as Administrators, Domain and Enterprise Admins and other organization defined administrative groups.  Event monitoring may be implemented through various methods including log aggregation and the use of monitoring tools.

Monitor for the events listed below, at minimum.  If these events are not monitored, this is a finding.

Windows Vista and later:
Account Lockouts (Subcategory: User Account Management)
4740 - A user account is locked out.
User Added to Privileged Group (Subcategory:  Security Group Management)
4728 - A member was added to a security-enabled global group.
4732 - A member was added to a security-enabled local group.
4756 - A member was added to a security-enabled universal group.
Successful User Account Login (Subcategory: Logon)
4624 - An account was successfully logged on.
Failed User Account Login (Subcategory: Logon)
4625 - An account failed to log on.
Account Login with Explicit Credentials (Subcategory: Logon)
4648 - A logon was attempted using explicit credentials.

Windows 2003:
Account Lockouts (Account Management Events)
644 - A user account was automatically locked.
Failed Login (Logon Events)
529 - Logon failure. A logon attempt was made with an unknown user name or a known user name with a bad password.
Successful Login (Logon Events)
528 - A user successfully logged on to a computer.
User Initiated Logoff (Logon Events)
551 - A user initiated the logoff process.
Account Login with Explicit Credentials (Logon Events)
552 - A user successfully logged on to a computer with explicit credentials while already logged on as a different user.
Successful Network Login (Logon Events)
540 - A user successfully logged on to a network.
User Account Created (Account Management Events)
624 - A user account was created.
Change Password Attempt (Account Management Events)
627 - A user password was changed.
User Added to Privileged Group (Account Management Events)
632 - A member was added to a global group.
636 - A member was added to a local group.
660 - A member was added to a security-enabled universal group.</check-content></check></Rule></Group><Group id="V-43713"><title>AD.AU.0002</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-56534r2_rule" severity="medium" weight="10.0"><version>AD.AU.0002</version><title>Systems must be monitored for attempts to use local accounts to log on remotely from other systems.</title><description>&lt;VulnDiscussion&gt;Monitoring for the use of local accounts to log on remotely from other systems may indicate attempted lateral movement in a Pass-the-Hash attack.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;ECAT-1&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Active Directory Domain</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Active Directory Domain</dc:subject><dc:identifier>870</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000366</ident><fixtext fixref="F-49314r8_fix">Monitor for attempts to use local accounts to log on remotely from other systems.  Event monitoring may be implemented through various methods including log aggregation and the use of monitoring tools.

Monitor for the events listed below.

More advanced filtering is necessary to obtain the pertinent information than just looking for event IDs.
Search for the event IDs listed with the following additional attributes:
Logon Type = 3 (Network)
Authentication Package Name = NTLM
Not a domain logon and not the ANONYMOUS LOGON account

Windows Vista and later:
Successful User Account Login (Subcategory: Logon)
4624 - An account was successfully logged on.
Failed User Account Login (Subcategory: Logon)
4625 - An account failed to log on.

Windows 2003:
Successful Network Login (Logon Events)
540 - A user successfully logged on to a network.
Failed Login (Logon Events)
529 - Logon failure. A logon attempt was made with an unknown user name or a known user name with a bad password.

The "Pass the Hash Detection" section of NSA's "Spotting the Adversary with Windows Event Log Monitoring" provides a sample query for filtering.
http://www.nsa.gov/ia/_files/app/Spotting_the_Adversary_with_Windows_Event_Log_Monitoring.pdf.</fixtext><fix id="F-49314r8_fix" /><check system="C-49403r6_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Active_Directory_Domain.xml" /><check-content>Verify attempts to use local accounts to log on remotely from other systems are being monitored.  Event monitoring may be implemented through various methods including log aggregation and the use of monitoring tools.

Monitor for the events listed below.  If these events are not monitored, this is a finding.

More advanced filtering is necessary to obtain the pertinent information than just looking for event IDs.
Search for the event IDs listed with the following additional attributes:
Logon Type = 3 (Network)
Authentication Package Name = NTLM
Not a domain logon and not the ANONYMOUS LOGON account

Windows Vista and later:
Successful User Account Login (Subcategory: Logon)
4624 - An account was successfully logged on.
Failed User Account Login (Subcategory: Logon)
4625 - An account failed to log on.

Windows 2003:
Successful Network Login (Logon Events)
540 - A user successfully logged on to a network. 
Failed Login (Logon Events)
529 - Logon failure. A logon attempt was made with an unknown user name or a known user name with a bad password.</check-content></check></Rule></Group><Group id="V-43714"><title>AD.AU.0003</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-56535r2_rule" severity="medium" weight="10.0"><version>AD.AU.0003</version><title>Systems must be monitored for remote desktop logons.</title><description>&lt;VulnDiscussion&gt;Remote Desktop activity for administration should be limited to specific administrators, and from limited management workstations.  Monitoring for any Remote Desktop logins outside of expected activity can alert on suspicious behavior and anomalous account usage that could be indicative of potential malicious credential reuse.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;ECAT-1&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Active Directory Domain</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Active Directory Domain</dc:subject><dc:identifier>870</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000366</ident><fixtext fixref="F-49315r4_fix">More advanced filtering is necessary to obtain the pertinent information than just looking for event IDs.
Search for the event IDs listed with the following additional attributes:
Logon Type = 10 (RemoteInteractive)
Authentication Package Name = Negotiate

Windows Vista and later:
Successful User Account Login (Subcategory: Logon)
4624 - An account was successfully logged on.

Windows 2003:
Successful Login (Logon Events)
528 - A user successfully logged on to a computer.

The "Remote Desktop Logon Detection" section of NSA's "Spotting the Adversary with Windows Event Log Monitoring" provides a sample query for filtering.
http://www.nsa.gov/ia/_files/app/Spotting_the_Adversary_with_Windows_Event_Log_Monitoring.pdf.</fixtext><fix id="F-49315r4_fix" /><check system="C-49404r4_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Active_Directory_Domain.xml" /><check-content>Verify Remote Desktop logins are being monitored.  Event monitoring may be implemented through various methods including log aggregation and the use of monitoring tools.

Monitor for the events listed below.  If these events are not monitored, this is a finding.

More advanced filtering is necessary to obtain the pertinent information than just looking for event IDs.
Search for the event IDs listed with the following additional attributes:
Logon Type = 10 (RemoteInteractive)
Authentication Package Name = Negotiate

Windows Vista and later:
Successful User Account Login (Subcategory: Logon)
4624 - An account was successfully logged on.

Windows 2003:
Successful Login (Logon Events)
528 - A user successfully logged on to a computer.</check-content></check></Rule></Group><Group id="V-44058"><title>AD.MP.0004</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-56888r2_rule" severity="medium" weight="10.0"><version>AD.MP.0004</version><title>Communications from AD admin platforms must be blocked, except with the domain controllers being managed.</title><description>&lt;VulnDiscussion&gt;AD admin platforms are used for highly privileged activities.  Preventing communications to and from AD admin platforms, except with the domain controllers being managed, protects against an attacker's lateral movement from a compromised platform.

Requirements in Firewall and Windows client STIGs restrict inbound communications, however outbound communications must be restricted as well to prevent inadvertent exposure of the privileged credentials used on these platforms.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Active Directory Domain</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Active Directory Domain</dc:subject><dc:identifier>870</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-001084</ident><fixtext fixref="F-49678r3_fix">Maintain firewall rules to prevent outbound communications from AD admin platforms, except with domain controllers being managed.</fixtext><fix id="F-49678r3_fix" /><check system="C-49473r3_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Active_Directory_Domain.xml" /><check-content>Verify firewall rules prevent outbound communications from AD admin platforms, except for domain controllers being managed.  If outbound communications are allowed between AD admin platforms and any other systems other than domain controllers, this is a finding.</check-content></check></Rule></Group><Group id="V-44059"><title>AD.0014</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-56889r2_rule" severity="medium" weight="10.0"><version>AD.0014</version><title>Windows service \ application accounts with administrative privileges and manually managed passwords,  must have passwords changed at least every 60 days.</title><description>&lt;VulnDiscussion&gt;NT hashes of passwords for accounts that are not changed regularly are susceptible to reuse by attackers using Pass-the-Hash.  Windows service \ application account passwords are not typically changed for longer periods of time to ensure availability of the applications.  If a service \ application also has administrative privileges it will provide elevated access if compromised.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;IAIA-1&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Active Directory Domain</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Active Directory Domain</dc:subject><dc:identifier>870</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000199</ident><fixtext fixref="F-49679r4_fix">If no Windows service \ application accounts with manually managed passwords have administrative privileges, this is NA.

Change passwords for Windows service \ application accounts with administrative privileges and manually managed passwords, at least every 60 days.</fixtext><fix id="F-49679r4_fix" /><check system="C-49474r3_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Active_Directory_Domain.xml" /><check-content>If no Windows service \ application accounts with manually managed passwords have administrative privileges, this is NA.

Verify Windows service \ application accounts with administrative privileges and manually managed passwords, have passwords changed at least every 60 days.</check-content></check></Rule></Group><Group id="V-53727"><title>AD.0015</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-67945r1_rule" severity="medium" weight="10.0"><version>AD.0015</version><title>Domain controllers must be blocked from Internet access.</title><description>&lt;VulnDiscussion&gt; Domain controllers provide access to highly privileged areas of a domain.  Such systems with Internet access may be exposed to numerous attacks and compromise the domain.  Restricting Internet access for domain controllers will aid in protecting these privileged areas from being compromised.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Active Directory Domain</dc:title><dc:publisher>DISA FSO</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Active Directory Domain</dc:subject><dc:identifier>870</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000366</ident><fixtext fixref="F-58535r1_fix">Block domain controllers from internet access.  This can be accomplished with various methods, such as restrictions at boundary firewalls, proxy services, host based firewalls, or IPsec.   

If a critical function requires Internet access, this must be documented and approved by the organization.</fixtext><fix id="F-58535r1_fix" /><check system="C-54679r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Active_Directory_Domain.xml" /><check-content>Verify domain controllers are blocked from Internet access.  Various methods may be employed to accomplish this, such as restrictions at boundary firewalls, through proxy services, host based firewalls or IPsec.

Review the Internet access restrictions with the administrator.  If Internet access is not prevented, this is a finding.

If a critical function requires Internet access, this must be documented and approved by the organization.</check-content></check></Rule></Group></Benchmark>